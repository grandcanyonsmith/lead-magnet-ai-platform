"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createTableEnvironmentVars = createTableEnvironmentVars;
exports.getSecretArn = getSecretArn;
const types_1 = require("../types");
const constants_1 = require("../config/constants");
/**
 * Creates environment variables from a tables map
 *
 * Maps table keys to their corresponding environment variable names
 * using the centralized configuration.
 *
 * @param tablesMap - Map of table keys to DynamoDB table references
 * @returns Record of environment variable names to table names
 * @throws Error if required tables are missing
 */
function createTableEnvironmentVars(tablesMap) {
    const env = {};
    // Validate that all required tables are present
    const requiredKeys = Object.values(types_1.TableKey);
    const missingKeys = requiredKeys.filter(key => !tablesMap[key]);
    if (missingKeys.length > 0) {
        throw new Error(`Missing required tables in tablesMap: ${missingKeys.join(', ')}`);
    }
    // Use centralized mapping from constants
    Object.entries(tablesMap).forEach(([key, table]) => {
        const typedKey = key;
        const envVarName = constants_1.TABLE_ENV_VAR_MAP[typedKey];
        if (envVarName) {
            env[envVarName] = table.tableName;
        }
        else {
            console.warn(`No environment variable mapping found for table key: ${key}`);
        }
    });
    return env;
}
/**
 * Generates a Secrets Manager ARN for a secret name
 *
 * @param scope - CDK construct scope (for account/region access)
 * @param secretName - Name of the secret
 * @returns ARN string for the secret
 */
function getSecretArn(scope, secretName) {
    return `arn:aws:secretsmanager:${scope.region}:${scope.account}:secret:${secretName}*`;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW52aXJvbm1lbnQtaGVscGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImVudmlyb25tZW50LWhlbHBlcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFhQSxnRUF5QkM7QUFTRCxvQ0FFQztBQWpERCxvQ0FBOEM7QUFDOUMsbURBQXdEO0FBRXhEOzs7Ozs7Ozs7R0FTRztBQUNILFNBQWdCLDBCQUEwQixDQUFDLFNBQW1CO0lBQzVELE1BQU0sR0FBRyxHQUEyQixFQUFFLENBQUM7SUFFdkMsZ0RBQWdEO0lBQ2hELE1BQU0sWUFBWSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsZ0JBQVEsQ0FBQyxDQUFDO0lBQzdDLE1BQU0sV0FBVyxHQUFHLFlBQVksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBRWhFLElBQUksV0FBVyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztRQUMzQixNQUFNLElBQUksS0FBSyxDQUNiLHlDQUF5QyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQ2xFLENBQUM7SUFDSixDQUFDO0lBRUQseUNBQXlDO0lBQ3pDLE1BQU0sQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLEVBQUUsRUFBRTtRQUNqRCxNQUFNLFFBQVEsR0FBRyxHQUFlLENBQUM7UUFDakMsTUFBTSxVQUFVLEdBQUcsNkJBQWlCLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDL0MsSUFBSSxVQUFVLEVBQUUsQ0FBQztZQUNmLEdBQUcsQ0FBQyxVQUFVLENBQUMsR0FBRyxLQUFLLENBQUMsU0FBUyxDQUFDO1FBQ3BDLENBQUM7YUFBTSxDQUFDO1lBQ04sT0FBTyxDQUFDLElBQUksQ0FBQyx3REFBd0QsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUM5RSxDQUFDO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFFSCxPQUFPLEdBQUcsQ0FBQztBQUNiLENBQUM7QUFFRDs7Ozs7O0dBTUc7QUFDSCxTQUFnQixZQUFZLENBQUMsS0FBMEMsRUFBRSxVQUFrQjtJQUN6RixPQUFPLDBCQUEwQixLQUFLLENBQUMsTUFBTSxJQUFJLEtBQUssQ0FBQyxPQUFPLFdBQVcsVUFBVSxHQUFHLENBQUM7QUFDekYsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRhYmxlTWFwLCBUYWJsZUtleSB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IFRBQkxFX0VOVl9WQVJfTUFQIH0gZnJvbSAnLi4vY29uZmlnL2NvbnN0YW50cyc7XG5cbi8qKlxuICogQ3JlYXRlcyBlbnZpcm9ubWVudCB2YXJpYWJsZXMgZnJvbSBhIHRhYmxlcyBtYXBcbiAqIFxuICogTWFwcyB0YWJsZSBrZXlzIHRvIHRoZWlyIGNvcnJlc3BvbmRpbmcgZW52aXJvbm1lbnQgdmFyaWFibGUgbmFtZXNcbiAqIHVzaW5nIHRoZSBjZW50cmFsaXplZCBjb25maWd1cmF0aW9uLlxuICogXG4gKiBAcGFyYW0gdGFibGVzTWFwIC0gTWFwIG9mIHRhYmxlIGtleXMgdG8gRHluYW1vREIgdGFibGUgcmVmZXJlbmNlc1xuICogQHJldHVybnMgUmVjb3JkIG9mIGVudmlyb25tZW50IHZhcmlhYmxlIG5hbWVzIHRvIHRhYmxlIG5hbWVzXG4gKiBAdGhyb3dzIEVycm9yIGlmIHJlcXVpcmVkIHRhYmxlcyBhcmUgbWlzc2luZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVGFibGVFbnZpcm9ubWVudFZhcnModGFibGVzTWFwOiBUYWJsZU1hcCk6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xuICBjb25zdCBlbnY6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcblxuICAvLyBWYWxpZGF0ZSB0aGF0IGFsbCByZXF1aXJlZCB0YWJsZXMgYXJlIHByZXNlbnRcbiAgY29uc3QgcmVxdWlyZWRLZXlzID0gT2JqZWN0LnZhbHVlcyhUYWJsZUtleSk7XG4gIGNvbnN0IG1pc3NpbmdLZXlzID0gcmVxdWlyZWRLZXlzLmZpbHRlcihrZXkgPT4gIXRhYmxlc01hcFtrZXldKTtcbiAgXG4gIGlmIChtaXNzaW5nS2V5cy5sZW5ndGggPiAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYE1pc3NpbmcgcmVxdWlyZWQgdGFibGVzIGluIHRhYmxlc01hcDogJHttaXNzaW5nS2V5cy5qb2luKCcsICcpfWBcbiAgICApO1xuICB9XG5cbiAgLy8gVXNlIGNlbnRyYWxpemVkIG1hcHBpbmcgZnJvbSBjb25zdGFudHNcbiAgT2JqZWN0LmVudHJpZXModGFibGVzTWFwKS5mb3JFYWNoKChba2V5LCB0YWJsZV0pID0+IHtcbiAgICBjb25zdCB0eXBlZEtleSA9IGtleSBhcyBUYWJsZUtleTtcbiAgICBjb25zdCBlbnZWYXJOYW1lID0gVEFCTEVfRU5WX1ZBUl9NQVBbdHlwZWRLZXldO1xuICAgIGlmIChlbnZWYXJOYW1lKSB7XG4gICAgICBlbnZbZW52VmFyTmFtZV0gPSB0YWJsZS50YWJsZU5hbWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUud2FybihgTm8gZW52aXJvbm1lbnQgdmFyaWFibGUgbWFwcGluZyBmb3VuZCBmb3IgdGFibGUga2V5OiAke2tleX1gKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBlbnY7XG59XG5cbi8qKlxuICogR2VuZXJhdGVzIGEgU2VjcmV0cyBNYW5hZ2VyIEFSTiBmb3IgYSBzZWNyZXQgbmFtZVxuICogXG4gKiBAcGFyYW0gc2NvcGUgLSBDREsgY29uc3RydWN0IHNjb3BlIChmb3IgYWNjb3VudC9yZWdpb24gYWNjZXNzKVxuICogQHBhcmFtIHNlY3JldE5hbWUgLSBOYW1lIG9mIHRoZSBzZWNyZXRcbiAqIEByZXR1cm5zIEFSTiBzdHJpbmcgZm9yIHRoZSBzZWNyZXRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNlY3JldEFybihzY29wZTogeyBhY2NvdW50OiBzdHJpbmc7IHJlZ2lvbjogc3RyaW5nIH0sIHNlY3JldE5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBgYXJuOmF3czpzZWNyZXRzbWFuYWdlcjoke3Njb3BlLnJlZ2lvbn06JHtzY29wZS5hY2NvdW50fTpzZWNyZXQ6JHtzZWNyZXROYW1lfSpgO1xufVxuXG4iXX0=