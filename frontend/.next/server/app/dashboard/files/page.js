(()=>{var e={};e.id=254,e.ids=[254],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},78280:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d}),t(62110),t(20094),t(75966),t(12874);var r=t(27105),i=t(15265),a=t(90157),l=t.n(a),n=t(44665),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(s,o);let d=["",{children:["dashboard",{children:["files",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,62110)),"/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/files/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,20094)),"/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,75966)),"/Users/canyonsmith/lead-magnent-ai/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,12874,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/files/page.tsx"],u="/dashboard/files/page",x={require:t,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/dashboard/files/page",pathname:"/dashboard/files",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},21382:(e,s,t)=>{Promise.resolve().then(t.bind(t,51976))},51976:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var r=t(19899),i=t(5507),a=t(33957),l=t(16739),n=t(12330),o=t(53216),d=t(55562),c=t(13807);function u(){let{customerId:e}=(0,o.a)(),[s,t]=(0,i.useState)([]),[u,x]=(0,i.useState)(!0),[h,m]=(0,i.useState)(!1),[p,f]=(0,i.useState)(""),[b,g]=(0,i.useState)(null),[y,j]=(0,i.useState)(!1),[v,w]=(0,i.useState)(null),[N,k]=(0,i.useState)(null),[_,q]=(0,i.useState)(null),[S,F]=(0,i.useState)(!1),[P,C]=(0,i.useState)(null),[U,E]=(0,i.useState)(null),T=async()=>{x(!0);try{let e=await n.hi.get("/files");t(e.files)}catch(e){console.error("Error loading files:",e)}finally{x(!1)}},z=async e=>{let s=e.target.files?.[0];if(s){m(!0);try{let e=new FileReader;e.onload=async e=>{try{let t=(e.target?.result).split(",")[1];await n.hi.post("/files",{file:t,filename:s.name,contentType:s.type,fileType:"document",category:"uploads"}),await T(),E(null),C("File uploaded successfully.")}catch(e){console.error("Error uploading file:",e),E("Failed to upload file. Please try again."),C(null)}finally{m(!1)}},e.readAsDataURL(s)}catch(e){console.error("Error reading file:",e),m(!1)}}},D=async()=>{if(!p.trim()){g(null);return}j(!0);try{let e=await n.hi.post("/files/search",{query:p});g(e),E(null)}catch(e){console.error("Error searching files:",e),E("Failed to search files. Please try again."),C(null)}finally{j(!1)}},L=async e=>{w(e);try{let s=await n.hi.get(`/files/${e.file_id}`);k(s.download_url)}catch(e){console.error("Error getting file URL:",e)}},M=async()=>{if(_){F(!0);try{await n.hi.delete(`/files/${_.file_id}`),await T(),v?.file_id===_.file_id&&(w(null),k(null)),C("File deleted."),E(null)}catch(e){console.error("Error deleting file:",e),E("Failed to delete file. Please try again."),C(null)}F(!1),q(null)}},$=e=>e<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(2)} KB`:`${(e/1048576).toFixed(2)} MB`;return(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-ink-900 mb-2",children:"Files"}),r.jsx("p",{className:"text-ink-600",children:"Upload and manage your customer files"})]}),(P||U)&&(0,r.jsxs)("div",{className:"space-y-3 mb-4",children:[U&&r.jsx("div",{className:"bg-red-50 border border-red-100 text-red-700 rounded-2xl px-4 py-3",children:U}),P&&r.jsx("div",{className:"bg-emerald-50 border border-emerald-100 text-emerald-800 rounded-2xl px-4 py-3",children:P})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-soft border border-white/60 p-6 mb-6",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4 text-ink-900",children:"Upload File"}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("label",{className:"cursor-pointer",children:[r.jsx("span",{className:"inline-flex items-center px-4 py-2 bg-brand-600 text-white rounded-2xl hover:bg-brand-700 transition-colors shadow-soft",children:h?"Uploading...":"Choose File"}),r.jsx("input",{type:"file",className:"hidden",onChange:z,disabled:h})]}),r.jsx("span",{className:"text-sm text-ink-500",children:"Max file size: 10MB"})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-soft border border-white/60 p-6 mb-6",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4 text-ink-900",children:"Search Files"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("input",{type:"text",placeholder:"Search files by content...",value:p,onChange:e=>f(e.target.value),onKeyPress:e=>"Enter"===e.key&&D(),className:"flex-1 px-4 py-2 border border-white/60 rounded-2xl bg-white/90 focus:outline-none focus:ring-2 focus:ring-brand-500 shadow-soft"}),r.jsx("button",{onClick:D,disabled:y||!p.trim(),className:"px-6 py-2 bg-brand-600 text-white rounded-2xl hover:bg-brand-700 disabled:opacity-50 disabled:cursor-not-allowed shadow-soft",children:y?"Searching...":"Search"})]}),b&&(0,r.jsxs)("div",{className:"mt-4 p-4 bg-white/80 rounded-2xl border border-white/60",children:[r.jsx("h3",{className:"font-semibold mb-2 text-ink-900",children:"Search Results"}),r.jsx("p",{className:"text-ink-700 whitespace-pre-wrap",children:b.response}),(0,r.jsxs)("p",{className:"text-sm text-ink-500 mt-2",children:["Searched ",b.filesSearched," file(s)"]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-soft border border-white/60",children:[r.jsx("div",{className:"p-6 border-b border-white/60",children:(0,r.jsxs)("h2",{className:"text-lg font-semibold text-ink-900",children:["Your Files (",s.length,")"]})}),u?r.jsx("div",{className:"p-8 text-center text-ink-500",children:"Loading files..."}):0===s.length?r.jsx("div",{className:"p-8 text-center text-ink-500",children:"No files uploaded yet. Upload your first file above."}):r.jsx("div",{className:"divide-y divide-white/60",children:s.map(e=>r.jsx("div",{className:"p-4 hover:bg-white/80 cursor-pointer",onClick:()=>L(e),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("h3",{className:"font-medium text-ink-900",children:e.original_filename}),(0,r.jsxs)("div",{className:"mt-1 flex items-center gap-4 text-sm text-ink-500",children:[r.jsx("span",{children:e.file_type}),r.jsx("span",{children:$(e.file_size)}),r.jsx("span",{children:new Date(e.created_at).toLocaleDateString()})]})]}),r.jsx("button",{onClick:s=>{s.stopPropagation(),q(e)},className:"ml-4 px-3 py-1 text-sm text-red-600 hover:bg-red-50/60 rounded-2xl",children:"Delete"})]})},e.file_id))})]}),r.jsx(a.u,{appear:!0,show:!!v&&!!N,as:i.Fragment,children:(0,r.jsxs)(l.Vq,{as:"div",className:"relative z-50",onClose:()=>{w(null),k(null)},children:[r.jsx(a.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),r.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:r.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:r.jsx(a.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:r.jsx(l.Vq.Panel,{className:"w-full max-w-4xl transform overflow-hidden rounded-2xl bg-white shadow-soft border border-white/60 transition-all",children:v&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"p-6 border-b border-white/60 flex items-center justify-between",children:[r.jsx(l.Vq.Title,{as:"h3",className:"text-lg font-semibold text-ink-900",children:v.original_filename}),r.jsx("button",{onClick:()=>{w(null),k(null)},className:"text-ink-500 hover:text-ink-700 rounded-2xl p-2 transition-colors focus:outline-none focus:ring-2 focus:ring-brand-500",children:r.jsx(d.q5L,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"p-6",children:[r.jsx("div",{className:"mb-4",children:r.jsx("a",{href:N||"#",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-brand-600 text-white rounded-2xl hover:bg-brand-700 shadow-soft transition-colors focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2",children:"Download File"})}),(0,r.jsxs)("div",{className:"text-sm text-ink-600 space-y-1",children:[(0,r.jsxs)("p",{children:["Type: ",v.file_type]}),(0,r.jsxs)("p",{children:["Size: ",$(v.file_size)]}),(0,r.jsxs)("p",{children:["Uploaded: ",new Date(v.created_at).toLocaleString()]})]})]})]})})})})})]})}),r.jsx(c.Q,{open:!!_,title:"Delete file?",description:_?(0,r.jsxs)("span",{children:["This will permanently remove ",r.jsx("span",{className:"font-semibold",children:_.original_filename}),"."]}):"This action cannot be undone.",confirmLabel:"Delete",tone:"danger",loading:S,onConfirm:M,onCancel:()=>q(null)})]})}},13807:(e,s,t)=>{"use strict";t.d(s,{Q:()=>i});var r=t(19899);function i({open:e,title:s,description:t,confirmLabel:i="Confirm",cancelLabel:a="Cancel",tone:l="default",loading:n=!1,onConfirm:o,onCancel:d}){return e?(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-ink-900/60 backdrop-blur-sm",onClick:d,"aria-hidden":"true"}),r.jsx("div",{className:"relative z-10 w-full max-w-md rounded-2xl bg-white shadow-soft border border-white/60 p-6",role:"dialog","aria-modal":"true","aria-labelledby":"confirm-dialog-title",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("h3",{id:"confirm-dialog-title",className:"text-lg font-semibold text-ink-900",children:s}),t&&r.jsx("div",{className:"text-sm text-ink-600",children:t})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-3",children:[r.jsx("button",{type:"button",onClick:d,className:"w-full sm:w-auto px-4 py-3 sm:py-2.5 rounded-2xl border border-white/60 bg-white text-ink-700 hover:bg-surface-50 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 touch-target",children:a}),r.jsx("button",{type:"button",onClick:o,disabled:n,className:`w-full sm:w-auto px-4 py-3 sm:py-2.5 rounded-2xl text-white ${"danger"===l?"bg-red-600 hover:bg-red-700 focus:ring-red-500":"bg-brand-600 hover:bg-brand-700 focus:ring-brand-500"} transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 touch-target disabled:opacity-60 disabled:cursor-not-allowed`,children:n?"Working...":i})]})]})})]}):null}},62110:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(2772).createProxy)(String.raw`/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/files/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[257,138,957,200,739,920,501],()=>t(78280));module.exports=r})();