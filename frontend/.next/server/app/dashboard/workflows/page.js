(()=>{var e={};e.id=656,e.ids=[656],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},79695:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),t(22483),t(20094),t(75966),t(12874);var r=t(27105),a=t(15265),l=t(90157),o=t.n(l),n=t(44665),i={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);t.d(s,i);let d=["",{children:["dashboard",{children:["workflows",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,22483)),"/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/workflows/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,20094)),"/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,75966)),"/Users/canyonsmith/lead-magnent-ai/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,12874,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/workflows/page.tsx"],u="/dashboard/workflows/page",x={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/workflows/page",pathname:"/dashboard/workflows",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},13351:(e,s,t)=>{Promise.resolve().then(t.bind(t,71974))},71974:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var r=t(19899),a=t(5507),l=t(76153),o=t(27111),n=t(33957),i=t(55562),d=t(12330),c=t(13807);function u(){let e=(0,l.useRouter)(),{workflows:s,loading:t,loadWorkflows:u,deleteWorkflow:x,currentPage:m,totalPages:h,totalItems:p,itemsPerPage:b,onPageChange:f}=function(){let[e,s]=(0,a.useState)([]),[t,r]=(0,a.useState)(!0),[l,o]=(0,a.useState)(1),[n,i]=(0,a.useState)(0),[c,u]=(0,a.useState)(!1),[x]=(0,a.useState)(20),m=(0,a.useCallback)(async(e=1)=>{try{r(!0);{let t=(e-1)*x,r=await d.hi.getWorkflows({limit:x,offset:t}),a=r.workflows||[];a.sort((e,s)=>{let t=new Date(e.created_at||0).getTime();return new Date(s.created_at||0).getTime()-t}),s(a),i(r.total||r.count||a.length),u(r.has_more||!1)}}catch(e){console.error("Failed to load workflows:",e)}finally{r(!1)}},[x]),h=(0,a.useCallback)(async e=>{try{return await d.hi.deleteWorkflow(e),await m(l),!0}catch(e){return console.error("Failed to delete workflow:",e),!1}},[m,l]);return{workflows:e,loading:t,loadWorkflows:m,deleteWorkflow:h,currentPage:l,totalPages:Math.ceil(n/x),totalItems:n,itemsPerPage:x,hasMore:c,onPageChange:(0,a.useCallback)(e=>{o(e)},[])}}(),[w,g]=(0,a.useState)(new Set),[j,v]=(0,a.useState)({}),[k,N]=(0,a.useState)({}),[y,_]=(0,a.useState)(null),[C,P]=(0,a.useState)(""),[q,S]=(0,a.useState)(!1),$=async e=>{let s=new Set(w);if(s.has(e))s.delete(e);else if(s.add(e),!j[e]&&!k[e]){N(s=>({...s,[e]:!0}));try{let s=await d.hi.getJobs({workflow_id:e,limit:50});v(t=>({...t,[e]:s.jobs||[]}))}catch(e){console.error("Failed to load jobs:",e)}finally{N(s=>({...s,[e]:!1}))}}g(s)},T=(0,a.useMemo)(()=>({active:"bg-emerald-50 text-emerald-700 border-emerald-100",inactive:"bg-ink-100 text-ink-700 border-ink-200",draft:"bg-amber-50 text-amber-700 border-amber-100"}),[]),F=(0,a.useMemo)(()=>({completed:{label:"Ready",classes:"bg-emerald-50 text-emerald-700 border-emerald-100"},processing:{label:"Generating...",classes:"bg-brand-50 text-brand-700 border-brand-100"},failed:{label:"Error",classes:"bg-red-50 text-red-700 border-red-100"},queued:{label:"Queued",classes:"bg-amber-50 text-amber-700 border-amber-100"},pending:{label:"Queued",classes:"bg-amber-50 text-amber-700 border-amber-100"}}),[]),M=async()=>{if(!y)return;P(""),S(!0);let e=await x(y.workflow_id);if(S(!1),!e){P("Failed to delete lead magnet. Please try again.");return}_(null)};return t?(0,r.jsxs)("div",{className:"max-w-5xl mx-auto",children:[r.jsx("div",{className:"h-8 bg-ink-200 rounded w-48 mb-6 animate-pulse"}),r.jsx("div",{className:"space-y-3",children:[1,2,3].map(e=>r.jsx("div",{className:"h-20 bg-white rounded-2xl shadow-soft border border-white/60 animate-pulse"},e))})]}):(0,r.jsxs)("div",{className:"max-w-5xl mx-auto space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-ink-900",children:"Lead Magnets"}),r.jsx("p",{className:"text-ink-600 mt-1 text-sm",children:"Organize your workflows, review runs, and manage delivery for each magnet."})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:(0,r.jsxs)("button",{onClick:()=>e.push("/dashboard/workflows/new"),className:"flex items-center px-4 py-3 bg-brand-600 text-white rounded-2xl hover:bg-brand-700 transition-colors shadow-soft focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2",children:[r.jsx(i.OvN,{className:"w-5 h-5 mr-2"}),"Create lead magnet"]})})]}),0===s.length?(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-white/60 shadow-soft p-12 text-center",children:[r.jsx("p",{className:"text-ink-600 mb-4",children:"No lead magnets yet."}),r.jsx("button",{onClick:()=>e.push("/dashboard/workflows/new"),className:"px-5 py-3 bg-brand-600 text-white rounded-2xl hover:bg-brand-700 transition-colors shadow-soft",children:"Create Lead Magnet"})]}):(0,r.jsxs)("div",{className:"space-y-3",children:[C&&r.jsx("div",{className:"bg-red-50 border border-red-100 text-red-700 rounded-2xl px-4 py-3",children:C}),s.map(s=>{let t=w.has(s.workflow_id),a=j[s.workflow_id]||[],l=k[s.workflow_id],d=T[s.status]||T.active,c=s.form?.public_slug?`Form: ${s.form.public_slug}`:s.form?.form_name?`Form: ${s.form.form_name}`:"No form attached";return(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-white/60 shadow-soft overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-4 sm:p-5 flex items-start gap-3",children:[r.jsx("button",{onClick:()=>$(s.workflow_id),className:"p-3 rounded-2xl bg-surface-100 text-ink-700 hover:text-ink-900 transition-colors focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2","aria-label":t?"Collapse workflow":"Expand workflow",children:t?r.jsx(i.rH8,{className:"w-5 h-5"}):r.jsx(i.bTu,{className:"w-5 h-5"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0 space-y-2",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[r.jsx("button",{onClick:()=>e.push(`/dashboard/workflows/${s.workflow_id}/edit`),className:"text-left",children:r.jsx("div",{className:"text-base font-semibold text-ink-900 truncate",children:s.workflow_name})}),r.jsx("span",{className:`w-fit px-3 py-1 text-xs font-medium rounded-full border ${d}`,children:"draft"===s.status?"Draft":"inactive"===s.status?"Paused":"Active"})]}),s.workflow_description&&r.jsx("p",{className:"text-sm text-ink-600 line-clamp-2",children:s.workflow_description}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-xs text-ink-600",children:[(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-surface-100 border border-white/60",children:[r.jsx(i.NOg,{className:"w-4 h-4"}),c]}),(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-surface-100 border border-white/60",children:[r.jsx(i.bAx,{className:"w-4 h-4"}),"Steps: ",s.steps?.length??0]}),s.template_version&&(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-surface-100 border border-white/60",children:["v",s.template_version]})]})]}),(0,r.jsxs)(o.v2,{as:"div",className:"relative",children:[r.jsx(o.v2.Button,{className:"p-2 text-ink-500 hover:text-ink-900 hover:bg-white/80 rounded-2xl transition-colors",children:r.jsx(i.$Pu,{className:"w-5 h-5"})}),(0,r.jsxs)(o.v2.Items,{className:"absolute right-0 mt-2 w-40 bg-white rounded-2xl shadow-lg border border-white/60 z-10 py-1",children:[r.jsx(o.v2.Item,{children:({active:t})=>(0,r.jsxs)("button",{onClick:()=>e.push(`/dashboard/workflows/${s.workflow_id}/edit`),className:`w-full text-left px-4 py-2 text-sm flex items-center ${t?"bg-surface-100":""}`,children:[r.jsx(i.vPQ,{className:"w-4 h-4 mr-2"}),"Edit"]})}),r.jsx(o.v2.Item,{children:({active:e})=>(0,r.jsxs)("button",{onClick:()=>_(s),className:`w-full text-left px-4 py-2 text-sm text-red-600 flex items-center ${e?"bg-red-50/60":""}`,children:[r.jsx(i.Ybf,{className:"w-4 h-4 mr-2"}),"Delete"]})})]})]})]}),r.jsx(n.u,{show:t,enter:"transition ease-out duration-200",enterFrom:"opacity-0 max-h-0",enterTo:"opacity-100 max-h-screen",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 max-h-screen",leaveTo:"opacity-0 max-h-0",children:r.jsx("div",{className:"border-t border-white/60 px-4 py-3",children:l?(0,r.jsxs)("div",{className:"text-sm text-ink-500 py-2 flex items-center gap-2",children:[r.jsx(i.TCC,{className:"w-4 h-4"}),"Loading runs..."]}):0===a.length?r.jsx("div",{className:"text-sm text-ink-500 py-2",children:"No runs yet"}):r.jsx("div",{className:"space-y-2",children:a.map(s=>r.jsx("button",{onClick:()=>e.push(`/dashboard/jobs/${s.job_id}`),className:"w-full text-left p-3 bg-white/50 rounded-2xl border border-white/60 hover:bg-white/80 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`px-2 py-1 text-xs font-medium rounded-full border ${F[s.status]?.classes||F.pending.classes}`,children:F[s.status]?.label||F.pending.label}),s.created_at&&r.jsx("div",{className:"text-xs text-ink-500 mt-1",children:new Date(s.created_at).toLocaleDateString()})]}),s.output_url&&"completed"===s.status&&r.jsx("a",{href:s.output_url,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"text-brand-600 hover:text-brand-700",children:r.jsx(i.AlO,{className:"w-4 h-4"})})]})},s.job_id))})})})]},s.workflow_id)})]}),h>1&&r.jsx("div",{className:"bg-white rounded-2xl border border-white/60 shadow-soft px-6 py-4",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"text-sm text-ink-600",children:["Showing ",r.jsx("span",{className:"font-medium text-ink-900",children:(m-1)*b+1})," to"," ",r.jsx("span",{className:"font-medium text-ink-900",children:Math.min(m*b,p)})," of"," ",r.jsx("span",{className:"font-medium text-ink-900",children:p})," lead magnets"]}),(0,r.jsxs)("nav",{className:"flex items-center gap-1",children:[r.jsx("button",{onClick:()=>f(m-1),disabled:1===m,className:"p-2 rounded-2xl border border-surface-200 text-ink-500 hover:bg-surface-100 hover:text-ink-900 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent transition-colors","aria-label":"Previous page",children:r.jsx(i.YFh,{className:"w-5 h-5"})}),(()=>{let e=[];if(h<=7)for(let s=1;s<=h;s++)e.push(s);else if(m<=3){for(let s=1;s<=5;s++)e.push(s);e.push("..."),e.push(h)}else if(m>=h-2){e.push(1),e.push("...");for(let s=h-4;s<=h;s++)e.push(s)}else{e.push(1),e.push("...");for(let s=m-1;s<=m+1;s++)e.push(s);e.push("..."),e.push(h)}return e.map((e,s)=>"..."===e?r.jsx("span",{className:"px-3 py-2 text-ink-400",children:"..."},`ellipsis-${s}`):r.jsx("button",{onClick:()=>f(e),className:`min-w-[2.5rem] px-3 py-2 rounded-2xl font-medium transition-colors ${m===e?"bg-brand-600 text-white":"border border-surface-200 text-ink-700 hover:bg-surface-100"}`,children:e},e))})(),r.jsx("button",{onClick:()=>f(m+1),disabled:m===h,className:"p-2 rounded-2xl border border-surface-200 text-ink-500 hover:bg-surface-100 hover:text-ink-900 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent transition-colors","aria-label":"Next page",children:r.jsx(i.Tfp,{className:"w-5 h-5"})})]})]})}),r.jsx(c.Q,{open:!!y,title:"Delete lead magnet?",description:y?(0,r.jsxs)("span",{children:["This will remove ",r.jsx("span",{className:"font-semibold",children:y.workflow_name})," and its associated form. This action cannot be undone."]}):"This action cannot be undone.",confirmLabel:"Delete",tone:"danger",loading:q,onConfirm:M,onCancel:()=>{_(null),P("")}})]})}},13807:(e,s,t)=>{"use strict";t.d(s,{Q:()=>a});var r=t(19899);function a({open:e,title:s,description:t,confirmLabel:a="Confirm",cancelLabel:l="Cancel",tone:o="default",loading:n=!1,onConfirm:i,onCancel:d}){return e?(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-ink-900/60 backdrop-blur-sm",onClick:d,"aria-hidden":"true"}),r.jsx("div",{className:"relative z-10 w-full max-w-md rounded-2xl bg-white shadow-soft border border-white/60 p-6",role:"dialog","aria-modal":"true","aria-labelledby":"confirm-dialog-title",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("h3",{id:"confirm-dialog-title",className:"text-lg font-semibold text-ink-900",children:s}),t&&r.jsx("div",{className:"text-sm text-ink-600",children:t})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-3",children:[r.jsx("button",{type:"button",onClick:d,className:"w-full sm:w-auto px-4 py-3 sm:py-2.5 rounded-2xl border border-white/60 bg-white text-ink-700 hover:bg-surface-50 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 touch-target",children:l}),r.jsx("button",{type:"button",onClick:i,disabled:n,className:`w-full sm:w-auto px-4 py-3 sm:py-2.5 rounded-2xl text-white ${"danger"===o?"bg-red-600 hover:bg-red-700 focus:ring-red-500":"bg-brand-600 hover:bg-brand-700 focus:ring-brand-500"} transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 touch-target disabled:opacity-60 disabled:cursor-not-allowed`,children:n?"Working...":a})]})]})})]}):null}},22483:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(2772).createProxy)(String.raw`/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/workflows/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[257,138,957,200,247,111,920,501],()=>t(79695));module.exports=r})();