(()=>{var e={};e.id=831,e.ids=[831],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},13153:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>h,tree:()=>d}),s(77634),s(95557),s(20094),s(75966),s(12874);var r=s(27105),a=s(15265),l=s(90157),i=s.n(l),n=s(44665),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let d=["",{children:["dashboard",{children:["workflows",{children:["[...slug]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,77634)),"/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/workflows/[...slug]/page.tsx"]}]},{error:[()=>Promise.resolve().then(s.bind(s,95557)),"/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/workflows/[...slug]/error.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,20094)),"/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,75966)),"/Users/canyonsmith/lead-magnent-ai/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,12874,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/workflows/[...slug]/page.tsx"],m="/dashboard/workflows/[...slug]/page",x={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/workflows/[...slug]/page",pathname:"/dashboard/workflows/[...slug]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},10292:(e,t,s)=>{Promise.resolve().then(s.bind(s,26522)),Promise.resolve().then(s.bind(s,86016))},66337:(e,t,s)=>{Promise.resolve().then(s.bind(s,82599))},26522:(e,t,s)=>{"use strict";s.d(t,{default:()=>m});var r=s(19899),a=s(5507),l=s(76153),i=s(12330),n=s(583);function o(e){let t=e.matchAll(/\{\{([A-Z_]+)\}\}/g),s=new Set;for(let e of t)s.add(e[1]);return Array.from(s).sort()}var d=s(55562),c=s(59507);function m(){let e=(0,l.useRouter)(),[t,s]=(0,a.useState)(null),{workflowId:m,loading:x,submitting:h,setSubmitting:p,error:u,setError:b,formData:f,setFormData:g,steps:w,setSteps:_,formId:j,workflowForm:v,handleChange:y,handleStepChange:N,handleAddStep:k,handleDeleteStep:C,handleMoveStepUp:S,handleMoveStepDown:q,router:T}=function(){let e=(0,l.useRouter)(),t=(0,n.I)(),[s,r]=(0,a.useState)(!0),[i,o]=(0,a.useState)(!1),[d,c]=(0,a.useState)(null),[m,x]=(0,a.useState)({workflow_name:"",workflow_description:"",template_id:"",template_version:0,delivery_method:"none",delivery_webhook_url:"",delivery_webhook_headers:{},delivery_sms_enabled:!1,delivery_sms_message:"",delivery_sms_ai_generated:!1,delivery_sms_ai_instructions:""}),[h,p]=(0,a.useState)([]),[u,b]=(0,a.useState)(null),[f,g]=(0,a.useState)(null),[w,_]=(0,a.useState)(null);return{workflowId:t,loading:s,submitting:i,setSubmitting:o,error:d,setError:c,formData:m,setFormData:x,steps:h,setSteps:p,formId:u,workflowForm:f,workflowStatus:w,handleChange:(e,t)=>{x(s=>({...s,[e]:t}))},handleStepChange:(e,t)=>{p(s=>{let r=[...s];return r[e]={...t,step_order:e},r})},handleAddStep:()=>{p(e=>[...e,{step_name:`Step ${e.length+1}`,step_description:"",step_type:"ai_generation",model:"gpt-5",instructions:"",step_order:e.length,tools:["web_search_preview"],tool_choice:"auto",depends_on:[]}])},handleDeleteStep:e=>{p(t=>t.filter((t,s)=>s!==e).map((e,t)=>({...e,step_order:t})))},handleMoveStepUp:e=>{0!==e&&p(t=>{let s=[...t];return[s[e-1],s[e]]=[s[e],s[e-1]],s.map((e,t)=>({...e,step_order:t}))})},handleMoveStepDown:e=>{e!==h.length-1&&p(t=>{let s=[...t];return[s[e],s[e+1]]=[s[e+1],s[e]],s.map((e,t)=>({...e,step_order:t}))})},router:e}}(),{formFormData:F,handleFormChange:P,handleFieldChange:D,addField:A,removeField:$}=function(e,t,s){let[r,l]=(0,a.useState)({form_name:"",public_slug:"",form_fields_schema:{fields:[]},rate_limit_enabled:!0,rate_limit_per_hour:10,captcha_enabled:!1,custom_css:"",thank_you_message:"",redirect_url:""});return{formFormData:r,setFormFormData:l,handleFormChange:(e,t)=>{l(s=>({...s,[e]:t}))},handleFieldChange:(e,t,s)=>{l(r=>{let a=[...r.form_fields_schema.fields];return a[e]={...a[e],[t]:s},{...r,form_fields_schema:{...r.form_fields_schema,fields:a}}})},addField:()=>{l(e=>({...e,form_fields_schema:{...e.form_fields_schema,fields:[...e.form_fields_schema.fields,{field_id:`field_${Date.now()}`,field_type:"text",label:"",placeholder:"",required:!1}]}}))},removeField:e=>{l(t=>{let s=[...t.form_fields_schema.fields];return s.splice(e,1),{...t,form_fields_schema:{...t.form_fields_schema,fields:s}}})},moveFieldUp:e=>{0!==e&&l(t=>{let s=[...t.form_fields_schema.fields],r=s[e];return s[e]=s[e-1],s[e-1]=r,{...t,form_fields_schema:{...t.form_fields_schema,fields:s}}})},moveFieldDown:e=>{l(t=>{let s=[...t.form_fields_schema.fields];if(e>=s.length-1)return t;let r=s[e];return s[e]=s[e+1],s[e+1]=r,{...t,form_fields_schema:{...t.form_fields_schema,fields:s}}})}}}(f.workflow_name,0,0),{templateLoading:L,templateData:U,handleTemplateChange:E}=function(e,t,s){let[r,l]=(0,a.useState)(!1),[n,d]=(0,a.useState)({template_name:"",template_description:"",html_content:"",is_published:!1}),[c,m]=(0,a.useState)([]),[x,h]=(0,a.useState)(!1),[p,u]=(0,a.useState)(0),[b,f]=(0,a.useState)("split"),[g,w]=(0,a.useState)("desktop"),[_,j]=(0,a.useState)(!1),[v,y]=(0,a.useState)(null),[N,k]=(0,a.useState)(""),C=async e=>{l(!0);try{let t=await i.hi.getTemplate(e);if(d({template_name:t.template_name||"",template_description:t.template_description||"",html_content:t.html_content||"",is_published:t.is_published||!1}),t.html_content){let e=o(t.html_content);m(e),t.html_content.trim()&&!x&&(h(!0),u(1))}}catch(e){console.error("Failed to load template:",e)}finally{l(!1)}},S=async()=>{if(!N.trim())return{error:"Please describe what changes you want to make"};if(!n.html_content.trim())return{error:"No HTML content to refine"};j(!0),y("Refining template with AI...");try{let e=(await i.hi.refineTemplateWithAI({current_html:n.html_content,edit_prompt:N.trim(),model:"gpt-5"})).html_content;d(t=>({...t,html_content:e}));let t=o(e);return m(t),u(e=>e+1),x||h(!0),k(""),setTimeout(()=>{y(null)},2e3),{success:!0}}catch(e){return{error:e.response?.data?.message||e.message||"Failed to refine template with AI"}}finally{j(!1)}};return{templateLoading:r,templateData:n,setTemplateData:d,detectedPlaceholders:c,showPreview:x,setShowPreview:h,previewKey:p,templateViewMode:b,setTemplateViewMode:f,devicePreviewSize:g,setDevicePreviewSize:w,refining:_,generationStatus:v,editPrompt:N,setEditPrompt:k,handleTemplateChange:(e,t)=>{d(s=>({...s,[e]:t}))},handleHtmlChange:e=>{d(t=>({...t,html_content:e})),m(o(e)),u(e=>e+1),e.trim()&&!x&&h(!0)},handleRefine:S,insertPlaceholder:e=>{let t=`{{${e}}}`;d(e=>({...e,html_content:e.html_content+t}))},loadTemplate:C}}(f.workflow_name,0,f.template_id),I=async r=>{if(r.preventDefault(),b(null),!f.workflow_name.trim()){b("Lead magnet name is required");return}if(0===w.length){b("At least one step is required");return}for(let e=0;e<w.length;e++){let t=w[e];if(!t.step_name.trim()){b(`Step ${e+1} name is required`);return}if("webhook"===t.step_type){if(!t.webhook_url||!t.webhook_url.trim()){b(`Step ${e+1} webhook URL is required`);return}}else if(!t.instructions||!t.instructions.trim()){b(`Step ${e+1} instructions are required`);return}}p(!0);try{let r=t;if(U.html_content.trim()){let e=o(U.html_content);if(t)await i.hi.updateTemplate(t,{template_name:U.template_name.trim(),template_description:U.template_description.trim(),html_content:U.html_content.trim(),placeholder_tags:e.length>0?e:void 0});else{let t=await i.hi.createTemplate({template_name:U.template_name.trim(),template_description:U.template_description.trim(),html_content:U.html_content.trim(),placeholder_tags:e.length>0?e:void 0});r=t.template_id,s(t.template_id)}}await i.hi.updateWorkflow(m,{workflow_name:f.workflow_name.trim(),workflow_description:f.workflow_description.trim()||void 0,steps:w.map((e,t)=>({...e,step_order:t,model:e.model})),template_id:r||void 0,template_version:0}),j&&await i.hi.updateForm(j,{form_name:F.form_name.trim(),public_slug:F.public_slug.trim(),form_fields_schema:F.form_fields_schema}),e.push("/dashboard/workflows")}catch(e){console.error("Failed to update:",e),b(e.response?.data?.message||e.message||"Failed to update")}finally{p(!1)}};return x||L?r.jsx("div",{className:"max-w-4xl mx-auto",children:r.jsx("div",{className:"text-center py-12",children:r.jsx("p",{className:"text-ink-600",children:"Loading..."})})}):(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[r.jsx("div",{className:"mb-6",children:r.jsx("h1",{className:"text-2xl font-bold text-ink-900",children:"Edit Lead Magnet"})}),u&&r.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-2xl",children:u}),(0,r.jsxs)("form",{onSubmit:I,className:"space-y-8",children:[(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-white/60 p-6 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-ink-700 mb-2",children:["Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",value:f.workflow_name,onChange:e=>y("workflow_name",e.target.value),className:"w-full px-4 py-2 border border-white/60 rounded-2xl bg-white/90 focus:ring-2 focus:ring-brand-500 focus:border-transparent",required:!0})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-ink-700 mb-2",children:"Description"}),r.jsx("textarea",{value:f.workflow_description,onChange:e=>y("workflow_description",e.target.value),className:"w-full px-4 py-2 border border-white/60 rounded-2xl bg-white/90 focus:ring-2 focus:ring-brand-500 focus:border-transparent",rows:3})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-white/60 p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("h2",{className:"text-lg font-semibold text-ink-900",children:"Steps"}),(0,r.jsxs)("button",{type:"button",onClick:k,className:"flex items-center px-3 py-1.5 bg-brand-600 text-white rounded-2xl hover:bg-brand-700 text-sm",children:[r.jsx(d.OvN,{className:"w-4 h-4 mr-1"}),"Add Step"]})]}),r.jsx("div",{className:"space-y-4",children:w.map((e,t)=>r.jsx(c.Z,{step:e,index:t,totalSteps:w.length,allSteps:w,onChange:N,onDelete:C,onMoveUp:S,onMoveDown:q,workflowId:m},`step-${t}-${e.step_name}-${e.step_type||"ai"}`))})]}),j&&(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-white/60 p-6 space-y-4",children:[r.jsx("h2",{className:"text-lg font-semibold text-ink-900",children:"Form"}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-ink-700 mb-2",children:"Form Name"}),r.jsx("input",{type:"text",value:F.form_name,onChange:e=>P("form_name",e.target.value),className:"w-full px-4 py-2 border border-white/60 rounded-2xl bg-white/90 focus:ring-2 focus:ring-brand-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("label",{className:"block text-sm font-medium text-ink-700",children:"Fields"}),(0,r.jsxs)("button",{type:"button",onClick:A,className:"flex items-center px-3 py-1.5 bg-brand-600 text-white rounded-2xl hover:bg-brand-700 text-sm",children:[r.jsx(d.OvN,{className:"w-4 h-4 mr-1"}),"Add Field"]})]}),r.jsx("div",{className:"space-y-3",children:F.form_fields_schema.fields.map((e,t)=>(0,r.jsxs)("div",{className:"flex gap-2 items-start border border-white/60 rounded-2xl p-3",children:[(0,r.jsxs)("div",{className:"flex-1 grid grid-cols-2 gap-2",children:[r.jsx("input",{type:"text",value:e.label,onChange:e=>D(t,"label",e.target.value),placeholder:"Label",className:"px-3 py-2 border border-white/60 rounded-2xl bg-white/90 focus:ring-2 focus:ring-brand-500"}),(0,r.jsxs)("select",{value:e.field_type,onChange:e=>D(t,"field_type",e.target.value),className:"px-3 py-2 border border-white/60 rounded-2xl bg-white/90 focus:ring-2 focus:ring-brand-500",children:[r.jsx("option",{value:"text",children:"Text"}),r.jsx("option",{value:"email",children:"Email"}),r.jsx("option",{value:"textarea",children:"Textarea"}),r.jsx("option",{value:"number",children:"Number"}),r.jsx("option",{value:"select",children:"Select"})]})]}),r.jsx("button",{type:"button",onClick:()=>$(t),className:"p-2 text-red-600 hover:bg-red-50 rounded-2xl",children:r.jsx(d.Ybf,{className:"w-4 h-4"})})]},t))})]})]}),(t||U.html_content.trim())&&(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-white/60 p-6 space-y-4",children:[r.jsx("h2",{className:"text-lg font-semibold text-ink-900",children:"Template"}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-ink-700 mb-2",children:"Template Name"}),r.jsx("input",{type:"text",value:U.template_name,onChange:e=>E("template_name",e.target.value),className:"w-full px-4 py-2 border border-white/60 rounded-2xl bg-white/90 focus:ring-2 focus:ring-brand-500"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-ink-700 mb-2",children:"HTML Content"}),r.jsx("textarea",{value:U.html_content,onChange:e=>E("html_content",e.target.value),className:"w-full px-4 py-2 border border-white/60 rounded-2xl bg-white/90 focus:ring-2 focus:ring-brand-500 font-mono text-sm",rows:20})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{type:"button",onClick:()=>e.back(),className:"px-6 py-2.5 border border-white/60 rounded-2xl hover:bg-white/90",children:"Cancel"}),(0,r.jsxs)("button",{type:"submit",disabled:h,className:"flex items-center px-6 py-2.5 bg-brand-600 text-white rounded-2xl hover:bg-brand-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx(d.mW3,{className:"w-5 h-5 mr-2"}),h?"Saving...":"Save"]})]})]})]})}},82599:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var r=s(19899);s(5507);var a=s(55562);function l({error:e,reset:t}){return r.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-md rounded-lg bg-white p-8 shadow-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx(a.bcx,{className:"h-6 w-6 text-red-500"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Something went wrong!"})]}),r.jsx("p",{className:"text-gray-600 mb-6",children:e.message||"An unexpected error occurred while loading the workflow editor."}),(0,r.jsxs)("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Try again"}),r.jsx("button",{onClick:()=>window.location.href="/dashboard/workflows",className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Go back"})]})]})})}},86016:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var r=s(19899),a=s(5507),l=s(76153),i=s(12330),n=s(55562),o=s(583),d=s(13807);function c(){let e=(0,l.useRouter)(),t=(0,o.I)(),[s,c]=(0,a.useState)(null),[m,x]=(0,a.useState)([]),[h,p]=(0,a.useState)({}),[u,b]=(0,a.useState)(!0),[f,g]=(0,a.useState)(null),[w,_]=(0,a.useState)(!1),[j,v]=(0,a.useState)(!1),[y,N]=(0,a.useState)(!1),k=async(e=t)=>{try{let t=await i.hi.getWorkflow(e);c(t),g(null)}catch(e){console.error("Failed to load workflow:",e),g(e.response?.data?.message||e.message||"Failed to load workflow"),b(!1)}},C=async()=>{N(!0);try{await i.hi.deleteWorkflow(t),e.push("/dashboard/workflows")}catch(e){console.error("Failed to delete workflow:",e),g(e.response?.data?.message||e.message||"Failed to delete workflow")}finally{N(!1),v(!1)}},S=async()=>{if(s){_(!0),g(null);try{let e=s.workflow_name.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),r={workflow_id:t,form_name:`${s.workflow_name} Form`,public_slug:e||`form-${t.slice(-8)}`,form_fields_schema:{fields:[{field_id:"field_1",field_type:"text",label:"Name",placeholder:"Your name",required:!0},{field_id:"field_2",field_type:"email",label:"Email",placeholder:"your@email.com",required:!0},{field_id:"field_3",field_type:"text",label:"Industry",placeholder:"Your industry",required:!1},{field_id:"field_4",field_type:"textarea",label:"Description",placeholder:"Tell us about your needs",required:!1},{field_id:"field_5",field_type:"tel",label:"Phone",placeholder:"Your phone number",required:!1}]},rate_limit_enabled:!0,rate_limit_per_hour:10,captcha_enabled:!1};await i.hi.createForm(r),await k()}catch(e){console.error("Failed to create form:",e),g(e.response?.data?.message||e.message||"Failed to create form")}finally{_(!1)}}};return u?r.jsx("div",{className:"max-w-7xl mx-auto",children:r.jsx("div",{className:"text-center py-12",children:r.jsx("p",{className:"text-ink-600",children:"Loading workflow..."})})}):f&&!s?(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[r.jsx("div",{className:"mb-6",children:(0,r.jsxs)("button",{onClick:()=>e.back(),className:"flex items-center text-ink-600 hover:text-ink-900 mb-4",children:[r.jsx(n.Ao2,{className:"w-4 h-4 mr-2"}),"Back"]})}),r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-2xl",children:f})]}):s?(0,r.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[r.jsx("div",{className:"flex items-center gap-2 text-sm text-ink-600",children:(0,r.jsxs)("button",{onClick:()=>e.back(),className:"inline-flex items-center gap-2 px-3 py-2 rounded-2xl bg-white border border-white/60 shadow-soft hover:bg-white/80 transition-colors touch-target",children:[r.jsx(n.Ao2,{className:"w-4 h-4"}),"Back"]})}),f&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-2xl text-sm sm:text-base",children:f}),r.jsx("div",{className:"bg-white rounded-2xl shadow-soft border border-white/60 p-5 sm:p-6",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4",children:[(0,r.jsxs)("div",{className:"flex-1 space-y-2",children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-ink-900",children:s.workflow_name}),s.workflow_description&&r.jsx("p",{className:"text-sm sm:text-base text-ink-600",children:s.workflow_description}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs text-ink-600",children:[s.status&&(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full border border-white/60 bg-surface-50 font-medium",children:["Status: ",s.status]}),s.template_version&&(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full border border-white/60 bg-surface-50 font-medium",children:["Template v",s.template_version]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[(0,r.jsxs)("button",{onClick:()=>e.push(`/dashboard/workflows/${t}/edit`),className:"flex items-center justify-center px-4 py-3 bg-brand-600 text-white rounded-2xl hover:bg-brand-700 transition-colors text-sm sm:text-base touch-target shadow-soft",children:[r.jsx(n.vPQ,{className:"w-4 h-4 mr-2"}),"Edit"]}),(0,r.jsxs)("button",{onClick:()=>v(!0),className:"flex items-center justify-center px-4 py-3 bg-red-600 text-white rounded-2xl hover:bg-red-700 transition-colors text-sm sm:text-base touch-target",children:[r.jsx(n.Ybf,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})}),r.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-soft border border-white/60 p-4 sm:p-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[r.jsx(n.nbt,{className:"w-5 h-5 text-ink-600"}),r.jsx("h2",{className:"text-lg font-semibold text-ink-900",children:"Workflow Details"})]}),(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-ink-500 uppercase tracking-wide mb-2",children:"Template ID"}),(0,r.jsxs)("div",{className:"bg-surface-50 rounded-2xl p-3 border border-white/60",children:[r.jsx("p",{className:"text-xs font-mono text-ink-900 break-all",children:s.template_id||"-"}),s.template_version&&(0,r.jsxs)("p",{className:"text-xs text-ink-500 mt-1",children:["Version ",s.template_version]})]})]}),(0,r.jsxs)("div",{className:"pb-4 border-b border-white/60",children:[(0,r.jsxs)("label",{className:"flex items-center gap-1.5 text-xs font-semibold text-ink-500 uppercase tracking-wide mb-3",children:[r.jsx(n.NOg,{className:"w-3.5 h-3.5"}),"Form"]}),s.form?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"bg-surface-50 rounded-2xl p-3 border border-white/60",children:[r.jsx("p",{className:"text-sm font-semibold text-ink-900 break-words",children:s.form.form_name||"Form"}),s.form.public_slug&&(0,r.jsxs)("p",{className:"text-xs text-ink-500 mt-1 font-mono break-all",children:["/",s.form.public_slug]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[s.form.public_slug&&(0,r.jsxs)("a",{href:`/v1/forms/${s.form.public_slug}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center px-4 py-2.5 text-sm font-medium bg-brand-600 text-white rounded-2xl hover:bg-brand-700 transition-colors touch-target shadow-soft",children:[r.jsx(n.AlO,{className:"w-4 h-4 mr-1.5"}),"View Form"]}),s.form.form_id&&(0,r.jsxs)("button",{onClick:()=>e.push(`/dashboard/forms/${s.form.form_id}/edit`),className:"inline-flex items-center justify-center px-4 py-2.5 text-sm font-medium border border-white/60 text-ink-700 rounded-2xl hover:bg-surface-100 transition-colors touch-target",children:[r.jsx(n.vPQ,{className:"w-4 h-4 mr-1.5"}),"Edit Form"]})]}),s.form.public_slug&&(0,r.jsxs)("div",{className:"bg-brand-50/70 border border-brand-100 rounded-2xl p-3",children:[r.jsx("label",{className:"block text-xs font-semibold text-brand-900 mb-2",children:"Public Form URL"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"text",readOnly:!0,value:`/v1/forms/${s.form.public_slug}`,className:"flex-1 text-xs font-mono bg-white border border-brand-200 rounded-2xl px-3 py-2 text-ink-900 break-all focus:outline-none focus:ring-2 focus:ring-brand-500",onClick:e=>e.target.select()}),r.jsx("button",{onClick:()=>{let e=`/v1/forms/${s.form.public_slug}`;navigator.clipboard.writeText(e)},className:"p-2.5 text-brand-700 hover:text-brand-900 hover:bg-brand-100 rounded-2xl transition-colors flex-shrink-0 touch-target border border-brand-200",title:"Copy URL",children:r.jsx(n.C3L,{className:"w-4 h-4"})})]})]})]}):(0,r.jsxs)("div",{className:"bg-surface-50 rounded-2xl p-4 border border-white/60 text-center",children:[r.jsx("p",{className:"text-sm text-ink-600 mb-3",children:"No form attached to this lead magnet yet."}),r.jsx("button",{onClick:S,disabled:w,className:"inline-flex items-center justify-center px-4 py-2.5 text-sm font-medium bg-brand-600 text-white rounded-2xl hover:bg-brand-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed touch-target shadow-soft",children:w?(0,r.jsxs)(r.Fragment,{children:[r.jsx(n.TCC,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(n.XKb,{className:"w-4 h-4 mr-2"}),"Create Form"]})})]})]}),s.delivery_webhook_url&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-ink-500 uppercase tracking-wide mb-2",children:"Webhook URL"}),r.jsx("div",{className:"bg-surface-50 rounded-2xl p-3 border border-white/60",children:r.jsx("p",{className:"text-xs font-mono text-ink-900 break-all",children:s.delivery_webhook_url})})]}),s.delivery_phone&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-ink-500 uppercase tracking-wide mb-2",children:"Delivery Phone"}),r.jsx("p",{className:"text-sm font-medium text-ink-900 break-words",children:s.delivery_phone})]}),(0,r.jsxs)("div",{className:"pt-4 border-t border-white/60",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-semibold text-ink-500 uppercase tracking-wide mb-3",children:[r.jsx(n.vlc,{className:"w-3.5 h-3.5"}),"Timeline"]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs text-ink-500 mb-1",children:"Created"}),r.jsx("p",{className:"text-sm font-medium text-ink-900",children:s.created_at?new Date(s.created_at).toLocaleString():"-"})]}),s.updated_at&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs text-ink-500 mb-1",children:"Last Updated"}),r.jsx("p",{className:"text-sm font-medium text-ink-900",children:new Date(s.updated_at).toLocaleString()})]})]})]})]})]})}),(0,r.jsxs)("div",{className:"mt-4 sm:mt-6 bg-white rounded-2xl shadow-soft border border-white/60 p-4 sm:p-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[r.jsx(n.TCC,{className:"w-5 h-5 text-ink-600"}),r.jsx("h2",{className:"text-lg font-semibold text-ink-900",children:"Recent Jobs"})]}),0===m.length?r.jsx("p",{className:"text-ink-500 text-sm",children:"No jobs found for this workflow"}):r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-white/60",children:[r.jsx("thead",{className:"bg-surface-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase tracking-wider",children:"Job ID"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase tracking-wider",children:"Created"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase tracking-wider",children:"Duration"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-ink-500 uppercase tracking-wider",children:"Submission"}),r.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-ink-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-white/60",children:m.map(t=>{let s=t.completed_at?Math.round((new Date(t.completed_at).getTime()-new Date(t.created_at).getTime())/1e3):null,a=h[t.job_id];return(0,r.jsxs)("tr",{className:"hover:bg-surface-50",children:[r.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:r.jsx("button",{onClick:()=>e.push(`/dashboard/jobs/${t.job_id}`),className:"text-xs font-mono text-ink-900 hover:text-brand-600 transition-colors text-left",children:t.job_id})}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-ink-600",children:new Date(t.created_at).toLocaleString()}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-ink-600",children:null!==s?`${s}s`:"-"}),r.jsx("td",{className:"px-4 py-3 text-sm text-ink-600",children:a&&a.submission_data?r.jsx("div",{className:"max-w-xs",children:r.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:Object.entries(a.submission_data).slice(0,4).map(([e,t])=>(0,r.jsxs)("div",{className:"truncate",children:[(0,r.jsxs)("span",{className:"font-medium text-ink-500",children:[e,":"]})," ",(0,r.jsxs)("span",{className:"text-ink-900",children:[String(t).substring(0,20),String(t).length>20?"...":""]})]},e))})}):r.jsx("span",{className:"text-ink-300",children:"-"})}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm",children:r.jsx("button",{onClick:()=>e.push(`/dashboard/jobs/${t.job_id}`),className:"text-brand-600 hover:text-brand-700 hover:bg-brand-50 px-3 py-1.5 rounded-2xl transition-colors",children:"View"})})]},t.job_id)})})]})})]}),r.jsx(d.Q,{open:j,title:"Delete lead magnet?",description:(0,r.jsxs)("span",{children:["This will delete ",r.jsx("span",{className:"font-semibold",children:s.workflow_name})," and its associated form. This action cannot be undone."]}),confirmLabel:"Delete",tone:"danger",loading:y,onConfirm:C,onCancel:()=>v(!1)})]}):null}},59507:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var r=s(19899),a=s(55562),l=s(65684),i=s(95655),n=s(7038),o=s(71383),d=s(32183),c=s(83100);function m({step:e,index:t,totalSteps:s,allSteps:m=[],onChange:x,onDelete:h,onMoveUp:p,onMoveDown:u,workflowId:b}){let{localStep:f,webhookHeaders:g,handleChange:w,handleWebhookHeadersChange:_}=(0,d.x)({step:e,index:t,onChange:x}),{computerUseConfig:j,isToolSelected:v,handleToolToggle:y,handleComputerUseConfigChange:N}=(0,c.t)({step:f,onChange:w});return(0,r.jsxs)("div",{className:"border border-gray-300 rounded-lg p-6 bg-white shadow-sm",onKeyDown:e=>{"Enter"===e.key&&"TEXTAREA"!==e.target.tagName&&(e.preventDefault(),e.stopPropagation())},children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex items-center gap-1 text-gray-400",children:r.jsx("span",{className:"text-xs",children:"⋮⋮"})}),(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Step ",t+1]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("button",{type:"button",onClick:()=>p(t),disabled:0===t,className:"p-2 text-gray-600 hover:text-gray-900 disabled:text-gray-300 disabled:cursor-not-allowed touch-target","aria-label":"Move step up",children:r.jsx(a.rH8,{className:"w-5 h-5"})}),r.jsx("button",{type:"button",onClick:()=>u(t),disabled:t===s-1,className:"p-2 text-gray-600 hover:text-gray-900 disabled:text-gray-300 disabled:cursor-not-allowed touch-target","aria-label":"Move step down",children:r.jsx(a.bTu,{className:"w-5 h-5"})}),r.jsx("button",{type:"button",onClick:()=>h(t),className:"p-2 text-red-600 hover:text-red-700 touch-target","aria-label":"Delete step",children:r.jsx(a.Ybf,{className:"w-5 h-5"})})]})]}),r.jsx(o.E,{workflowId:b,step:f,stepIndex:t,onAccept:e=>{x(t,e)}}),(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx(l.b,{step:f,onChange:w}),("ai_generation"===f.step_type||!f.step_type)&&r.jsx(i.b,{step:f,isToolSelected:v,onToolToggle:y,onToolChoiceChange:e=>w("tool_choice",e),onComputerUseConfigChange:N,computerUseConfig:j}),(()=>{let e="webhook"===f.step_type;return console.log("[WorkflowStepEditor] Rendering step",t,"step_type:",f.step_type,"isWebhook:",e),e&&r.jsx(n.E,{step:f,webhookHeaders:g,allSteps:m,currentStepIndex:t,onChange:w,onWebhookHeadersChange:_})})(),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dependencies (optional)"}),r.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Select which steps must complete before this step runs. Leave empty to auto-detect from step order."}),r.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto border border-gray-200 rounded-lg p-3",children:m.length>0?m.map((e,s)=>{if(s===t)return null;let a=(f.depends_on||[]).includes(s);return(0,r.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:a,onChange:e=>{let t=f.depends_on||[];w("depends_on",e.target.checked?[...t,s]:t.filter(e=>e!==s))},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,r.jsxs)("span",{className:"text-sm text-gray-900",children:["Step ",s+1,": ",e.step_name]})]},s)}):r.jsx("p",{className:"text-sm text-gray-500",children:"No other steps available"})}),f.depends_on&&f.depends_on.length>0&&(0,r.jsxs)("p",{className:"mt-2 text-xs text-gray-600",children:["Depends on: ",f.depends_on.map(e=>`Step ${e+1}`).join(", ")]})]})]})]})}},583:(e,t,s)=>{"use strict";s.d(t,{I:()=>l});var r=s(76153),a=s(5507);function l(){let e=(0,r.useParams)(),t=(0,a.useCallback)(()=>{let t=e?.slug,s=((Array.isArray(t)?t[0]:t)||e?.id)??"";return s&&"_"!==s?s:""},[e]),[s,l]=(0,a.useState)(()=>t());return s}},13807:(e,t,s)=>{"use strict";s.d(t,{Q:()=>a});var r=s(19899);function a({open:e,title:t,description:s,confirmLabel:a="Confirm",cancelLabel:l="Cancel",tone:i="default",loading:n=!1,onConfirm:o,onCancel:d}){return e?(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-ink-900/60 backdrop-blur-sm",onClick:d,"aria-hidden":"true"}),r.jsx("div",{className:"relative z-10 w-full max-w-md rounded-2xl bg-white shadow-soft border border-white/60 p-6",role:"dialog","aria-modal":"true","aria-labelledby":"confirm-dialog-title",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("h3",{id:"confirm-dialog-title",className:"text-lg font-semibold text-ink-900",children:t}),s&&r.jsx("div",{className:"text-sm text-ink-600",children:s})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-3",children:[r.jsx("button",{type:"button",onClick:d,className:"w-full sm:w-auto px-4 py-3 sm:py-2.5 rounded-2xl border border-white/60 bg-white text-ink-700 hover:bg-surface-50 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 touch-target",children:l}),r.jsx("button",{type:"button",onClick:o,disabled:n,className:`w-full sm:w-auto px-4 py-3 sm:py-2.5 rounded-2xl text-white ${"danger"===i?"bg-red-600 hover:bg-red-700 focus:ring-red-500":"bg-brand-600 hover:bg-brand-700 focus:ring-brand-500"} transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 touch-target disabled:opacity-60 disabled:cursor-not-allowed`,children:n?"Working...":a})]})]})})]}):null}},95557:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(2772).createProxy)(String.raw`/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/workflows/[...slug]/error.tsx#default`)},77634:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o,generateStaticParams:()=>n});var r=s(35023),a=s(2772);let l=(0,a.createProxy)(String.raw`/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/workflows/[...slug]/page-client.tsx#default`),i=(0,a.createProxy)(String.raw`/Users/canyonsmith/lead-magnent-ai/frontend/src/app/dashboard/workflows/[...slug]/EditWorkflowClient.tsx#default`);async function n(){return[{slug:["_"]},{slug:["_","edit"]}]}function o({params:e}){let t=e.slug??[];return t.length>1&&"edit"===t[1]?r.jsx(i,{}):r.jsx(l,{})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[257,138,920,501,809],()=>s(13153));module.exports=r})();