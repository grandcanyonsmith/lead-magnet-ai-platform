(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3670],{90974:function(e,t,s){Promise.resolve().then(s.bind(s,777))},777:function(e,t,s){"use strict";s.d(t,{default:function(){return eT}});var r=s(37821),a=s(58504),n=s(77851),l=s(58078),i=s(63951);function o(e){var t;let s=null==e?void 0:e.slug,r=null!==(t=(Array.isArray(s)?s[0]:s)||(null==e?void 0:e.id))&&void 0!==t?t:"";if(r&&"_"!==r&&""!==r.trim())return r;{let e=window.location.pathname.match(/\/dashboard\/jobs\/([^/?#]+)/);if(e&&e[1]&&"_"!==e[1]&&""!==e[1].trim())return e[1];let t=window.location.hash.match(/\/dashboard\/jobs\/([^/?#]+)/);if(t&&t[1]&&"_"!==t[1]&&""!==t[1].trim())return t[1]}return""}async function d(e){let t=localStorage.getItem("agency_selected_customer_id");t&&localStorage.removeItem("agency_selected_customer_id");try{return await e()}finally{t&&localStorage.setItem("agency_selected_customer_id",t)}}async function c(e,t){try{let s=await d(()=>i.hi.getWorkflow(e));t(s)}catch(e){console.error("Failed to load workflow:",e)}}async function u(e,t,s){try{let r=await d(()=>i.hi.getSubmission(e));if(t(r),r.form_id)try{let e=await d(()=>i.hi.getForm(r.form_id));s(e)}catch(e){console.error("Failed to load form:",e)}}catch(e){console.error("Failed to load submission:",e)}}function m(e,t){var s,r;return{tools:e.tools||(null==t?void 0:null===(s=t.input)||void 0===s?void 0:s.tools)||(null==t?void 0:t.tools)||[],tool_choice:e.tool_choice||(null==t?void 0:null===(r=t.input)||void 0===r?void 0:r.tool_choice)||(null==t?void 0:t.tool_choice)||"auto"}}function x(e,t){let{tools:s,tool_choice:r}=m(t,e);return{...e,step_type:"workflow_step",step_name:t.step_name||e.step_name,model:t.model||e.model,tools:s,tool_choice:r,instructions:t.instructions||e.instructions,input:{...e.input,tools:s,tool_choice:r},duration_ms:e.duration_ms,usage_info:e.usage_info,started_at:e.started_at,completed_at:e.completed_at,output:e.output,error:e.error,artifact_id:e.artifact_id,image_urls:e.image_urls,_status:e._status||"pending"}}function p(e){let{error:t,job:s}=e,l=(0,a.useRouter)(),i=(null==s?void 0:s.execution_steps)&&Array.isArray(s.execution_steps)?s.execution_steps.reduce((e,t)=>{var s;let r=null===(s=t.usage_info)||void 0===s?void 0:s.cost_usd;if(null==r)return e;if("number"==typeof r)return e+r;if("string"==typeof r){let t=parseFloat(r);return e+(isNaN(t)?0:t)}return e},0):null;return(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("button",{onClick:()=>l.back(),className:"flex items-center text-ink-600 hover:text-ink-900 mb-4 py-2 px-2 rounded-2xl bg-white border border-white/60 shadow-soft hover:bg-surface-50 touch-target transition-colors",children:[(0,r.jsx)(n.Ao2,{className:"w-4 h-4 mr-2"}),"Back"]}),t&&(0,r.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-2xl shadow-soft",children:t}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-3 sm:gap-0",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-ink-900",children:"Lead Magnet Details"}),(0,r.jsx)("p",{className:"text-sm sm:text-base text-ink-600 mt-1",children:"View details and status of your generated lead magnet"})]}),null!==i&&(0,r.jsxs)("div",{className:"sm:text-right",children:[(0,r.jsx)("div",{className:"text-xs font-medium uppercase tracking-wide text-ink-500",children:"Total Cost"}),(0,r.jsxs)("div",{className:"text-sm sm:text-base text-ink-900 mt-1",children:["$",i.toFixed(2)]})]})]})]})}var h=s(16028);function g(e){let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/1e3);if(s<60)return"".concat(s," seconds ago");let r=Math.floor(s/60);if(r<60)return"".concat(r," ").concat(1===r?"minute":"minutes"," ago");let a=Math.floor(r/60);if(a<24)return"".concat(a," ").concat(1===a?"hour":"hours"," ago");let n=Math.floor(a/24);return"".concat(n," ").concat(1===n?"day":"days"," ago")}function f(e){if(e<1e3)return"".concat(Math.round(e),"ms");let t=Math.round(e/1e3),s=Math.floor(t/60),r=t%60;return 0===s?"".concat(r,"s"):"".concat(s,"m ").concat(r,"s")}function b(e){return"string"==typeof e&&[/^#{1,6}\s+.+/m,/\*\*.*?\*\*/,/\*.*?\*/,/\[.*?\]\(.*?\)/,/^[-*+]\s+/m,/^\d+\.\s+/m,/```[\s\S]*?```/,/`[^`]+`/].some(t=>t.test(e))}function y(e){if("form_submission"===e.step_type)return{content:e.input,type:"json"};if("webhook"===e.step_type){let t=e.input;return{content:{webhook_url:(null==t?void 0:t.webhook_url)||"N/A",payload:(null==t?void 0:t.payload)||{}},type:"json"}}if(e.input&&"object"==typeof e.input){let t=e.input;if(!t)return{content:e.input,type:"json"};let s=t.input||"";return"string"==typeof s&&b(s)?{content:{model:e.model||"N/A",instructions:t.instructions||"N/A",input:s},type:"markdown",structure:"ai_input"}:{content:{model:e.model||"N/A",instructions:t.instructions||"N/A",input:t.input||t},type:"json",structure:"ai_input"}}return{content:e.input,type:"json"}}function j(e){if("final_output"===e.step_type)return{content:e.output,type:"json"};if("webhook"===e.step_type){var t;let s=e.output;return{content:{success:null!==(t=null==s?void 0:s.success)&&void 0!==t&&t,response_status:(null==s?void 0:s.response_status)||"N/A",response_body:(null==s?void 0:s.response_body)||null,error:(null==s?void 0:s.error)||null},type:"json"}}if("string"==typeof e.output){if(function(e){if("string"!=typeof e)return!1;let t=e.trim(),s=/<[a-z][\s\S]*>/i.test(t),r=/<\/[a-z]+>/i.test(t);return[/^<!DOCTYPE\s+html/i,/^<html[\s>]/i,/<\/html>\s*$/i,/^<\!--[\s\S]*?-->/].some(e=>e.test(t))||s&&r}(e.output))return{content:e.output,type:"html"};if(function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(e.output))try{return{content:JSON.parse(e.output),type:"json"}}catch(e){}return b(e.output)?{content:e.output,type:"markdown"}:{content:e.output,type:"text"}}return{content:e.output,type:"json"}}async function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Copied to clipboard",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Unable to copy automatically. Please copy manually.";try{if("undefined"!=typeof navigator&&navigator.clipboard)await navigator.clipboard.writeText(e),h.Am.success(t);else{let s=document.createElement("textarea");s.value=e,s.style.position="fixed",s.style.opacity="0",document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),h.Am.success(t)}}catch(e){console.error("Failed to copy to clipboard:",e),h.Am.error(s)}}var w=s(5485),N=s(20758),_=s(82164),k=s(54597);function S(e){var t,s,o,d;let{job:c,workflow:u,hideContainer:m=!1}=e,x=(0,a.useRouter)(),[p,f]=(0,l.useState)(!1),b=new Date(c.created_at),y=c.completed_at?new Date(c.completed_at):null,j=c.completed_at&&c.created_at?Math.round((y.getTime()-b.getTime())/1e3):null,S=c.execution_steps&&Array.isArray(c.execution_steps)?c.execution_steps.reduce((e,t)=>{var s;let r=null===(s=t.usage_info)||void 0===s?void 0:s.cost_usd;return e+("number"==typeof r?r:0)},0):null,C=null!==(d=null!==(o=null==u?void 0:null===(t=u.steps)||void 0===t?void 0:t.length)&&void 0!==o?o:null===(s=c.execution_steps)||void 0===s?void 0:s.length)&&void 0!==d?d:null,I=!!c.output_url,T=async()=>{if(!I||p)return;f(!0);let e=null;try{if(!(e=await i.hi.getJobDocumentBlobUrl(c.job_id)))throw Error("Failed to create blob URL");let t=window.open(e,"_blank","noopener,noreferrer");if(!t||t.closed||void 0===t.closed){h.Am.error("Popup blocked. Please allow popups for this site and try again."),e&&URL.revokeObjectURL(e);return}setTimeout(()=>{e&&URL.revokeObjectURL(e)},5e3),h.Am.success("Document opened in new tab")}catch(t){console.error("Failed to open document:",t);let e="object"==typeof t&&t&&"message"in t?String(t.message):"";e.includes("404")||e.includes("not found")?h.Am.error("Document not found. It may not have been generated yet."):e.includes("403")||e.includes("permission")?h.Am.error("You do not have permission to view this document."):e.includes("network")||e.includes("fetch")?h.Am.error("Network error. Please check your connection and try again."):e?h.Am.error("Failed to open document: ".concat(e)):h.Am.error("Failed to open document. Please try again.")}finally{f(!1)}},A=[{label:"Processing Time",value:null!==j?function(e){if(e<60)return"".concat(e,"s");let t=Math.floor(e/60);return t<60?"".concat(t,"m ").concat(e%60,"s"):"".concat(Math.floor(t/60),"h ").concat(t%60,"m")}(j):"In progress",tone:null!==j?"neutral":"warning",icon:(0,r.jsx)(n.TCC,{className:"h-4 w-4"}),helperText:null!==j?"Completed ".concat(g(c.completed_at)):"We will calculate duration once this job finishes."},null!==S&&S>=0?{label:"Total Cost",value:"$".concat(S.toFixed(2)),tone:S>5?"warning":"neutral",icon:(0,r.jsx)(n.oQC,{className:"h-4 w-4"}),helperText:"Aggregated from every execution step."}:null,null!==C?{label:"Execution Steps",value:"".concat(C," ").concat(1===C?"step":"steps"),tone:"neutral",icon:(0,r.jsx)(n.yG,{className:"h-4 w-4"}),helperText:(null==u?void 0:u.steps)?"Loaded from the workflow definition.":"Pulled from the job execution log."}:null].filter(Boolean),E=[{label:"Job ID",value:(0,r.jsx)("code",{className:"text-sm font-semibold text-gray-900",children:c.job_id}),helperText:"Reference this when reaching out to support.",copyValue:c.job_id},c.workflow_id?{label:"Workflow",value:u?(0,r.jsxs)("button",{type:"button",onClick:()=>x.push("/dashboard/workflows/".concat(c.workflow_id)),className:"inline-flex items-center gap-1.5 font-medium text-primary-600 transition hover:text-primary-800",children:[u.workflow_name||c.workflow_id,(0,r.jsx)(n.AlO,{className:"h-4 w-4","aria-hidden":"true"})]}):(0,r.jsx)("span",{className:"font-medium text-gray-900",children:c.workflow_id}),helperText:u?"Opens the workflow in a new view.":void 0}:null,{label:"Created",value:g(c.created_at),helperText:b.toLocaleString()},y?{label:"Completed",value:g(c.completed_at),helperText:y.toLocaleString()}:null,c.submission_id?{label:"Submission ID",value:(0,r.jsx)("span",{className:"font-mono text-sm",children:c.submission_id}),helperText:"Form submission tied to this job.",copyValue:c.submission_id}:null,c.execution_steps_s3_key?{label:"Execution Log Key",value:(0,r.jsx)("span",{className:"font-mono text-xs break-all",children:c.execution_steps_s3_key}),helperText:"Raw execution data location.",copyValue:c.execution_steps_s3_key}:null].filter(Boolean),F=I?"Open the generated asset in a new browser tab.":"failed"===c.status?"This job failed before a document could be generated.":"We will attach a document as soon as the workflow finishes.",L=(0,r.jsx)("div",{className:"rounded-2xl border border-dashed border-primary-200 bg-primary-50/60 px-4 py-4 sm:px-6",children:(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Lead magnet document"}),(0,r.jsx)("p",{className:"text-xs text-gray-600",children:F})]}),(0,r.jsx)("button",{type:"button",onClick:T,disabled:!I||p,className:"inline-flex items-center justify-center gap-2 rounded-full border border-primary-600 px-4 py-2 text-sm font-semibold text-primary-700 transition hover:bg-primary-600 hover:text-white disabled:cursor-not-allowed disabled:border-gray-200 disabled:bg-white disabled:text-gray-400",children:p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.dAq,{className:"h-4 w-4 animate-spin","aria-hidden":"true"}),"Preparing..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.NOg,{className:"h-4 w-4","aria-hidden":"true"}),I?"View document":"failed"===c.status?"Unavailable":"Preparing"]})})]})}),R=(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 rounded-2xl border border-gray-100 bg-gray-50/60 px-4 py-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-medium uppercase tracking-wide text-gray-500",children:"Job status"}),(0,r.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[(0,r.jsx)(k.O,{status:c.status}),c.failed_at&&(0,r.jsxs)("span",{className:"text-xs font-medium text-red-700",children:["Failed ",g(c.failed_at)]}),c.completed_at&&(0,r.jsxs)("span",{className:"text-xs font-medium text-gray-500",children:["Finished ",g(c.completed_at)]})]})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Started ",g(c.created_at),(0,r.jsxs)("span",{className:"ml-1 text-gray-400",children:["(",b.toLocaleString(),")"]})]})]}),L,A.length>0&&(0,r.jsx)("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:A.map(e=>(0,r.jsx)(N.D,{label:e.label,value:e.value,tone:e.tone,helperText:e.helperText,icon:e.icon},e.label))}),E.length>0&&(0,r.jsx)(_.U,{items:E,columns:2,onCopy:e=>{v(e)}}),"failed"===c.status&&c.error_message&&(0,r.jsxs)("div",{className:"rounded-2xl border border-red-100 bg-red-50/70 p-4 text-sm text-red-900",role:"alert","aria-live":"polite",children:[(0,r.jsx)("p",{className:"font-semibold",children:"Error details"}),(0,r.jsx)("p",{className:"mt-1",children:c.error_message.includes("Error")||c.error_message.includes("error")?c.error_message:"Generation failed: ".concat(c.error_message)})]})]});return m?R:(0,r.jsx)(w.q,{title:"Job details",description:"Track document generation progress, metadata, and troubleshooting info.",children:R})}function C(e){let{steps:t,jobStatus:s,getStepStatus:a}=e,n=(0,l.useMemo)(()=>{let e=t.length;if(0===e)return null;let r=[...t].sort((e,t)=>{var s,r;return(null!==(s=e.step_order)&&void 0!==s?s:0)-(null!==(r=t.step_order)&&void 0!==r?r:0)}),n=0,l=0;for(let e of r){let t=a(e);if("completed"===t)n++;else if("in_progress"===t){l=e.step_order||r.indexOf(e)+1;break}}return(0===l&&(l="processing"===s?n+1:"completed"===s?e:n>0?n+1:1),"processing"===s||n>0||"completed"===s)?{current:l,total:e,isProcessing:"processing"===s}:null},[t,s,a]);return n?(0,r.jsxs)("span",{className:"px-3 py-1.5 text-xs font-bold rounded-xl shadow-sm ring-1 transition-all duration-200 ".concat(n.isProcessing?"bg-gradient-to-br from-blue-100 to-blue-50 text-blue-800 ring-blue-200/60 animate-pulse":"bg-gradient-to-br from-gray-100 to-gray-50 text-gray-800 ring-gray-200/60"),children:[n.current,"/",n.total]}):null}function I(e){return null!==e.output&&void 0!==e.output&&""!==e.output}var T=s(3909);function A(e){let{content:t,children:s,position:a="top"}=e,[n,i]=(0,l.useState)(!1);return(0,r.jsxs)("div",{className:"relative inline-block",onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:[s,n&&(0,r.jsx)("div",{className:"absolute z-50 ".concat({top:"bottom-full left-1/2 -translate-x-1/2 mb-2",bottom:"top-full left-1/2 -translate-x-1/2 mt-2",left:"right-full top-1/2 -translate-y-1/2 mr-2",right:"left-full top-1/2 -translate-y-1/2 ml-2"}[a]," pointer-events-none"),children:(0,r.jsxs)("div",{className:"bg-gray-900 text-white text-xs rounded-lg py-2 px-3 shadow-lg max-w-xs whitespace-normal",children:[t,(0,r.jsx)("div",{className:"absolute ".concat("top"===a?"top-full left-1/2 -translate-x-1/2 -mt-1":"bottom"===a?"bottom-full left-1/2 -translate-x-1/2 -mb-1":"left"===a?"left-full top-1/2 -translate-y-1/2 -ml-1":"right-full top-1/2 -translate-y-1/2 -mr-1"),children:(0,r.jsx)("div",{className:"w-2 h-2 bg-gray-900 ".concat("rotate-45")})})]})})]})}var E=s(52605);function F(e){if(!e||"string"!=typeof e)return[];let t=e.match(/https?:\/\/[^\s<>"{}|\\^`\[\]]+\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)(\?[^\s<>"{}|\\^`\[\]]*)?/gi);return t?Array.from(new Set(t)):[]}function L(e){return!!e&&"string"==typeof e&&/\.(png|jpe?g)(\?.*)?$/i.test(e)}function R(e){return e.split("?")[0].toLowerCase()}function P(e){if(!e.output)return[];if("string"==typeof e.output)return F(e.output);try{return F(JSON.stringify(e.output))}catch(e){return[]}}function D(e){return Array.isArray(e)?Array.from(new Set(e.map(e=>(function(e){if("string"==typeof e)return e;if(e&&"object"==typeof e&&"type"in e){let t=e.type;if("string"==typeof t&&t.length>0)return t}return"unknown"})(e)).filter(e=>!!e))):[]}function M(e){var t;return(null===(t=e.input)||void 0===t?void 0:t.tools)||e.tools||[]}function O(e){return Array.from(new Set([...Array.isArray(e.image_urls)?e.image_urls:[],...P(e)].filter(e=>"string"==typeof e&&e.length>0).filter(e=>L(e))))}function U(e){if(!e)return!1;let t=e.content_type||"",s=e.file_name||e.artifact_name||"",r="string"==typeof t&&t.toLowerCase().startsWith("image/"),a="string"==typeof s&&/\.(png|jpe?g)$/i.test(s);return r||a}function J(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return e.length<=t?e:"".concat(e.substring(0,t),"...")}function H(e){let{tools:t,toolChoice:s,className:a,badgeClassName:n,emptyLabel:l="None",showEmptyState:i=!0}=e,o=D(t);return 0!==o.length||s?(0,r.jsxs)("div",{className:(0,E.Z)("flex flex-wrap gap-2 items-center",a),children:[o.map(e=>(0,r.jsx)("span",{className:(0,E.Z)("px-3 py-1 text-xs font-semibold rounded-xl border whitespace-nowrap bg-gradient-to-br from-blue-50 to-blue-100/50 text-blue-700 border-blue-200/60 shadow-sm ring-1 ring-blue-100/40 transition-all duration-200 hover:shadow-md hover:border-blue-300/60",n),children:e},e)),s&&(0,r.jsxs)("span",{className:"text-xs text-gray-500 font-medium",children:["(",s,")"]})]}):i?(0,r.jsx)("span",{className:"px-2.5 py-1 text-xs font-medium bg-gray-50 text-gray-600 rounded-lg border border-gray-200/60 shadow-sm ring-1 ring-gray-100/40",children:l}):null}let z={form_submission:"bg-brand-50 text-brand-800",ai_generation:"bg-emerald-50 text-emerald-800",html_generation:"bg-amber-50 text-amber-800",final_output:"bg-surface-50 text-ink-800",workflow_step:"bg-surface-50 text-ink-800"},W={completed:"Completed",in_progress:"In Progress",failed:"Failed",pending:"Pending"},Z={completed:"bg-emerald-50 text-emerald-800 border border-emerald-200",in_progress:"bg-brand-50 text-brand-800 border border-brand-200",failed:"bg-red-50 text-red-800 border border-red-200",pending:"bg-surface-50 text-ink-700 border border-white/60"},q=new Set(["workflow_step","ai_generation","webhook"]),$=new Set(["workflow_step","ai_generation","html_generation"]);function B(e){var t,s,a,l,i;let{step:o,status:d,jobStatus:c,canEdit:u=!1,rerunningStep:m,onEditStep:x,onRerunStep:p}=e,h="pending"===d,b="completed"===d,y="in_progress"===d,j="failed"===d,v=null!==(i=o.step_order)&&void 0!==i?i:0,w=z[o.step_type]||"bg-surface-50 text-ink-800",N=W[d],_=Z[d],k=v>0?v-1:0,S=m===k,C=null!==m&&!S,I=!!u&&!!x&&q.has(o.step_type)&&v>0,E=!!p&&$.has(o.step_type)&&v>0,F=I||E,L="processing"===c,R="processing"===c&&null===m||S||C,P="completed"===d&&o.completed_at?{text:"Completed ".concat(g(o.completed_at)),tone:"default"}:"in_progress"===d?o.started_at?{text:"Started ".concat(g(o.started_at)),tone:"default"}:{text:"Currently running",tone:"default"}:"failed"===d?o.error?{text:o.error,tone:"danger"}:{text:"Step failed before producing output",tone:"danger"}:"pending"===d?{text:"Waiting for the workflow to reach this step",tone:"default"}:null,D=e=>{null==e||e.stopPropagation(),I&&x&&!L&&x(k)},M=e=>{null==e||e.stopPropagation(),p&&!R&&E&&p(k)};return(0,r.jsx)("div",{className:"relative border-b border-white/60 bg-white",children:(0,r.jsxs)("div",{className:"relative flex flex-col gap-4 p-5 sm:pr-6 lg:flex-row lg:items-start lg:gap-5",children:[(0,r.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,r.jsx)("div",{className:"p-3 rounded-2xl bg-white border shadow-soft ring-1 transition-all duration-200 ".concat(b?"border-emerald-200/70 ring-emerald-100/60":y?"border-brand-200/70 ring-brand-100/60":j?"border-red-200/70 ring-red-100/60":"border-white/60 ring-white/50"),children:function(e){let t="w-5 h-5 flex-shrink-0";switch(e){case"completed":return(0,r.jsx)(n._rq,{className:"".concat(t," text-emerald-600")});case"in_progress":return(0,r.jsx)(n.dAq,{className:"".concat(t," text-brand-600 animate-spin")});case"failed":return(0,r.jsx)(n.$Rx,{className:"".concat(t," text-red-600")});default:return(0,r.jsx)(n.Q8x,{className:"".concat(t," text-ink-400")})}}(d)})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0 space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center flex-wrap gap-2.5",children:[(0,r.jsxs)("span",{className:"px-3 py-1.5 text-xs font-bold rounded-2xl flex-shrink-0 shadow-sm ring-1 ring-black/5 transition-all duration-200 ".concat(w),children:["Step ",v]}),(0,r.jsx)("span",{className:"px-3.5 py-1.5 text-xs font-bold uppercase tracking-wider rounded-2xl shadow-sm ring-1 ring-black/5 transition-all duration-200 ".concat(_),children:N}),(y||S)&&(0,r.jsxs)("span",{className:"px-3.5 py-1.5 text-xs font-semibold bg-brand-50 text-brand-800 rounded-2xl animate-pulse flex items-center gap-1.5 shadow-sm ring-1 ring-blue-200/50",children:[(0,r.jsx)(n.dAq,{className:"w-3.5 h-3.5 animate-spin"}),S?"Rerunning...":"Processing..."]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-start flex-wrap gap-3",children:[(0,r.jsx)("h3",{className:"text-lg sm:text-xl font-bold break-words leading-tight tracking-tight ".concat(h?"text-ink-500":"text-ink-900"),children:o.step_name}),o.model&&!h&&(0,r.jsx)("span",{className:"text-xs text-ink-700 whitespace-nowrap px-3 py-1.5 bg-surface-50 rounded-2xl font-semibold border border-white/60 shadow-sm ring-1 ring-white/50",children:o.model})]}),P&&(0,r.jsx)("div",{className:"text-sm font-medium ".concat("danger"===P.tone?"text-red-600":"text-ink-600"),children:P.text})]}),!h&&(0,r.jsxs)("div",{className:"flex items-center flex-wrap gap-2.5 text-sm pt-1",children:[(0,r.jsx)("span",{className:"text-ink-600 font-semibold",children:"Tools:"}),(0,r.jsx)(H,{tools:(null===(t=o.input)||void 0===t?void 0:t.tools)||o.tools,toolChoice:(null===(s=o.input)||void 0===s?void 0:s.tool_choice)||o.tool_choice})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-3 flex-shrink-0 lg:self-start mt-2 lg:mt-0 ml-auto",children:[b&&(void 0!==o.duration_ms||o.usage_info)&&(0,r.jsx)(A,{content:(0,r.jsxs)("div",{className:"text-left space-y-1.5 text-sm",children:[void 0!==o.duration_ms&&(0,r.jsxs)("div",{className:"font-medium",children:["Duration: ",f(o.duration_ms)]}),o.usage_info&&(0,r.jsxs)(r.Fragment,{children:[o.usage_info.total_tokens&&(0,r.jsxs)("div",{className:"font-medium",children:["Tokens: ",o.usage_info.total_tokens.toLocaleString()]}),!o.usage_info.total_tokens&&(o.usage_info.prompt_tokens||o.usage_info.completion_tokens)&&(0,r.jsxs)("div",{className:"font-medium",children:["Tokens: ",((o.usage_info.prompt_tokens||0)+(o.usage_info.completion_tokens||0)).toLocaleString()]}),(null===(a=o.usage_info)||void 0===a?void 0:a.cost_usd)&&(0,r.jsxs)("div",{className:"font-medium",children:["Cost: $","number"==typeof o.usage_info.cost_usd?o.usage_info.cost_usd.toFixed(2):parseFloat(o.usage_info.cost_usd||"0").toFixed(2)]})]})]}),position:"top",children:(0,r.jsxs)("div",{className:"px-4 py-2 text-sm font-semibold text-ink-700 bg-surface-50 rounded-2xl border border-white/60 shadow-soft ring-1 ring-white/50 cursor-help hover:shadow-md hover:border-white/80 transition-all duration-200",children:[void 0!==o.duration_ms&&f(o.duration_ms),(null===(l=o.usage_info)||void 0===l?void 0:l.cost_usd)&&(0,r.jsxs)("span",{className:"ml-2.5 text-ink-600",children:["• $","number"==typeof o.usage_info.cost_usd?o.usage_info.cost_usd.toFixed(2):parseFloat(o.usage_info.cost_usd||"0").toFixed(2)]})]})}),F&&(0,r.jsx)(T.v2,{as:"div",className:"relative",children:e=>{let{open:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A,{content:"Step actions",position:"top",children:(0,r.jsx)(T.v2.Button,{onClick:e=>{e.stopPropagation()},className:"p-2 rounded-2xl transition-all touch-target min-h-[44px] min-w-[44px] sm:min-h-0 sm:min-w-0 flex items-center justify-center focus:outline-none focus-visible:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2 focus:ring-offset-white ".concat(t?"bg-surface-50 text-ink-900 shadow-soft":"text-ink-500 hover:text-ink-900 hover:bg-surface-50"),children:(0,r.jsx)(n.$Pu,{className:"w-4 h-4"})})}),(0,r.jsx)(T.v2.Items,{className:"absolute right-0 z-20 mt-2 w-52 rounded-2xl border border-white/60 bg-white shadow-soft ring-1 ring-black/5 focus:outline-none focus-visible:outline-none overflow-hidden",children:(0,r.jsxs)("div",{className:"py-1",children:[I&&(0,r.jsx)(T.v2.Item,{disabled:L,children:e=>{let{active:t,disabled:s}=e;return(0,r.jsxs)("button",{onClick:D,disabled:s,className:"w-full px-4 py-3 text-sm flex items-center gap-2 text-left ".concat(s?"text-ink-400 cursor-not-allowed":t?"bg-surface-50 text-ink-900":"text-ink-700"),children:[(0,r.jsx)(n.IYd,{className:"w-4 h-4"}),"Edit Step"]})}}),E&&(0,r.jsx)(T.v2.Item,{disabled:R,children:e=>{let{active:t,disabled:s}=e;return(0,r.jsxs)("button",{onClick:M,disabled:s,className:"w-full px-4 py-3 text-sm flex items-center gap-2 text-left ".concat(s?"text-ink-400 cursor-not-allowed":t?"bg-brand-50 text-brand-800":"text-brand-700"),children:[S?(0,r.jsx)(n.dAq,{className:"w-4 h-4 animate-spin"}):(0,r.jsx)(n.Bw1,{className:"w-4 h-4"}),"Rerun Step"]})}})]})})]})}})]})]})})}var G=s(93168),V=s(45755),K=s(58694),Q=s(23320),Y=s(21167),X=s(13159);function ee(e){let{url:t,alt:s,className:a=""}=e,[i,o]=(0,l.useState)(!0),[d,c]=(0,l.useState)(!1);return d?(0,r.jsxs)("div",{className:"my-4 md:my-2 p-4 md:p-3 bg-red-50 border-2 border-red-200 rounded-xl ".concat(a),children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 md:gap-2 text-base md:text-sm text-red-700",children:[(0,r.jsx)(n.bcx,{className:"w-5 h-5 md:w-4 md:h-4 flex-shrink-0"}),(0,r.jsx)("span",{children:"Failed to load image"})]}),(0,r.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"mt-3 md:mt-2 block text-sm md:text-xs text-blue-600 hover:text-blue-800 active:text-blue-900 hover:underline break-all touch-target py-2 md:py-1 min-h-[44px] md:min-h-0",children:t})]}):(0,r.jsxs)("div",{className:"my-4 md:my-2 w-full ".concat(a),children:[(0,r.jsx)("div",{className:"rounded-xl overflow-hidden border-2 border-gray-200 bg-white p-2 md:p-1",children:(0,r.jsxs)("div",{className:"relative w-full aspect-video bg-gray-50 rounded-lg overflow-hidden",children:[i&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-center gap-3 md:gap-2 text-base md:text-sm text-gray-500",children:[(0,r.jsx)(n.LFN,{className:"w-6 h-6 md:w-5 md:h-5 animate-pulse"}),(0,r.jsx)("span",{children:"Loading image..."})]})}),(0,r.jsx)("img",{src:t,alt:s||"Inline image",onLoad:()=>{o(!1),c(!1)},onError:()=>{o(!1),c(!0)},className:"w-full h-full object-contain rounded-lg transition-opacity duration-200 ".concat(i?"opacity-0 absolute":"opacity-100"),style:{maxHeight:"600px"},loading:"lazy"})]})}),!i&&!d&&(0,r.jsx)("div",{className:"mt-3 md:mt-1 px-2",children:(0,r.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-sm md:text-xs text-blue-600 hover:text-blue-800 active:text-blue-900 hover:underline break-all block touch-target py-2 md:py-1 min-h-[44px] md:min-h-0",children:t})})]})}function et(e){let{content:t,renderContent:s,maxLength:a=1e3}=e,[i,o]=(0,l.useState)(!1),d=t.length>a,c=d&&!i?t.substring(0,a)+"...":t;return(0,r.jsxs)("div",{children:[d&&(0,r.jsx)("div",{className:"flex justify-end mb-2",children:(0,r.jsx)("button",{onClick:()=>o(!i),className:"text-xs text-blue-600 hover:text-blue-800 active:text-blue-900 flex items-center gap-1 px-2 py-1.5 rounded touch-target min-h-[44px] sm:min-h-0",children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.rH8,{className:"w-3 h-3"}),(0,r.jsx)("span",{className:"sm:inline",children:"Show Less"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.bTu,{className:"w-3 h-3"}),(0,r.jsx)("span",{className:"sm:inline",children:"Show More"}),(0,r.jsxs)("span",{className:"hidden sm:inline",children:[" (",t.length.toLocaleString()," chars)"]})]})})}),s(c,i)]})}function es(e){let{formatted:t,imageUrls:s=[],showImages:a=!0}=e,[n,i]=(0,l.useState)(!0),o=a?s:[],d="string"==typeof t.content?t.content:JSON.stringify(t.content,null,2),c=()=>a&&o&&Array.isArray(o)&&0!==o.length?(0,r.jsxs)("div",{className:"mt-5 md:mt-4 space-y-4 md:space-y-2",children:[(0,r.jsx)("div",{className:"text-sm md:text-xs font-medium text-gray-600 mb-3 md:mb-2",children:"Generated Images:"}),o.map((e,t)=>(0,r.jsx)(ee,{url:e,alt:"Image ".concat(t+1)},"inline-image-".concat(t)))]}):null,u=()=>"ai_input"!==t.structure||"object"!=typeof t.content?null:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs font-semibold text-gray-700",children:"Model:"}),(0,r.jsx)("span",{className:"text-xs text-gray-900 ml-2 font-mono",children:t.content.model})]}),t.content.tool_choice&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs font-semibold text-gray-700",children:"Tool Choice:"}),(0,r.jsx)("span",{className:"text-xs text-gray-900 ml-2",children:t.content.tool_choice})]})]}),t.content.instructions&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs font-semibold text-gray-700 block mb-2",children:"Instructions:"}),(0,r.jsx)("div",{className:"text-sm text-gray-900 whitespace-pre-wrap bg-gray-50 p-3 rounded-lg border border-gray-200 max-h-64 overflow-y-auto scrollbar-hide-until-hover",children:t.content.instructions})]})]});return(0,r.jsxs)(r.Fragment,{children:["json"===t.type&&(()=>{let e="ai_input"===t.structure&&"object"==typeof t.content,s=a?function e(t){if(!t)return[];let s=[];return"string"==typeof t?s.push(...F(t)):Array.isArray(t)?t.forEach(t=>{s.push(...e(t))}):"object"==typeof t&&Object.values(t).forEach(t=>{s.push(...e(t))}),Array.from(new Set(s))}(t.content):[];return(0,r.jsxs)("div",{className:"space-y-4",children:[e&&u(),(0,r.jsxs)("div",{children:[e&&(0,r.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,r.jsx)("span",{className:"text-xs font-semibold text-gray-700",children:"Input:"})}),(0,r.jsx)(et,{content:d,renderContent:(e,t)=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"rounded-xl overflow-hidden border border-gray-200 scrollbar-hide-until-hover",children:(0,r.jsx)(Y.Z,{language:"json",style:X.Z,customStyle:{margin:0,padding:"16px",fontSize:"13px",maxHeight:t?"none":"400px",overflow:"auto",lineHeight:"1.6"},showLineNumbers:d.length>500,children:e})}),s.length>0&&(0,r.jsx)("div",{className:"mt-5 md:mt-4 space-y-4 md:space-y-2",children:s.map((e,t)=>(0,r.jsx)(ee,{url:e,alt:"Image from JSON ".concat(t+1)},"json-image-".concat(t)))}),c()]})})]})]})})(),"html"===t.type&&(()=>{let e="string"==typeof t.content?t.content:JSON.stringify(t.content,null,2);return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>i(!0),className:"px-3 py-2 sm:py-1.5 text-xs font-medium rounded touch-target min-h-[44px] sm:min-h-0 ".concat(n?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Rendered"}),(0,r.jsx)("button",{onClick:()=>i(!1),className:"px-3 py-2 sm:py-1.5 text-xs font-medium rounded touch-target min-h-[44px] sm:min-h-0 ".concat(n?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-blue-600 text-white"),children:"Source"})]})}),n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"border-2 border-gray-200 rounded-xl overflow-hidden bg-white",children:(0,r.jsx)("iframe",{srcDoc:e,className:"w-full border-0",style:{height:"600px",minHeight:"600px"},sandbox:"allow-same-origin",referrerPolicy:"no-referrer",title:"HTML Preview"})}),c()]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(et,{content:e,renderContent:t=>(0,r.jsx)("div",{className:"rounded-xl overflow-hidden border border-gray-200",children:(0,r.jsx)(Y.Z,{language:"html",style:X.Z,customStyle:{margin:0,padding:"16px",fontSize:"13px",maxHeight:"400px",overflow:"auto",lineHeight:"1.6"},showLineNumbers:e.length>500,children:t})})}),(()=>{if(!a)return null;let t=F(e);return t.length>0||o.length>0?(0,r.jsxs)("div",{className:"mt-5 md:mt-4 space-y-4 md:space-y-2",children:[t.map((e,t)=>(0,r.jsx)(ee,{url:e,alt:"Image from HTML ".concat(t+1)},"html-image-".concat(t))),o.map((e,t)=>(0,r.jsx)(ee,{url:e,alt:"Image ".concat(t+1)},"html-prop-image-".concat(t)))]}):null})()]})]})})(),"markdown"===t.type&&(()=>{let e="ai_input"===t.structure&&"object"==typeof t.content,s=e?t.content.input||"":"string"==typeof t.content?t.content:t.content.input||JSON.stringify(t.content,null,2),n=a?F(s):[];return(0,r.jsxs)("div",{className:"space-y-4",children:[e&&u(),(0,r.jsxs)("div",{children:[e&&(0,r.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,r.jsx)("span",{className:"text-xs font-semibold text-gray-700",children:"Input:"})}),(0,r.jsx)(et,{content:s,renderContent:e=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"prose prose-sm max-w-none bg-white p-4 md:p-4 rounded-xl border border-gray-200 max-h-[600px] overflow-y-auto scrollbar-hide-until-hover leading-relaxed",children:(0,r.jsx)(K.UG,{remarkPlugins:[Q.Z],children:e})}),n.length>0&&(0,r.jsx)("div",{className:"mt-5 md:mt-4 space-y-4 md:space-y-2",children:n.map((e,t)=>(0,r.jsx)(ee,{url:e,alt:"Image from markdown ".concat(t+1)},"md-image-".concat(t)))}),c()]})})]})]})})(),"text"===t.type&&(0,r.jsx)(et,{content:d,renderContent:e=>0!==(a?F(e):[]).length||o&&0!==o.length?(0,r.jsxs)("div",{className:"bg-gray-50 p-4 md:p-4 rounded-xl border border-gray-200 max-h-[500px] md:max-h-[600px] overflow-y-auto scrollbar-hide-until-hover",children:[(0,r.jsx)("pre",{className:"text-sm md:text-xs whitespace-pre-wrap font-mono leading-relaxed",children:function(e){let t=F(e);if(0===t.length)return(0,r.jsx)(r.Fragment,{children:e});let s=e,a=[],n=0;return t.forEach((e,t)=>{let l=s.indexOf(e);-1!==l&&(l>0&&a.push((0,r.jsx)("span",{children:s.substring(0,l)},"text-".concat(n++))),a.push((0,r.jsx)("div",{className:"block",children:(0,r.jsx)(ee,{url:e,alt:"Image ".concat(t+1)})},"image-".concat(t))),s=s.substring(l+e.length))}),s.length>0&&a.push((0,r.jsx)("span",{children:s},"text-".concat(n))),(0,r.jsx)(r.Fragment,{children:a})}(e)}),c()]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("pre",{className:"text-sm md:text-xs whitespace-pre-wrap font-mono bg-gray-50 p-4 md:p-4 rounded-xl border border-gray-200 max-h-[500px] md:max-h-[600px] overflow-y-auto scrollbar-hide-until-hover leading-relaxed",children:e}),c()]})})]})}var er=s(73613),ea=s(73936);function en(e){let{artifactId:t}=e,[s,a]=(0,l.useState)(null),[o,d]=(0,l.useState)(!0),[c,u]=(0,l.useState)(null);if((0,l.useEffect)(()=>{let e=async()=>{try{d(!0),u(null);let e=await i.hi.getArtifact(t);a(e)}catch(e){console.error("Failed to fetch artifact:",e),u((0,ea.e$)(e))}finally{d(!1)}};t&&e()},[t]),o)return(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 px-4 md:px-0",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm md:text-xs text-gray-500",children:[(0,r.jsx)(n.dAq,{className:"w-4 h-4 md:w-3 md:h-3 animate-spin"}),(0,r.jsx)("span",{children:"Loading artifact..."})]})});if(c||!s)return(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 px-4 md:px-0",children:(0,r.jsxs)("div",{className:"text-sm md:text-xs text-gray-500",children:[(0,r.jsxs)("span",{className:"font-mono break-all",children:["Artifact ID: ",t]}),c&&(0,r.jsx)("span",{className:"block text-red-600 mt-2 md:mt-1",children:c})]})});let m=s.object_url||s.public_url,x=s.file_name||s.artifact_name||t;return(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 px-4 md:px-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-gray-700 flex-shrink-0",children:"Artifact:"}),(0,r.jsx)("span",{className:"text-xs text-gray-600 font-mono truncate",title:x,children:x})]}),m&&(0,r.jsx)("div",{className:"mt-3 md:mt-2 border-2 border-gray-200 rounded-xl overflow-hidden",children:(0,r.jsx)("div",{className:"aspect-video bg-gray-100",children:(0,r.jsx)(er.i,{contentType:s.content_type,objectUrl:m,fileName:x,className:"w-full h-full",artifactId:t})})})]})}function el(e){let{previousSteps:t,formSubmission:s,currentStepOrder:a}=e,n=t&&t.length>0,l=!!s;if(!n&&!l)return null;let i=s?"object"==typeof s?Object.entries(s).map(e=>{let[t,s]=e;return"".concat(t,": ").concat(s)}).join("\n"):String(s):"",o=i?F(i):[],d=[];return l&&d.push({title:"Form Submission",subtitle:"Step 0",body:i,images:o}),t.forEach(e=>{let t="string"==typeof e.output?e.output:null!==e.output&&void 0!==e.output?JSON.stringify(e.output,null,2):"",s=F(t);d.push({title:e.step_name||"Step ".concat(e.step_order),subtitle:"Step ".concat(e.step_order),body:t,images:s})}),(0,r.jsx)("div",{className:"mb-5 md:mb-4 pb-5 md:pb-4 border-b border-white/60 space-y-2",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:d.map((e,t)=>(0,r.jsxs)("details",{className:"group rounded-full border border-white/60 bg-white shadow-soft overflow-hidden",children:[(0,r.jsxs)("summary",{className:"flex items-center gap-2 px-3 py-2 text-xs font-semibold text-ink-800 cursor-pointer",children:[(0,r.jsxs)("span",{className:"truncate max-w-[220px]",children:[e.title," ",(0,r.jsxs)("span",{className:"text-ink-500 font-normal",children:["(",e.subtitle,")"]})]}),(0,r.jsx)("span",{className:"text-ink-400",children:"↕"})]}),(0,r.jsxs)("div",{className:"px-3 pb-3 md:px-3 md:pb-3 space-y-3 bg-white",children:[(0,r.jsx)("div",{className:"text-sm md:text-xs text-ink-800 whitespace-pre-wrap font-mono overflow-x-auto bg-surface-50 p-3 md:p-2.5 rounded-2xl border border-white/60 max-h-40 overflow-y-auto scrollbar-hide-until-hover leading-relaxed",children:function(e){let t=F(e);if(0===t.length)return(0,r.jsx)(r.Fragment,{children:e});let s=e,a=[],n=0;return t.forEach((e,t)=>{let l=s.indexOf(e);-1!==l&&(l>0&&a.push((0,r.jsx)("span",{children:s.substring(0,l)},"text-".concat(n++))),a.push((0,r.jsx)("div",{className:"block my-2",children:(0,r.jsx)(ee,{url:e,alt:"Image ".concat(t+1)})},"image-".concat(t))),s=s.substring(l+e.length))}),s.length>0&&a.push((0,r.jsx)("span",{children:s},"text-".concat(n))),(0,r.jsx)(r.Fragment,{children:a})}(e.body||"No context")}),e.images.length>0&&(0,r.jsx)("div",{className:"space-y-2 md:space-y-1",children:e.images.map((s,a)=>(0,r.jsx)(ee,{url:s,alt:"".concat(e.title," image ").concat(a+1)},"context-image-".concat(t,"-").concat(a)))})]})]},"".concat(a,"-context-").concat(t)))})})}function ei(e){let{imageUrls:t,artifacts:s,model:a,tools:l,toolChoice:i,loading:o,title:d="Generated Images:",className:c,showMetadata:u=!0}=e,m=t.length>0,x=s.length>0;return m||x||o?(0,r.jsxs)("div",{className:(0,E.Z)("mt-3 md:mt-2.5 pt-3 md:pt-2.5 border-t border-gray-200",c),children:[u&&(a||l&&l.length>0)&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3 md:mb-2 flex-wrap",children:[a&&(0,r.jsxs)("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-full bg-purple-100 text-purple-800 border border-purple-200",children:[(0,r.jsx)(n.Par,{className:"w-3 h-3"}),a]}),(0,r.jsx)(H,{tools:l,toolChoice:i&&"auto"!==i?i:void 0,showEmptyState:!1,className:"flex items-center gap-1.5 flex-wrap",badgeClassName:"bg-blue-100 text-blue-800 border-blue-200"})]}),(0,r.jsx)("span",{className:"text-sm md:text-xs font-semibold text-gray-700 mb-2.5 md:mb-2 block",children:d}),o&&!m&&!x&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 py-2",children:[(0,r.jsx)("span",{className:"w-3.5 h-3.5 border-2 border-gray-300 border-t-gray-500 rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Loading images..."})]}),m&&(0,r.jsx)("div",{className:"grid grid-cols-1 gap-2.5 md:gap-2",children:t.map((e,t)=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:[(0,r.jsx)("div",{className:"aspect-video bg-gray-100",children:(0,r.jsx)(er.i,{contentType:"image/png",objectUrl:e,fileName:"Generated image ".concat(t+1),className:"w-full h-full"})}),(0,r.jsx)("div",{className:"p-3 md:p-2 bg-gray-100",children:(0,r.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-sm md:text-xs text-blue-600 hover:text-blue-800 active:text-blue-900 break-all block touch-target py-2 md:py-1 min-h-[44px] md:min-h-0",title:e,children:J(e)})})]},"url-".concat(t)))}),!m&&x&&(0,r.jsx)("div",{className:"grid grid-cols-1 gap-2.5 md:gap-2",children:s.map((e,t)=>{let s=e.object_url||e.public_url;return s?(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"aspect-video bg-gray-100",children:(0,r.jsx)(er.i,{contentType:e.content_type||"image/png",objectUrl:s,fileName:e.file_name||e.artifact_name||"Image ".concat(t+1),className:"w-full h-full",artifactId:e.artifact_id})}),(0,r.jsx)("div",{className:"p-3 md:p-2 bg-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-xs md:text-xs text-blue-600 hover:text-blue-800 active:text-blue-900 truncate flex-1 min-w-0",title:e.file_name||e.artifact_name||s,children:e.file_name||e.artifact_name||J(s)}),e.artifact_id&&(0,r.jsxs)("span",{className:"text-xs text-gray-500 font-mono flex-shrink-0",children:[e.artifact_id.substring(0,12),"..."]})]})})]},e.artifact_id||t):null})})]}):null}function eo(){let e=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let t=e.current;if(!t)return;let s=null,r=()=>{t.classList.add("scrolling"),s&&clearTimeout(s),s=setTimeout(()=>{t.classList.remove("scrolling")},300)};return t.addEventListener("scroll",r,{passive:!0}),()=>{t.removeEventListener("scroll",r),s&&clearTimeout(s)}},[]),e}function ed(e){let{onClick:t}=e;return(0,r.jsxs)("button",{onClick:t,className:"text-xs text-gray-500 hover:text-gray-700 active:text-gray-900 flex items-center gap-1 px-2 py-1 rounded hover:bg-gray-100 active:bg-gray-200 touch-target min-h-[44px] sm:min-h-0",children:[(0,r.jsx)(n.C3L,{className:"w-4 h-4 sm:w-3.5 sm:h-3.5"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Copy"})]})}function ec(e){var t;let{step:s,status:a,onCopy:l,previousSteps:i,formSubmission:o,imageGallery:d,usedImageGeneration:c,onEditStep:u,canEdit:m=!1}=e,x=eo(),p=eo(),h=s.step_order&&s.step_order>0?s.step_order-1:0,g=m&&!!u&&["workflow_step","ai_generation","webhook"].includes(s.step_type)&&void 0!==s.step_order&&s.step_order>0,f=null!=d?d:function(e){var t,s,r;let a=Array.isArray(e.image_urls)?e.image_urls:[],n=e.model||(null===(t=e.input)||void 0===t?void 0:t.model);return{imageUrls:a,artifacts:[],model:"string"==typeof n?n:void 0,tools:(null===(s=e.input)||void 0===s?void 0:s.tools)||e.tools||[],toolChoice:(null===(r=e.input)||void 0===r?void 0:r.tool_choice)||e.tool_choice,loading:!1}}(s),b=(f.imageUrls.length>0||f.artifacts.length>0||!!f.loading)&&!!c,v=i.length>0||!!o,w=null!=c&&c,N=w&&b,_="in_progress"===a,k=!!s.output;return(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-4",children:[(0,r.jsxs)("div",{className:"border border-blue-200/60 rounded-xl overflow-hidden bg-white shadow-sm ring-1 ring-blue-100/40",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-50/70 to-blue-50/50 px-4 py-2.5 md:px-4 md:py-2 border-b border-blue-200/60",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("span",{className:"text-sm md:text-xs font-bold text-gray-800 tracking-tight",children:"Input"}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[g&&u&&(0,r.jsxs)("button",{onClick:e=>{e.stopPropagation(),u(h)},className:"flex items-center gap-1 px-1.5 py-1 text-xs font-medium text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded transition-colors",title:"Edit workflow step",children:[(0,r.jsx)(n.vPQ,{className:"w-3 h-3"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Edit"})]}),(0,r.jsx)(ed,{onClick:()=>{l(function(e){if("json"===e.type)return JSON.stringify(e.content,null,2);if("string"==typeof e.content)return e.content;if("object"==typeof e.content&&null!==e.content&&"input"in e.content){let t=e.content;return t.input?String(t.input):JSON.stringify(e.content,null,2)}return JSON.stringify(e.content,null,2)}(y(s)))}})]})]})}),(0,r.jsxs)("div",{ref:x,className:"p-4 md:p-3 bg-blue-50/10 max-h-[350px] md:max-h-72 overflow-y-auto scrollbar-hide-until-hover",children:[v&&(0,r.jsx)(el,{previousSteps:i,formSubmission:o,currentStepOrder:null!==(t=s.step_order)&&void 0!==t?t:0}),(0,r.jsx)(es,{formatted:y(s)}),b&&(0,r.jsx)(ei,{...f,className:"border-none pt-4"})]})]}),(0,r.jsxs)("div",{className:"border border-green-200/60 rounded-xl overflow-hidden bg-white shadow-sm ring-1 ring-green-100/40",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-green-50/70 to-green-50/50 px-4 py-2.5 md:px-4 md:py-2 border-b border-green-200/60",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("span",{className:"text-sm md:text-xs font-bold text-gray-800 tracking-tight",children:"Output"}),(0,r.jsx)(ed,{onClick:()=>{let e=j(s);l("json"===e.type?JSON.stringify(e.content,null,2):"string"==typeof e.content?e.content:JSON.stringify(e.content,null,2))}})]})}),(0,r.jsxs)("div",{ref:p,className:"p-4 md:p-3 bg-green-50/10 max-h-[350px] md:max-h-72 overflow-y-auto scrollbar-hide-until-hover",children:[N?(0,r.jsx)(ei,{...f}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(es,{formatted:j(s),imageUrls:f.imageUrls,showImages:w}),b&&(0,r.jsx)(ei,{...f,className:"border-none"})]}),_&&(0,r.jsxs)("div",{className:"mt-3 text-xs text-gray-500 flex items-center gap-2",children:[(0,r.jsx)("span",{className:"w-3.5 h-3.5 border-2 border-blue-200 border-t-blue-500 rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Step is currently running and will update once output is available."})]}),!_&&!k&&(0,r.jsx)("div",{className:"mt-3 text-xs text-gray-500",children:"This step hasn’t produced output yet."}),s.artifact_id&&(0,r.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,r.jsx)(en,{artifactId:s.artifact_id})})]})]})]})}function eu(e){var t;let{step:s,formSubmission:a,previousSteps:l,onEditStep:i,canEdit:o=!1}=e,d=s.step_order&&s.step_order>0?s.step_order-1:0,c=o&&!!i&&["workflow_step","ai_generation","webhook"].includes(s.step_type)&&void 0!==s.step_order&&s.step_order>0;return(0,r.jsxs)("div",{className:"border border-gray-300 rounded-lg overflow-hidden bg-white shadow-sm",children:[(0,r.jsxs)("div",{className:"bg-slate-50 px-3 py-2 md:py-1.5 border-b border-gray-300 flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm md:text-xs font-semibold text-gray-700",children:"Configuration"}),c&&i&&(0,r.jsxs)("button",{onClick:e=>{e.stopPropagation(),i(d)},className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-primary-600 hover:text-primary-800 hover:bg-primary-50 rounded-lg transition-colors",title:"Edit workflow step",children:[(0,r.jsx)(n.vPQ,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Edit Step"})]})]}),(0,r.jsxs)("div",{className:"p-4 md:p-3 bg-white space-y-3 md:space-y-2",children:[s.instructions?(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs font-semibold text-gray-600 uppercase",children:"Instructions"}),(0,r.jsx)("pre",{className:"text-sm text-gray-700 mt-1 whitespace-pre-wrap font-sans bg-gray-50 p-2.5 rounded border border-gray-200",children:s.instructions})]}):(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"This step is configured but does not have custom instructions yet. It will run with the default workflow settings once triggered."}),s.tool_choice&&"auto"!==s.tool_choice&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs font-semibold text-gray-600 uppercase",children:"Tool Choice"}),(0,r.jsx)("p",{className:"text-sm text-gray-700 mt-1 font-mono",children:s.tool_choice})]}),(l.length>0||a)&&(0,r.jsx)("div",{className:"pt-3 md:pt-2.5 border-t border-dashed border-gray-200",children:(0,r.jsx)(el,{previousSteps:l,formSubmission:a,currentStepOrder:null!==(t=s.step_order)&&void 0!==t?t:0})})]})]})}function em(e){let{step:t,status:s,isExpanded:a,onToggle:i,onCopy:o,previousSteps:d,formSubmission:c,imageArtifacts:u,loadingImageArtifacts:m,onEditStep:x,canEdit:p}=e,h="pending"===s,g=(0,l.useMemo)(()=>u.filter(U),[u]),f=(0,l.useMemo)(()=>{var e;return{imageUrls:O(t),artifacts:g,model:function(e){var t;let s=e.model||(null===(t=e.input)||void 0===t?void 0:t.model);return"string"==typeof s?s:void 0}(t),tools:M(t),toolChoice:(null===(e=t.input)||void 0===e?void 0:e.tool_choice)||t.tool_choice||void 0,loading:m}},[t,g,m]),b=function(e,t){let s=D(M(e)).map(e=>e.toLowerCase()),r=["image_generation","image-gen","image","vision","dalle","generate_image"];if(!s.some(e=>r.some(t=>e.includes(t))))return!1;let a=t.filter(U),n=O(e);return a.length>0||n.length>0}(t,g);return(0,r.jsx)("div",{className:"px-4 sm:px-5 pb-4 sm:pb-5 pt-0 border-t border-gray-200/40",children:(0,r.jsxs)(G.pJ,{children:[(0,r.jsxs)(G.pJ.Button,{onClick:e=>{e.stopPropagation(),i()},className:"flex items-center justify-between w-full text-left text-sm font-semibold text-gray-700 hover:text-gray-900 hover:bg-gray-50/60 active:text-gray-900 active:bg-gray-100/60 rounded-xl transition-all duration-200 touch-target py-3 md:py-2.5 min-h-[44px] md:min-h-0 px-3 -mx-1",children:[(0,r.jsx)("span",{className:"font-semibold",children:h?"Configuration":"Details"}),a?(0,r.jsx)(n.rH8,{className:"w-5 h-5 flex-shrink-0 ml-2 text-gray-500 transition-transform duration-200"}):(0,r.jsx)(n.bTu,{className:"w-5 h-5 flex-shrink-0 ml-2 text-gray-500 transition-transform duration-200"})]}),(0,r.jsx)(V.u,{show:a,enter:"transition duration-200 ease-out",enterFrom:"opacity-0 transform -translate-y-2",enterTo:"opacity-100 transform translate-y-0",leave:"transition duration-150 ease-in",leaveFrom:"opacity-100 transform translate-y-0",leaveTo:"opacity-0 transform -translate-y-2",children:(0,r.jsx)(G.pJ.Panel,{static:!0,className:"mt-4 md:mt-3 bg-gradient-to-br from-gray-50/30 via-white to-gray-50/20 rounded-xl p-4 md:p-5 border border-gray-200/40 shadow-sm",children:h?(0,r.jsx)(eu,{step:t,formSubmission:c,previousSteps:d,onEditStep:x,canEdit:p}):(0,r.jsx)(ec,{step:t,status:s,onCopy:o,previousSteps:d,formSubmission:c,imageGallery:f,usedImageGeneration:b,onEditStep:x,canEdit:p})})})]})})}function ex(e){let{imageUrl:t,artifact:s,imageIndex:a=0,model:l,tools:i,toolChoice:o}=e,d=t||(null==s?void 0:s.object_url)||(null==s?void 0:s.public_url),c=(null==s?void 0:s.content_type)||"image/png",u=null==s?void 0:s.artifact_id;if(!d)return null;let m=i&&Array.isArray(i)&&i.length>0;return(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 px-4 md:px-0",children:[(l||m)&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[l&&(0,r.jsxs)("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-full bg-purple-100 text-purple-800 border border-purple-200",children:[(0,r.jsx)(n.Par,{className:"w-3 h-3"}),l]}),m&&(0,r.jsx)(H,{tools:i,toolChoice:o&&"auto"!==o?o:void 0,showEmptyState:!1,className:"flex flex-wrap gap-1",badgeClassName:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 border border-blue-200 whitespace-nowrap"})]}),d&&(0,r.jsx)("div",{className:"mt-3 md:mt-2 border-2 border-gray-200 rounded-xl overflow-hidden",children:(0,r.jsx)("div",{className:"aspect-video bg-gray-100",children:(0,r.jsx)(er.i,{contentType:c,objectUrl:d,fileName:(null==s?void 0:s.file_name)||(null==s?void 0:s.artifact_name)||t||"Image ".concat(a+1),className:"w-full h-full",artifactId:u})})})]})}function ep(e){var t;let{step:s,status:a,jobStatus:n,rerunningStep:l,isExpanded:i,onToggle:o,onCopy:d,previousSteps:c,formSubmission:u,imageArtifacts:m,loadingImageArtifacts:x,onRerunStep:p,onEditStep:h,canEdit:g}=e,f=null!==(t=s.step_order)&&void 0!==t?t:0,b="in_progress"===a,y="failed"===a,j="completed"===a,v=null!==l&&f>0&&l===f-1,w=function(e,t){let s=Array.from(new Set([...e.image_urls&&Array.isArray(e.image_urls)&&e.image_urls.length>0?e.image_urls.filter(L):[],...P(e).filter(L)].filter(e=>"string"==typeof e&&e.length>0))),r=(t||[]).filter(U),a=e.artifact_id,n=new Set,l=[];return a&&n.add("artifact:".concat(a)),r.forEach(e=>{let t=e.artifact_id,s=R(e.file_name||e.artifact_name||"");t===a||s&&n.has("filename:".concat(s))||(n.add("filename:".concat(s)),n.add("artifact:".concat(t)),l.push({type:"imageArtifact",data:e,key:"image-artifact-".concat(t)}))}),s.forEach((e,t)=>{let s=R(function(e){try{return new URL(e).pathname.split("/").pop()||""}catch(s){let t=e.split("/");return t[t.length-1]||e}}(e));s&&n.has("filename:".concat(s))||r.some(t=>(t.object_url||t.public_url)===e||R(t.file_name||t.artifact_name||"")===s)||(n.add("filename:".concat(s)),l.push({type:"imageUrl",data:e,key:"image-url-".concat(t)}))}),l}(s,m);return(0,r.jsxs)("div",{className:"border rounded-2xl transition-all duration-200 ".concat(v?"border-brand-300 bg-brand-50 shadow-soft ring-2 ring-brand-200":b?"border-brand-200 bg-white shadow-soft ring-1 ring-brand-100":y?"border-red-200 bg-red-50 shadow-soft ring-1 ring-red-100":j?"border-white/60 bg-white shadow-soft hover:shadow-md transition-shadow duration-200":"border-white/60 bg-surface-50 shadow-soft"),"data-step-status":a,"data-step-order":f,children:[(0,r.jsx)(B,{step:s,status:a,jobStatus:n,canEdit:g,rerunningStep:l,onEditStep:h,onRerunStep:p}),(0,r.jsx)(em,{step:s,status:a,isExpanded:i,onToggle:o,onCopy:d,previousSteps:c,formSubmission:u,imageArtifacts:m,loadingImageArtifacts:x,onEditStep:h,canEdit:g}),w.length>0&&(0,r.jsx)("div",{className:"px-4 sm:px-5 pb-4 sm:pb-5 pt-2",children:w.map((e,t)=>{var a,n,l,i;if("imageArtifact"===e.type){let l=e.data;return(0,r.jsx)(ex,{artifact:l,imageIndex:t,model:s.model,tools:(null===(a=s.input)||void 0===a?void 0:a.tools)||s.tools,toolChoice:(null===(n=s.input)||void 0===n?void 0:n.tool_choice)||s.tool_choice},e.key)}if("imageUrl"===e.type){let a=e.data;return(0,r.jsx)(ex,{imageUrl:a,imageIndex:t,model:s.model,tools:(null===(l=s.input)||void 0===l?void 0:l.tools)||s.tools,toolChoice:(null===(i=s.input)||void 0===i?void 0:i.tool_choice)||s.tool_choice},e.key)}return null})})]})}function eh(e){let{steps:t,expandedSteps:s,showExecutionSteps:a,onToggleShow:o,onToggleStep:d,onCopy:c,jobStatus:u,onRerunStep:m,rerunningStep:x,onEditStep:p,canEdit:h=!1,jobId:g}=e,{imageArtifactsByStep:f,loading:b}=function(e){let{jobId:t,steps:s}=e,[r,a]=(0,l.useState)(new Map),[n,o]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{(async()=>{if(t)try{o(!0);let e=(await i.hi.getArtifacts({job_id:t,artifact_type:"image",limit:100})).artifacts||[],r=new Map,n=[...s].sort((e,t)=>{var s,r;let a=null!==(s=e.step_order)&&void 0!==s?s:0,n=null!==(r=t.step_order)&&void 0!==r?r:0;return a-n});e.forEach(e=>{let t=(e.file_name||e.artifact_name||"").match(/step[_\s](\d+)/i);if(t){let s=parseInt(t[1],10);r.has(s)||r.set(s,[]),r.get(s).push(e)}else if(e.created_at){let t=new Date(e.created_at).getTime();for(let a of n)if(a.started_at){let n=new Date(a.started_at).getTime();if(3e5>Math.abs(t-n)){var s;let t=null!==(s=a.step_order)&&void 0!==s?s:0;r.has(t)||r.set(t,[]),r.get(t).push(e);break}}}}),a(r)}catch(e){console.error("Failed to fetch image artifacts:",e)}finally{o(!1)}})()},[t,s]),{imageArtifactsByStep:r,loading:n}}({jobId:g,steps:t}),y=(0,l.useMemo)(()=>t&&0!==t.length?[...t].sort((e,t)=>{var s,r;return(null!==(s=e.step_order)&&void 0!==s?s:0)-(null!==(r=t.step_order)&&void 0!==r?r:0)}):[],[t]),j=(0,l.useMemo)(()=>(function(e){let t=e.find(e=>0===e.step_order);return(null==t?void 0:t.output)||null})(y),[y]),v=e=>(function(e,t,s,r){var a;let n=null!==(a=e.step_order)&&void 0!==a?a:0;if(null!=r&&n>0&&r===n-1)return"in_progress";if(e._status)return e._status;if(I(e))return"completed";let l=t.indexOf(e),i=t.filter(I);return"processing"===s&&l===i.length&&l<t.length?"in_progress":"failed"===s&&l<=i.length&&!I(e)?"failed":"pending"})(e,y,u,x);return t&&0!==t.length?(0,r.jsxs)("div",{className:"mt-4 sm:mt-6 bg-white rounded-2xl shadow-soft border border-white/60 p-5 sm:p-7",children:[(0,r.jsxs)("button",{onClick:o,className:"flex items-center justify-between w-full text-left mb-5 touch-target min-h-[48px] sm:min-h-0 hover:opacity-80 transition-opacity duration-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4 flex-1 min-w-0",children:[(0,r.jsx)("h2",{className:"text-lg sm:text-xl font-bold text-ink-900 tracking-tight",children:"Execution Steps"}),(0,r.jsx)("div",{className:"hidden sm:block",children:(0,r.jsx)(C,{steps:y,jobStatus:u,getStepStatus:v})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,r.jsx)("div",{className:"sm:hidden",children:(0,r.jsx)(C,{steps:y,jobStatus:u,getStepStatus:v})}),a?(0,r.jsx)(n.rH8,{className:"w-5 h-5 text-ink-500 flex-shrink-0 transition-transform duration-200"}):(0,r.jsx)(n.bTu,{className:"w-5 h-5 text-ink-500 flex-shrink-0 transition-transform duration-200"})]})]}),a&&(0,r.jsx)("div",{className:"space-y-4 pt-5 border-t border-white/60",children:y.map(e=>{var t;let a=null!==(t=e.step_order)&&void 0!==t?t:0,n=s.has(a),l=v(e),i=f.get(a)||[];return(0,r.jsx)(ep,{step:e,status:l,jobStatus:u,rerunningStep:x,isExpanded:n,onToggle:()=>d(a),onCopy:c,previousSteps:function(e,t){var s;let r=null!==(s=e.step_order)&&void 0!==s?s:0;return t.filter(e=>{var t;let s=null!==(t=e.step_order)&&void 0!==t?t:0;return s<r&&s>0&&I(e)}).sort((e,t)=>{var s,r;return(null!==(s=e.step_order)&&void 0!==s?s:0)-(null!==(r=t.step_order)&&void 0!==r?r:0)}).map(e=>{var t;return{step_order:null!==(t=e.step_order)&&void 0!==t?t:0,step_type:e.step_type,step_name:e.step_name||"Step ".concat(e.step_order),output:e.output,image_urls:e.image_urls}})}(e,y),formSubmission:j,imageArtifacts:i,loadingImageArtifacts:b,onRerunStep:m,onEditStep:p,canEdit:h},a)})})]}):null}function eg(e){let{error:t,s3Key:s,title:a="Execution Steps Loading Error",showS3Key:n=!0,className:l=""}=e,i=n&&s&&!t.includes("S3 Key:");return(0,r.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded-lg ".concat(l),children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,r.jsxs)("div",{className:"ml-3 flex-1",children:[(0,r.jsx)("h3",{className:"text-sm font-medium",children:a}),(0,r.jsx)("p",{className:"mt-1 text-sm",children:t}),(i||!1)&&(0,r.jsxs)("p",{className:"mt-2 text-xs font-mono break-all",children:["S3 Key: ",s]})]})]})})}function ef(e){let{job:t,form:s}=e,i=(0,a.useRouter)(),[o,d]=(0,l.useState)(!1);return(0,r.jsxs)("div",{className:"mt-4 sm:mt-6 bg-white rounded-lg shadow p-4 sm:p-6",children:[(0,r.jsxs)("button",{onClick:()=>d(!o),className:"flex items-center justify-between w-full text-left mb-4 touch-target",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Technical Details"}),o?(0,r.jsx)(n.rH8,{className:"w-5 h-5 text-gray-500 flex-shrink-0 ml-2"}):(0,r.jsx)(n.bTu,{className:"w-5 h-5 text-gray-500 flex-shrink-0 ml-2"})]}),o&&(0,r.jsxs)("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Job ID"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"text-sm font-mono text-gray-900",children:t.job_id}),(0,r.jsx)("button",{onClick:()=>v(t.job_id),className:"text-gray-500 hover:text-gray-700 p-2 touch-target",title:"Copy Job ID",children:(0,r.jsx)(n.C3L,{className:"w-4 h-4"})})]})]}),t.submission_id&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Submission ID"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(null==s?void 0:s.public_slug)?(0,r.jsxs)("a",{href:"/v1/forms/".concat(s.public_slug),target:"_blank",rel:"noopener noreferrer",className:"text-sm font-mono text-primary-600 hover:text-primary-900 hover:underline",onClick:e=>e.stopPropagation(),children:[t.submission_id,(0,r.jsx)(n.AlO,{className:"w-3 h-3 ml-1 inline"})]}):(0,r.jsx)("p",{className:"text-sm font-mono text-gray-900",children:t.submission_id}),(0,r.jsx)("button",{onClick:()=>v(t.submission_id),className:"text-gray-500 hover:text-gray-700 p-2 touch-target",title:"Copy Submission ID",children:(0,r.jsx)(n.C3L,{className:"w-4 h-4"})})]})]}),t.workflow_id&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Workflow ID"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"text-sm font-mono text-gray-900",children:t.workflow_id}),(0,r.jsx)("button",{onClick:()=>v(t.workflow_id),className:"text-gray-500 hover:text-gray-700 p-2 touch-target",title:"Copy Workflow ID",children:(0,r.jsx)(n.C3L,{className:"w-4 h-4"})})]})]}),t.tenant_id&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tenant ID"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"text-sm font-mono text-gray-900",children:t.tenant_id}),(0,r.jsx)("button",{onClick:()=>v(t.tenant_id),className:"text-gray-500 hover:text-gray-700 p-2 touch-target",title:"Copy Tenant ID",children:(0,r.jsx)(n.C3L,{className:"w-4 h-4"})})]})]}),t.started_at&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Started At"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-900",children:(()=>{try{let e=new Date(t.started_at);if(isNaN(e.getTime()))return t.started_at;return e.toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0})}catch(e){return t.started_at}})()}),(0,r.jsx)("button",{onClick:()=>v(t.started_at),className:"text-gray-500 hover:text-gray-700 p-2 touch-target",title:"Copy Started At",children:(0,r.jsx)(n.C3L,{className:"w-4 h-4"})})]})]}),t.updated_at&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Updated"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-900",children:(()=>{try{let e=new Date(t.updated_at);if(isNaN(e.getTime()))return t.updated_at;return e.toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0})}catch(e){return t.updated_at}})()}),(0,r.jsx)("button",{onClick:()=>v(t.updated_at),className:"text-gray-500 hover:text-gray-700 p-2 touch-target",title:"Copy Last Updated",children:(0,r.jsx)(n.C3L,{className:"w-4 h-4"})})]})]}),t.artifacts&&t.artifacts.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Artifacts"}),(0,r.jsx)("div",{className:"space-y-2",children:t.artifacts.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("a",{href:"/dashboard/artifacts",className:"text-sm font-mono text-primary-600 hover:text-primary-900 hover:underline",onClick:e=>{e.preventDefault(),i.push("/dashboard/artifacts")},children:[e,(0,r.jsx)(n.AlO,{className:"w-3 h-3 ml-1 inline"})]}),(0,r.jsx)("button",{onClick:()=>v(e),className:"text-gray-500 hover:text-gray-700 p-2 touch-target",title:"Copy Artifact ID",children:(0,r.jsx)(n.C3L,{className:"w-4 h-4"})})]},e))})]}),t.error_message&&"failed"===t.status&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Raw Error Details"}),(0,r.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 font-mono text-xs text-gray-800 whitespace-pre-wrap break-all",children:t.error_message})]})]})]})}function eb(e){let{isOpen:t,onClose:s,onConfirm:a,isResubmitting:l}=e;return t?(0,r.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:s}),(0,r.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,r.jsx)("button",{onClick:s,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",disabled:l,children:(0,r.jsx)(n.q5L,{className:"w-5 h-5"})}),(0,r.jsx)("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-blue-100 rounded-full",children:(0,r.jsx)(n.bcx,{className:"w-6 h-6 text-blue-600"})}),(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Resubmit Lead Magnet?"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"This will create a new job with the same submission data. The original job will remain unchanged."})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{onClick:s,disabled:l,className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:"Cancel"}),(0,r.jsx)("button",{onClick:a,disabled:l,className:"flex-1 px-4 py-2.5 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.Bw1,{className:"w-4 h-4 mr-2 animate-spin"}),"Resubmitting..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.Bw1,{className:"w-4 h-4 mr-2"}),"Resubmit"]})})]})]})})]}):null}function ey(){return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("div",{className:"h-10 bg-gray-200 rounded w-20 mb-4 animate-pulse"}),(0,r.jsx)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-3 sm:gap-0",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"h-7 sm:h-8 bg-gray-200 rounded w-64 mb-2 animate-pulse"}),(0,r.jsx)("div",{className:"h-4 sm:h-5 bg-gray-200 rounded w-96 max-w-full animate-pulse"})]})})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6 mb-6",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded w-32 animate-pulse"}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[1,2,3,4].map(e=>(0,r.jsxs)("div",{className:"h-16 bg-gray-50 rounded-lg border border-gray-100 p-3",children:[(0,r.jsx)("div",{className:"h-3 bg-gray-200 rounded w-24 mb-2 animate-pulse"}),(0,r.jsx)("div",{className:"h-5 bg-gray-200 rounded w-32 animate-pulse"})]},e))})]})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded w-40 mb-4 animate-pulse"}),(0,r.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,r.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"h-6 w-6 bg-gray-200 rounded-full animate-pulse flex-shrink-0"}),(0,r.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,r.jsx)("div",{className:"h-5 bg-gray-200 rounded w-48 animate-pulse"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-32 animate-pulse"}),(0,r.jsx)("div",{className:"h-20 bg-gray-100 rounded animate-pulse mt-2"})]})]})},e))})]})]})}function ej(e){let{isOpen:t,onConfirm:s,onCancel:a}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:a}),(0,r.jsx)("div",{className:"relative z-50 w-full max-w-md bg-white rounded-lg shadow-xl mx-4",children:(0,r.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,r.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:"Step Updated Successfully"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4 sm:mb-6",children:"Would you like to rerun this step with the updated configuration?"}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-2 sm:gap-3",children:[(0,r.jsx)("button",{onClick:a,className:"px-4 py-2.5 sm:py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors touch-target min-h-[44px] sm:min-h-0",children:"Cancel"}),(0,r.jsx)("button",{onClick:s,className:"px-4 py-2.5 sm:py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors touch-target min-h-[44px] sm:min-h-0",children:"Rerun Step"})]})]})})]})}):null}var ev=s(69526),ew=s(16058),eN=s(96490),e_=s(91309),ek=s(12700),eS=s(97917);function eC(e){let{step:t,index:s,totalSteps:a,allSteps:l=[],onChange:i,onDelete:o,onMoveUp:d,onMoveDown:c,workflowId:u}=e,{localStep:m,webhookHeaders:x,handleChange:p,handleWebhookHeadersChange:h}=(0,ek.x)({step:t,index:s,onChange:i}),{computerUseConfig:g,isToolSelected:f,handleToolToggle:b,handleComputerUseConfigChange:y}=(0,eS.t)({step:m,onChange:p});return(0,r.jsxs)("div",{className:"border border-gray-300 rounded-lg p-6 bg-white shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex items-center gap-1 text-gray-400",children:(0,r.jsx)("span",{className:"text-xs",children:"⋮⋮"})}),(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Step ",s+1]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>d(s),disabled:0===s,className:"p-2 text-gray-600 hover:text-gray-900 disabled:text-gray-300 disabled:cursor-not-allowed touch-target","aria-label":"Move step up",children:(0,r.jsx)(n.rH8,{className:"w-5 h-5"})}),(0,r.jsx)("button",{type:"button",onClick:()=>c(s),disabled:s===a-1,className:"p-2 text-gray-600 hover:text-gray-900 disabled:text-gray-300 disabled:cursor-not-allowed touch-target","aria-label":"Move step down",children:(0,r.jsx)(n.bTu,{className:"w-5 h-5"})}),(0,r.jsx)("button",{type:"button",onClick:()=>o(s),className:"p-2 text-red-600 hover:text-red-700 touch-target","aria-label":"Delete step",children:(0,r.jsx)(n.Ybf,{className:"w-5 h-5"})})]})]}),(0,r.jsx)(e_.E,{workflowId:u,step:m,stepIndex:s,onAccept:e=>{i(s,e)}}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(ev.b,{step:m,onChange:p}),("ai_generation"===m.step_type||!m.step_type)&&(0,r.jsx)(ew.b,{step:m,isToolSelected:f,onToolToggle:b,onToolChoiceChange:e=>p("tool_choice",e),onComputerUseConfigChange:y,computerUseConfig:g}),"webhook"===m.step_type&&(0,r.jsx)(eN.E,{step:m,webhookHeaders:x,allSteps:l,currentStepIndex:s,onChange:p,onWebhookHeadersChange:h}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dependencies (optional)"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Select which steps must complete before this step runs. Leave empty to auto-detect from step order."}),(0,r.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto border border-gray-200 rounded-lg p-3",children:l.length>0?l.map((e,t)=>{if(t===s)return null;let a=(m.depends_on||[]).includes(t);return(0,r.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:a,onChange:e=>{let s=m.depends_on||[];p("depends_on",e.target.checked?[...s,t]:s.filter(e=>e!==t))},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,r.jsxs)("span",{className:"text-sm text-gray-900",children:["Step ",t+1,": ",e.step_name]})]},t)}):(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"No other steps available"})}),m.depends_on&&m.depends_on.length>0&&(0,r.jsxs)("p",{className:"mt-2 text-xs text-gray-600",children:["Depends on: ",m.depends_on.map(e=>"Step ".concat(e+1)).join(", ")]})]})]})]})}function eI(e){var t,s;let{step:a,index:i,totalSteps:o,allSteps:d=[],isOpen:c,onClose:u,onChange:m,onDelete:x,onMoveUp:p,onMoveDown:h,workflowId:g}=e,[f,b]=(0,l.useState)(a),y=(0,l.useRef)(a);if((0,l.useEffect)(()=>{b(a),y.current=a},[a]),!c||!a||null===i)return null;let j=()=>{let e=y.current;e&&null!==i&&m(i,e),u()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 z-40 bg-slate-900/40 backdrop-blur-sm transition-opacity",onClick:j}),(0,r.jsxs)("div",{className:"fixed right-0 top-0 h-full w-full max-w-2xl bg-white shadow-2xl z-50 transform transition-transform duration-300 ease-in-out ".concat(c?"translate-x-0":"translate-x-full"," overflow-y-auto"),children:[(0,r.jsxs)("div",{className:"sticky top-0 z-10 border-b border-slate-200 bg-gradient-to-r from-white via-white to-slate-50/60 px-6 py-5 shadow-sm backdrop-blur",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"text-xs font-semibold uppercase tracking-widest text-slate-400",children:["Step ",i+1," of ",o]}),(0,r.jsx)("h2",{className:"mt-1 text-2xl font-semibold text-slate-900",children:a.step_name||"Step ".concat(i+1)}),(0,r.jsx)("p",{className:"mt-1 text-sm text-slate-500",children:a.step_description||"Configure what this step should accomplish."})]}),(0,r.jsx)("button",{onClick:j,className:"rounded-full border border-slate-200 bg-white p-2 text-slate-400 shadow-sm transition hover:border-primary-200 hover:text-primary-600","aria-label":"Close panel",children:(0,r.jsx)(n.q5L,{className:"h-5 w-5","aria-hidden":!0})})]}),(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-3 text-[11px] font-medium text-slate-500 md:grid-cols-4",children:[(0,r.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[(0,r.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Model"}),(0,r.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-700",children:"computer-use-preview"===a.model?"Computer Use Preview":a.model.replace("gpt-","GPT-").replace("turbo","Turbo")})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[(0,r.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Tools"}),(0,r.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-700",children:(null===(t=a.tools)||void 0===t?void 0:t.length)?"".concat(a.tools.length," enabled"):"None"})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[(0,r.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Tool Choice"}),(0,r.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-700 capitalize",children:a.tool_choice?a.tool_choice:"Auto"})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[(0,r.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Instructions"}),(0,r.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-700",children:(null===(s=a.instructions)||void 0===s?void 0:s.trim())?"".concat(a.instructions.trim().split(/\s+/).length," words"):"Not set"})]})]})]}),(0,r.jsx)("div",{className:"space-y-6 bg-gradient-to-b from-white via-white to-slate-50 px-6 py-6",children:f&&(0,r.jsx)(eC,{step:f,index:i,totalSteps:o,allSteps:d,onChange:(e,t)=>{b(t),y.current=t,m(e,t)},onDelete:()=>{null!==i&&(x(i),u())},onMoveUp:p,onMoveDown:h,workflowId:g})})]})]})}function eT(){var e,t,s,g,f;let b=(0,a.useRouter)(),y=function(){let[e,t]=(0,l.useState)(!1),[s,r]=(0,l.useState)(null),[a,n]=(0,l.useState)(!1),[i,o]=(0,l.useState)(!1),[d,c]=(0,l.useState)(null),[u,m]=(0,l.useState)(!1),[x,p]=(0,l.useState)(!1),h=(0,l.useRef)(null);return{showResubmitModal:e,openResubmitModal:()=>t(!0),closeResubmitModal:()=>t(!1),editingStepIndex:s,isSidePanelOpen:a,openEditStep:e=>{r(e),n(!0),h.current=null},closeEditStep:()=>{r(null),n(!1)},latestStepUpdateRef:h,showRerunConfirm:i,stepIndexForRerun:d,openRerunConfirm:e=>{c(e),o(!0)},closeRerunConfirm:()=>{o(!1),c(null)},showDetails:u,setShowDetails:m,showFormSubmission:x,setShowFormSubmission:p}}(),{jobId:j,job:w,workflow:N,form:_,submission:k,loading:C,error:I,resubmitting:T,handleResubmit:A,rerunningStep:E,handleRerunStep:F,executionStepsError:L}=function(){(0,a.useRouter)();let e=(0,a.useParams)(),[t,s]=(0,l.useState)(()=>o(e)),[r,n]=(0,l.useState)(null),[m,x]=(0,l.useState)(null),[p,h]=(0,l.useState)(null),[g,f]=(0,l.useState)(null),[b,y]=(0,l.useState)(!0),[j,v]=(0,l.useState)(null),[w,N]=(0,l.useState)(!1),[_,k]=(0,l.useState)(null),[S,C]=(0,l.useState)(null),I=(0,l.useRef)(null),T=(0,l.useRef)(null);(0,l.useEffect)(()=>()=>{I.current&&(clearInterval(I.current),I.current=null),T.current&&(clearTimeout(T.current),T.current=null)},[t]),(0,l.useEffect)(()=>{let r=o(e);r&&r!==t&&""!==r.trim()&&"_"!==r&&(I.current&&(clearInterval(I.current),I.current=null),T.current&&(clearTimeout(T.current),T.current=null),n(null),x(null),h(null),f(null),k(null),C(null),s(r))},[null==e?void 0:e.id,null==e?void 0:e.slug,t,e]),(0,l.useEffect)(()=>{t&&""!==t.trim()&&"_"!==t?E():t&&""!==t.trim()&&"_"!==t||(v("Invalid job ID. Please select a job from the list."),y(!1))},[t]);let A=(0,l.useCallback)(async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&t)try{let r=await d(()=>i.hi.getExecutionSteps(t));if(Array.isArray(r))s?n(t=>(null==t?void 0:t.job_id)!==e.job_id?t:{...t,execution_steps:r}):e.execution_steps=r,C(null);else{let a="Invalid execution steps data format: expected array, got ".concat(typeof r);console.error("❌ ".concat(a," for job ").concat(t)),s||(C(a),e.execution_steps=[])}}catch(n){var r,a,l,o;if((null===(r=n.response)||void 0===r?void 0:r.status)===404||(null===(a=n.message)||void 0===a?void 0:a.includes("not found")))s||(C(null),e.execution_steps=[]);else{let r="Error fetching execution steps: ".concat((null===(o=n.response)||void 0===o?void 0:null===(l=o.data)||void 0===l?void 0:l.message)||n.message||"Unknown error");(null==e?void 0:e.execution_steps_s3_key)&&(r+=" (S3 Key: ".concat(e.execution_steps_s3_key,")")),console.error("❌ ".concat(r," for job ").concat(t),{error:n,response:n.response}),s||(C(r),e.execution_steps=[])}}},[t]);(0,l.useEffect)(()=>{if(!r||!t||!("processing"===r.status||null!==_))return;let e=setInterval(async()=>{try{let e=await d(()=>i.hi.getJob(t));if(n(t=>(null==t?void 0:t.job_id)!==e.job_id?t:{...t,status:e.status,updated_at:e.updated_at,execution_steps:e.execution_steps||t.execution_steps}),await A(e,!0),null!==_&&"processing"!==e.status){let t=e.execution_steps||[],s=_+1,r=t.find(e=>e.step_order===s);r&&null!==r.output&&void 0!==r.output&&""!==r.output&&k(null)}}catch(e){}},3e3);return()=>clearInterval(e)},[null==r?void 0:r.status,t,_,A]);let E=async()=>{try{let e=await d(()=>i.hi.getJob(t));await A(e,!1),n(e);let s=[];e.workflow_id&&s.push(c(e.workflow_id,x)),e.submission_id&&s.push(u(e.submission_id,h,f)),await Promise.allSettled(s),v(null)}catch(t){var e,s;console.error("Failed to load job:",t),v((null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||t.message||"Failed to load lead magnet"),y(!1)}finally{y(!1)}},F=async()=>{N(!0),v(null);try{let e=await i.hi.resubmitJob(t);window.location.href="/dashboard/jobs/".concat(e.job_id)}catch(t){var e,s;console.error("Failed to resubmit job:",t),v((null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||t.message||"Failed to resubmit job")}finally{N(!1)}},L=async e=>{if(null===_){I.current&&(clearInterval(I.current),I.current=null),T.current&&(clearTimeout(T.current),T.current=null),k(e),v(null);try{await i.hi.rerunStep(t,e),n(e=>e&&e.job_id===t&&"completed"===e.status?{...e,status:"processing"}:e),n(s=>{if(!s||s.job_id!==t)return s;let r=e+1,a=(s.execution_steps||[]).map(e=>e.step_order===r?{...e,output:null,error:null}:e);return{...s,execution_steps:a}});let s=0;I.current=setInterval(async()=>{try{let r=await i.hi.getJob(t),a=r.execution_steps||[],n=e+1,l=a.find(e=>e.step_order===n);l&&null!==l.output&&void 0!==l.output&&""!==l.output||"failed"===r.status?(await E(),k(null),I.current&&(clearInterval(I.current),I.current=null)):s>=60&&(await E(),k(null),I.current&&(clearInterval(I.current),I.current=null)),s++}catch(e){await E(),k(null),I.current&&(clearInterval(I.current),I.current=null)}},3e3),T.current=setTimeout(async()=>{await E(),T.current=null},2e3)}catch(e){var s,r;console.error("Failed to rerun step:",e),v((null===(r=e.response)||void 0===r?void 0:null===(s=r.data)||void 0===s?void 0:s.message)||e.message||"Failed to rerun step"),k(null)}}};return{jobId:t,job:r,workflow:m,submission:p,form:g,loading:b,error:j,resubmitting:w,handleResubmit:F,rerunningStep:_,handleRerunStep:L,executionStepsError:S}}(),{showExecutionSteps:R,setShowExecutionSteps:P,expandedSteps:D,toggleStep:M}=function(e){let[t,s]=(0,l.useState)(!0),[r,a]=(0,l.useState)(new Set);return(0,l.useEffect)(()=>{(null==e?void 0:e.jobId)&&a(new Set)},[null==e?void 0:e.jobId]),{showExecutionSteps:t,setShowExecutionSteps:s,expandedSteps:r,toggleStep:e=>{let t=new Set(r);t.has(e)?t.delete(e):t.add(e),a(t)}}}({jobId:j}),O=function(e){let{job:t,workflow:s,rerunningStep:r}=e;return(0,l.useMemo)(()=>{if(!t)return[];let e=t.execution_steps||[],a=(null==s?void 0:s.steps)||[];if(!a||!Array.isArray(a)||0===a.length)return e.map(e=>{var t;let s=null!==(t=e.step_order)&&void 0!==t?t:0,a=null!=r&&s>0&&r===s-1;return{...e,_status:a?"in_progress":null!==e.output&&void 0!==e.output&&""!==e.output?"completed":"pending"}});let n=new Map,l=new Map;return e.forEach(e=>{let t=e.step_order;null!=t&&n.set(t,e)}),e.forEach(s=>{let a=s.step_order;if(null!=a){let n=function(e,t,s,r){var a;let n=null!==(a=e.step_order)&&void 0!==a?a:0;if(null!=r&&n>0&&r===n-1)return"in_progress";if(null!==e.output&&void 0!==e.output&&""!==e.output)return"completed";if("processing"===t.status){let t=s.filter(e=>e.step_order>0&&null!==e.output&&void 0!==e.output&&""!==e.output).length;if(e.step_order===t+1)return"in_progress"}return"failed"===t.status?"failed":"pending"}(s,t,e,r);l.set(a,{...s,_status:n,image_urls:s.image_urls})}}),a.forEach((s,r)=>{let n=r+1,i=l.get(n);if(i)l.set(n,x(i,s));else{var o;let r="processing"===t.status,i=(o=a.length,e.filter(e=>e.step_order>0&&e.step_order<=o&&("ai_generation"===e.step_type||"workflow_step"===e.step_type)&&null!==e.output&&void 0!==e.output&&""!==e.output).length),d=e.find(e=>e.step_order===n&&("ai_generation"===e.step_type||"workflow_step"===e.step_type)&&(null===e.output||void 0===e.output||""===e.output)),c=r&&(void 0!==d||n===i+1);if(d){let e=x(d,s);l.set(n,{...e,_status:"in_progress"})}else l.set(n,function(e,t,s){let{tools:r,tool_choice:a}=m(e);return{step_name:e.step_name,step_order:t,step_type:"workflow_step",model:e.model,tools:r,tool_choice:a,instructions:e.instructions,input:{tools:r,tool_choice:a},output:null,_status:s?"in_progress":"pending"}}(s,n,c))}}),e.forEach(e=>{let t=e.step_order;null!=t&&!l.has(t)&&(0===t||t>a.length||"ai_generation"!==e.step_type&&"workflow_step"!==e.step_type)&&l.set(t,{...e,_status:null!==e.output&&void 0!==e.output&&""!==e.output?"completed":"pending"})}),Array.from(l.values()).sort((e,t)=>(e.step_order||0)-(t.step_order||0))},[t,s,r])}({job:w,workflow:N,rerunningStep:E}),U=(null!==(g=null==N?void 0:null===(e=N.steps)||void 0===e?void 0:e.length)&&void 0!==g?g:0)>0||(null!==(f=null==w?void 0:null===(t=w.execution_steps)||void 0===t?void 0:t.length)&&void 0!==f?f:0)>0,J=async()=>{await A(),y.closeResubmitModal()},H=async e=>{if(!N||null===y.editingStepIndex||!N.steps){h.Am.error("Unable to save: Workflow data not available");return}try{let t=[...N.steps],s=t[y.editingStepIndex];t[y.editingStepIndex]={...s,...e},await i.hi.updateWorkflow(N.workflow_id,{steps:t}),h.Am.success("Step updated successfully");let r=y.editingStepIndex;y.closeEditStep(),y.openRerunConfirm(r),b.refresh()}catch(e){throw console.error("Failed to save step:",e),h.Am.error(e.message||"Failed to save step changes"),e}},z=async()=>{if(y.latestStepUpdateRef.current&&null!==y.editingStepIndex){var e;let t=null==N?void 0:null===(e=N.steps)||void 0===e?void 0:e[y.editingStepIndex];t&&JSON.stringify(t)!==JSON.stringify(y.latestStepUpdateRef.current)&&await H(y.latestStepUpdateRef.current),y.latestStepUpdateRef.current=null}y.closeEditStep()},W=async()=>{if(null!==y.stepIndexForRerun&&F){let e=y.stepIndexForRerun;y.closeRerunConfirm(),await F(e)}};return C?(0,r.jsx)(ey,{}):I&&!w?(0,r.jsxs)("div",{children:[(0,r.jsx)(p,{error:I,resubmitting:!1,onResubmit:()=>{}}),(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-2xl",children:I})]}):w?(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsx)(p,{error:I,resubmitting:T,onResubmit:y.openResubmitModal,job:w}),(0,r.jsx)(eb,{isOpen:y.showResubmitModal,onClose:y.closeResubmitModal,onConfirm:J,isResubmitting:T}),null!==y.editingStepIndex&&(null==N?void 0:null===(s=N.steps)||void 0===s?void 0:s[y.editingStepIndex])&&(0,r.jsx)(eI,{step:N.steps[y.editingStepIndex],index:y.editingStepIndex,totalSteps:N.steps.length,allSteps:N.steps,isOpen:y.isSidePanelOpen,onClose:z,onChange:(e,t)=>{y.latestStepUpdateRef.current=t},onDelete:()=>h.Am.error("Cannot delete steps from execution viewer. Please edit the workflow template."),onMoveUp:()=>h.Am.error("Cannot reorder steps from execution viewer. Please edit the workflow template."),onMoveDown:()=>h.Am.error("Cannot reorder steps from execution viewer. Please edit the workflow template."),workflowId:N.workflow_id}),(0,r.jsx)(ej,{isOpen:y.showRerunConfirm,onConfirm:W,onCancel:y.closeRerunConfirm}),U&&w?(0,r.jsxs)(r.Fragment,{children:[L&&(0,r.jsx)(eg,{error:L,s3Key:null==w?void 0:w.execution_steps_s3_key,className:"mb-4"}),(0,r.jsx)(eh,{steps:O,expandedSteps:D,showExecutionSteps:R,onToggleShow:()=>P(!R),onToggleStep:M,onCopy:v,jobStatus:w.status,onRerunStep:F,rerunningStep:E,onEditStep:e=>{y.openEditStep(e)},canEdit:!!N,jobId:w.job_id})]}):L?(0,r.jsx)(eg,{error:L,s3Key:null==w?void 0:w.execution_steps_s3_key,title:"Execution Steps Not Available"}):null,(0,r.jsxs)("div",{className:"mt-4 sm:mt-6 space-y-3 sm:space-y-4",children:[(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-soft border border-white/60",children:[(0,r.jsxs)("button",{onClick:()=>y.setShowDetails(!y.showDetails),className:"flex items-center justify-between w-full text-left p-4 sm:p-6 touch-target min-h-[48px] sm:min-h-0",children:[(0,r.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-ink-900",children:"Details"}),y.showDetails?(0,r.jsx)(n.rH8,{className:"w-5 h-5 text-ink-500 flex-shrink-0 ml-2"}):(0,r.jsx)(n.bTu,{className:"w-5 h-5 text-ink-500 flex-shrink-0 ml-2"})]}),y.showDetails&&(0,r.jsx)("div",{className:"px-4 sm:px-6 pb-4 sm:pb-6 border-t border-white/60",children:(0,r.jsx)("div",{className:"pt-4 sm:pt-6",children:(0,r.jsx)(S,{job:w,workflow:N,hideContainer:!0})})})]}),k&&(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-soft border border-white/60",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 sm:p-6",children:[(0,r.jsxs)("button",{onClick:()=>y.setShowFormSubmission(!y.showFormSubmission),className:"flex items-center justify-between flex-1 text-left touch-target min-h-[48px] sm:min-h-0",children:[(0,r.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-ink-900",children:"Form Submission Details"}),y.showFormSubmission?(0,r.jsx)(n.rH8,{className:"w-5 h-5 text-ink-500 flex-shrink-0 ml-2"}):(0,r.jsx)(n.bTu,{className:"w-5 h-5 text-ink-500 flex-shrink-0 ml-2"})]}),(0,r.jsxs)("button",{onClick:e=>{e.stopPropagation(),y.openResubmitModal()},disabled:T,className:"ml-4 flex items-center gap-2 px-3 py-2 text-sm font-medium text-brand-600 hover:text-brand-700 hover:bg-brand-50 rounded-2xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed touch-target min-h-[44px] sm:min-h-0",title:"Resubmit with same form answers",children:[(0,r.jsx)(n.Bw1,{className:"w-4 h-4 ".concat(T?"animate-spin":"")}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Resubmit"})]})]}),y.showFormSubmission&&(0,r.jsx)("div",{className:"px-4 sm:px-6 pb-4 sm:pb-6 border-t border-white/60",children:(0,r.jsx)("div",{className:"pt-4 sm:pt-6",children:k.submission_data?(0,r.jsx)("div",{className:"space-y-3",children:Object.entries(k.submission_data).map(e=>{let[t,s]=e;return(0,r.jsxs)("div",{className:"border-b border-white/60 pb-3 last:border-b-0",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-ink-700 mb-1 capitalize",children:t.replace(/_/g," ")}),(0,r.jsx)("p",{className:"text-sm text-ink-900 break-words",children:"string"==typeof s?s:JSON.stringify(s)})]},t)})}):(0,r.jsx)("p",{className:"text-sm text-ink-500",children:"No submission data available"})})})]}),(0,r.jsx)(ef,{job:w,form:_})]})]}):null}},73613:function(e,t,s){"use strict";s.d(t,{i:function(){return d}});var r=s(37821),a=s(58078),n=s(77851),l=s(58694),i=s(23320),o=s(63951);function d(e){var t;let{contentType:s,objectUrl:d,fileName:c,className:u="",artifactId:m}=e,[x,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(!1),[f,b]=(0,a.useState)(!1),[y,j]=(0,a.useState)(null),[v,w]=(0,a.useState)(!1),[N,_]=(0,a.useState)(null),[k,S]=(0,a.useState)(!1),C=(0,a.useRef)(null),I=s||c&&({html:"text/html",htm:"text/html",md:"text/markdown",markdown:"text/markdown",txt:"text/plain",json:"application/json",pdf:"application/pdf",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",svg:"image/svg+xml"})[(null===(t=c.split(".").pop())||void 0===t?void 0:t.toLowerCase())||""]||"application/octet-stream";return((0,a.useEffect)(()=>{let e=new IntersectionObserver(e=>{let[t]=e;t.isIntersecting&&b(!0)},{threshold:.1});return C.current&&e.observe(C.current),()=>e.disconnect()},[]),(0,a.useEffect)(()=>{d&&(w(!1),j(null),S(!1),_(null))},[d]),(0,a.useEffect)(()=>{!f||"text/markdown"!==I||y||v||(async()=>{try{let e;if(m)e=await o.hi.artifacts.getArtifactContent(m);else if(d){let t=await fetch(d);if(!t.ok)throw Error("HTTP ".concat(t.status,": ").concat(t.statusText));e=await t.text()}else throw Error("No artifact ID or URL provided");j(e),w(!1)}catch(s){var e,t;console.error("Failed to fetch markdown:",s),(null==s?void 0:null===(e=s.message)||void 0===e?void 0:e.includes("404"))||(null==s?void 0:null===(t=s.message)||void 0===t?void 0:t.includes("not found"))?(j("**Artifact file not available**\n\nThe artifact file was not found in storage. It may have been deleted or not yet generated."),w(!1)):w(!0)}})()},[f,I,d,m,y,v]),(0,a.useEffect)(()=>{!f||"text/html"!==I&&"application/xhtml+xml"!==I||N||k||(async()=>{try{let e;if(m)e=await o.hi.artifacts.getArtifactContent(m);else if(d){let t=await fetch(d);if(!t.ok)throw Error("HTTP ".concat(t.status,": ").concat(t.statusText));e=await t.text()}else throw Error("No artifact ID or URL provided");let t=function(e){let t=e.trim();if(t.startsWith("```html")){let e=t.match(/^```html\s*([\s\S]*?)\s*```$/i);if(e&&e[1])return e[1].trim()}if(t.startsWith("```")){let e=t.match(/^```\s*([\s\S]*?)\s*```$/);if(e&&e[1])return e[1].trim()}return e}(e);_(t),S(!1)}catch(s){var e,t;console.error("Failed to fetch HTML:",s),(null==s?void 0:null===(e=s.message)||void 0===e?void 0:e.includes("404"))||(null==s?void 0:null===(t=s.message)||void 0===t?void 0:t.includes("not found"))?(_("<html><body><h1>Artifact file not available</h1><p>The artifact file was not found in storage. It may have been deleted or not yet generated.</p></body></html>"),S(!1)):S(!0)}})()},[f,I,d,m,N,k]),d||m)?(0,r.jsx)("div",{ref:C,className:"overflow-hidden ".concat(u),children:(()=>{if(I.startsWith("image/"))return(0,r.jsxs)("div",{className:"relative w-full h-full",children:[!x&&!h&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:(0,r.jsx)(n.LFN,{className:"w-12 h-12 text-gray-400 animate-pulse"})}),h&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:(0,r.jsx)(n.LFN,{className:"w-12 h-12 text-gray-400"})}),f&&(0,r.jsx)("img",{src:d,alt:c||"Preview",className:"w-full h-full object-cover ".concat(x?"opacity-100":"opacity-0"),onLoad:()=>p(!0),onError:()=>g(!0),loading:"lazy"})]});if("application/pdf"===I)return(0,r.jsx)("div",{className:"relative w-full h-full bg-white",children:f&&d?(0,r.jsx)("iframe",{src:"".concat(d,"#toolbar=0&navpanes=0&scrollbar=0"),className:"w-full h-full border-0",title:c||"PDF Preview"}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-100",children:(0,r.jsx)(n.NOg,{className:"w-12 h-12 text-red-400"})})});if("text/html"===I||"application/xhtml+xml"===I)return(0,r.jsx)("div",{className:"relative w-full h-full bg-white",children:f?k?(0,r.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(n.xqv,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Failed to load HTML"})]})}):N?(0,r.jsx)("iframe",{srcDoc:N,className:"w-full h-full border-0",title:c||"HTML Preview",sandbox:"allow-same-origin allow-scripts",referrerPolicy:"no-referrer"}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(n.xqv,{className:"w-12 h-12 text-blue-400 mx-auto mb-2 animate-pulse"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Loading HTML..."})]})}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-100",children:(0,r.jsx)(n.xqv,{className:"w-12 h-12 text-blue-400"})})});if("text/markdown"===I)return(0,r.jsx)("div",{className:"relative w-full h-full bg-white overflow-auto",children:f?v?(0,r.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(n.NOg,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Failed to load markdown"})]})}):y?(0,r.jsx)("div",{className:"p-4 prose prose-sm max-w-none",children:(0,r.jsx)(l.UG,{remarkPlugins:[i.Z],children:y})}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(n.NOg,{className:"w-12 h-12 text-gray-400 mx-auto mb-2 animate-pulse"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Loading markdown..."})]})}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(n.NOg,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Markdown File"})]})})});if(I.startsWith("text/"))return(0,r.jsx)("div",{className:"flex items-center justify-center bg-gray-50 h-full",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(n.NOg,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Text File"})]})});let e=(I.startsWith("video/")||I.startsWith("audio/"),n.tHe);return(0,r.jsx)("div",{className:"flex items-center justify-center bg-gray-100 h-full",children:e===n.tHe?(0,r.jsx)(n.tHe,{className:"w-12 h-12 text-gray-400"}):null})})()}):(0,r.jsx)("div",{className:"flex items-center justify-center bg-gray-100 ".concat(u),children:(0,r.jsx)(n.tHe,{className:"w-12 h-12 text-gray-400"})})}},82164:function(e,t,s){"use strict";s.d(t,{U:function(){return i}});var r=s(37821),a=s(52605),n=s(77851);let l={1:"grid-cols-1",2:"grid-cols-1 md:grid-cols-2",3:"grid-cols-1 md:grid-cols-2 xl:grid-cols-3"};function i(e){let{items:t,columns:s=1,dense:i=!1,className:o="",onCopy:d}=e;return(0,r.jsx)("dl",{className:(0,a.Z)("grid gap-4",l[s],i&&"gap-3",o),children:t.map(e=>(0,r.jsxs)("div",{className:(0,a.Z)("rounded-xl border border-gray-100 bg-gray-50/70 px-4 py-3",i&&"px-3 py-2.5"),"data-testid":e.testId,children:[(0,r.jsxs)("dt",{className:"flex items-center gap-2 text-xs font-medium uppercase tracking-wide text-gray-500",children:[e.icon&&(0,r.jsx)("span",{className:"text-gray-400",children:e.icon}),e.label]}),(0,r.jsxs)("dd",{className:"mt-1 flex items-start justify-between gap-3",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[e.value,e.helperText&&(0,r.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:e.helperText})]}),e.copyValue&&(0,r.jsx)("button",{type:"button",className:"rounded-full border border-gray-200 bg-white p-2 text-gray-500 transition hover:text-gray-900",onClick:()=>{d?d(e.copyValue):"undefined"!=typeof navigator&&navigator.clipboard&&navigator.clipboard.writeText(e.copyValue).catch(()=>{})},"aria-label":"Copy ".concat(e.label),title:"Copy value",children:(0,r.jsx)(n.C3L,{className:"h-4 w-4"})})]})]},e.label))})}},5485:function(e,t,s){"use strict";s.d(t,{q:function(){return l}});var r=s(37821),a=s(52605);let n={sm:"p-4",md:"p-6",lg:"p-8"};function l(e){let{title:t,description:s,icon:l,actions:i,children:o,className:d="",contentClassName:c="",padding:u="md",stickyHeader:m=!1}=e,x=t||s||l||i,p=n[u];return(0,r.jsxs)("section",{className:(0,a.Z)("rounded-2xl border border-gray-100 bg-white shadow-sm ring-1 ring-black/[0.02]",d),children:[x&&(0,r.jsx)("header",{className:(0,a.Z)("flex flex-col gap-3 border-b border-gray-100",p,m&&"sticky top-0 z-10 bg-white/95 backdrop-blur"),children:(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[l&&(0,r.jsx)("div",{className:"text-primary-600",children:l}),(0,r.jsxs)("div",{children:[t&&(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:t}),s&&(0,r.jsx)("p",{className:"text-sm text-gray-500",children:s})]})]}),i&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:i})]})}),(0,r.jsx)("div",{className:(0,a.Z)(p,x&&"pt-4",c),children:o})]})}},20758:function(e,t,s){"use strict";s.d(t,{D:function(){return l}});var r=s(37821),a=s(52605);let n={neutral:"bg-gray-50 text-gray-900 border-gray-100",positive:"bg-green-50 text-green-900 border-green-100",warning:"bg-amber-50 text-amber-900 border-amber-100",danger:"bg-red-50 text-red-900 border-red-100"};function l(e){let{label:t,value:s,icon:l,tone:i="neutral",helperText:o,className:d=""}=e;return(0,r.jsxs)("div",{className:(0,a.Z)("flex items-start gap-3 rounded-2xl border px-4 py-3 shadow-[0_1px_2px_rgba(16,24,40,0.04)]",n[i],d),children:[l&&(0,r.jsx)("div",{className:"text-base",children:l}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-medium uppercase tracking-wide text-gray-500",children:t}),(0,r.jsx)("p",{className:"text-base font-semibold leading-6",children:s}),o&&(0,r.jsx)("p",{className:"text-xs text-gray-500",children:o})]})]})}},54597:function(e,t,s){"use strict";s.d(t,{O:function(){return n}});var r=s(37821);let a={pending:{bg:"bg-gray-100",text:"text-gray-800",label:"Pending"},in_progress:{bg:"bg-blue-100",text:"text-blue-800",label:"In Progress"},processing:{bg:"bg-blue-100",text:"text-blue-800",label:"Processing"},completed:{bg:"bg-green-100",text:"text-green-800",label:"Completed"},success:{bg:"bg-green-100",text:"text-green-800",label:"Success"},failed:{bg:"bg-red-100",text:"text-red-800",label:"Failed"},error:{bg:"bg-red-100",text:"text-red-800",label:"Error"}};function n(e){let{status:t,className:s=""}=e,n=a[t]||{bg:"bg-gray-100",text:"text-gray-800",label:t};return(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(n.bg," ").concat(n.text," ").concat(s),children:n.label})}},73936:function(e,t,s){"use strict";s.d(t,{e$:function(){return a}});var r=s(89267);function a(e){return e instanceof r.M||e instanceof Error?e.message:"string"==typeof e?e:"An unexpected error occurred"}}},function(e){e.O(0,[9134,2537,9190,440,5755,9377,3783,7089,3909,5118,3951,9742,7115,2364,1744],function(){return e(e.s=90974)}),_N_E=e.O()}]);