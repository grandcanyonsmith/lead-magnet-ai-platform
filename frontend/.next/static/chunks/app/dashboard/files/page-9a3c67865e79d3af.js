(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1254],{25899:function(e,t,r){Promise.resolve().then(r.bind(r,10762))},10762:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var l=r(37821),n=r(58078),s=r(45755),i=r(87559),a=r(63951),o=r(38409),c=r(77851),d=r(96780);function u(){let{customerId:e}=(0,o.a)(),[t,r]=(0,n.useState)([]),[u,f]=(0,n.useState)(!0),[h,m]=(0,n.useState)(!1),[x,b]=(0,n.useState)(""),[p,g]=(0,n.useState)(null),[y,v]=(0,n.useState)(!1),[j,w]=(0,n.useState)(null),[N,k]=(0,n.useState)(null),[O,S]=(0,n.useState)(null),[C,_]=(0,n.useState)(!1),[F,P]=(0,n.useState)(null),[E,D]=(0,n.useState)(null);(0,n.useEffect)(()=>{T()},[]);let T=async()=>{f(!0);try{let e=await a.hi.get("/files");r(e.files)}catch(e){console.error("Error loading files:",e)}finally{f(!1)}},z=async e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){m(!0);try{let e=new FileReader;e.onload=async e=>{try{var t;let l=(null===(t=e.target)||void 0===t?void 0:t.result).split(",")[1];await a.hi.post("/files",{file:l,filename:r.name,contentType:r.type,fileType:"document",category:"uploads"}),await T(),D(null),P("File uploaded successfully.")}catch(e){console.error("Error uploading file:",e),D("Failed to upload file. Please try again."),P(null)}finally{m(!1)}},e.readAsDataURL(r)}catch(e){console.error("Error reading file:",e),m(!1)}}},L=async()=>{if(!x.trim()){g(null);return}v(!0);try{let e=await a.hi.post("/files/search",{query:x});g(e),D(null)}catch(e){console.error("Error searching files:",e),D("Failed to search files. Please try again."),P(null)}finally{v(!1)}},U=async e=>{w(e);try{let t=await a.hi.get("/files/".concat(e.file_id));k(t.download_url)}catch(e){console.error("Error getting file URL:",e)}},q=async()=>{if(O){_(!0);try{await a.hi.delete("/files/".concat(O.file_id)),await T(),(null==j?void 0:j.file_id)===O.file_id&&(w(null),k(null)),P("File deleted."),D(null)}catch(e){console.error("Error deleting file:",e),D("Failed to delete file. Please try again."),P(null)}_(!1),S(null)}},B=e=>e<1024?"".concat(e," B"):e<1048576?"".concat((e/1024).toFixed(2)," KB"):"".concat((e/1048576).toFixed(2)," MB");return(0,l.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-ink-900 mb-2",children:"Files"}),(0,l.jsx)("p",{className:"text-ink-600",children:"Upload and manage your customer files"})]}),(F||E)&&(0,l.jsxs)("div",{className:"space-y-3 mb-4",children:[E&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-100 text-red-700 rounded-2xl px-4 py-3",children:E}),F&&(0,l.jsx)("div",{className:"bg-emerald-50 border border-emerald-100 text-emerald-800 rounded-2xl px-4 py-3",children:F})]}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-soft border border-white/60 p-6 mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-4 text-ink-900",children:"Upload File"}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)("label",{className:"cursor-pointer",children:[(0,l.jsx)("span",{className:"inline-flex items-center px-4 py-2 bg-brand-600 text-white rounded-2xl hover:bg-brand-700 transition-colors shadow-soft",children:h?"Uploading...":"Choose File"}),(0,l.jsx)("input",{type:"file",className:"hidden",onChange:z,disabled:h})]}),(0,l.jsx)("span",{className:"text-sm text-ink-500",children:"Max file size: 10MB"})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-soft border border-white/60 p-6 mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-4 text-ink-900",children:"Search Files"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{type:"text",placeholder:"Search files by content...",value:x,onChange:e=>b(e.target.value),onKeyPress:e=>"Enter"===e.key&&L(),className:"flex-1 px-4 py-2 border border-white/60 rounded-2xl bg-white/90 focus:outline-none focus:ring-2 focus:ring-brand-500 shadow-soft"}),(0,l.jsx)("button",{onClick:L,disabled:y||!x.trim(),className:"px-6 py-2 bg-brand-600 text-white rounded-2xl hover:bg-brand-700 disabled:opacity-50 disabled:cursor-not-allowed shadow-soft",children:y?"Searching...":"Search"})]}),p&&(0,l.jsxs)("div",{className:"mt-4 p-4 bg-white/80 rounded-2xl border border-white/60",children:[(0,l.jsx)("h3",{className:"font-semibold mb-2 text-ink-900",children:"Search Results"}),(0,l.jsx)("p",{className:"text-ink-700 whitespace-pre-wrap",children:p.response}),(0,l.jsxs)("p",{className:"text-sm text-ink-500 mt-2",children:["Searched ",p.filesSearched," file(s)"]})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-soft border border-white/60",children:[(0,l.jsx)("div",{className:"p-6 border-b border-white/60",children:(0,l.jsxs)("h2",{className:"text-lg font-semibold text-ink-900",children:["Your Files (",t.length,")"]})}),u?(0,l.jsx)("div",{className:"p-8 text-center text-ink-500",children:"Loading files..."}):0===t.length?(0,l.jsx)("div",{className:"p-8 text-center text-ink-500",children:"No files uploaded yet. Upload your first file above."}):(0,l.jsx)("div",{className:"divide-y divide-white/60",children:t.map(e=>(0,l.jsx)("div",{className:"p-4 hover:bg-white/80 cursor-pointer",onClick:()=>U(e),children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h3",{className:"font-medium text-ink-900",children:e.original_filename}),(0,l.jsxs)("div",{className:"mt-1 flex items-center gap-4 text-sm text-ink-500",children:[(0,l.jsx)("span",{children:e.file_type}),(0,l.jsx)("span",{children:B(e.file_size)}),(0,l.jsx)("span",{children:new Date(e.created_at).toLocaleDateString()})]})]}),(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),S(e)},className:"ml-4 px-3 py-1 text-sm text-red-600 hover:bg-red-50/60 rounded-2xl",children:"Delete"})]})},e.file_id))})]}),(0,l.jsx)(s.u,{appear:!0,show:!!j&&!!N,as:n.Fragment,children:(0,l.jsxs)(i.Vq,{as:"div",className:"relative z-50",onClose:()=>{w(null),k(null)},children:[(0,l.jsx)(s.u.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),(0,l.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,l.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,l.jsx)(s.u.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,l.jsx)(i.Vq.Panel,{className:"w-full max-w-4xl transform overflow-hidden rounded-2xl bg-white shadow-soft border border-white/60 transition-all",children:j&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"p-6 border-b border-white/60 flex items-center justify-between",children:[(0,l.jsx)(i.Vq.Title,{as:"h3",className:"text-lg font-semibold text-ink-900",children:j.original_filename}),(0,l.jsx)("button",{onClick:()=>{w(null),k(null)},className:"text-ink-500 hover:text-ink-700 rounded-2xl p-2 transition-colors focus:outline-none focus:ring-2 focus:ring-brand-500",children:(0,l.jsx)(c.q5L,{className:"w-5 h-5"})})]}),(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsx)("a",{href:N||"#",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-brand-600 text-white rounded-2xl hover:bg-brand-700 shadow-soft transition-colors focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2",children:"Download File"})}),(0,l.jsxs)("div",{className:"text-sm text-ink-600 space-y-1",children:[(0,l.jsxs)("p",{children:["Type: ",j.file_type]}),(0,l.jsxs)("p",{children:["Size: ",B(j.file_size)]}),(0,l.jsxs)("p",{children:["Uploaded: ",new Date(j.created_at).toLocaleString()]})]})]})]})})})})})]})}),(0,l.jsx)(d.Q,{open:!!O,title:"Delete file?",description:O?(0,l.jsxs)("span",{children:["This will permanently remove ",(0,l.jsx)("span",{className:"font-semibold",children:O.original_filename}),"."]}):"This action cannot be undone.",confirmLabel:"Delete",tone:"danger",loading:C,onConfirm:q,onCancel:()=>S(null)})]})}},96780:function(e,t,r){"use strict";r.d(t,{Q:function(){return n}});var l=r(37821);function n(e){let{open:t,title:r,description:n,confirmLabel:s="Confirm",cancelLabel:i="Cancel",tone:a="default",loading:o=!1,onConfirm:c,onCancel:d}=e;return t?(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-ink-900/60 backdrop-blur-sm",onClick:d,"aria-hidden":"true"}),(0,l.jsx)("div",{className:"relative z-10 w-full max-w-md rounded-2xl bg-white shadow-soft border border-white/60 p-6",role:"dialog","aria-modal":"true","aria-labelledby":"confirm-dialog-title",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("h3",{id:"confirm-dialog-title",className:"text-lg font-semibold text-ink-900",children:r}),n&&(0,l.jsx)("div",{className:"text-sm text-ink-600",children:n})]}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-3",children:[(0,l.jsx)("button",{type:"button",onClick:d,className:"w-full sm:w-auto px-4 py-3 sm:py-2.5 rounded-2xl border border-white/60 bg-white text-ink-700 hover:bg-surface-50 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 touch-target",children:i}),(0,l.jsx)("button",{type:"button",onClick:c,disabled:o,className:"w-full sm:w-auto px-4 py-3 sm:py-2.5 rounded-2xl text-white ".concat("danger"===a?"bg-red-600 hover:bg-red-700 focus:ring-red-500":"bg-brand-600 hover:bg-brand-700 focus:ring-brand-500"," transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 touch-target disabled:opacity-60 disabled:cursor-not-allowed"),children:o?"Working...":s})]})]})})]}):null}},48416:function(e,t,r){"use strict";r.d(t,{w_:function(){return d}});var l=r(58078),n={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},s=l.createContext&&l.createContext(n),i=["attr","size","title"];function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e}).apply(this,arguments)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,l)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){var l,n;l=t,n=r[t],(l=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var l=r.call(e,t||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(l))in e?Object.defineProperty(e,l,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[l]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e){return t=>l.createElement(u,a({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>l.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function u(e){var t=t=>{var r,{attr:n,size:s,title:o}=e,d=function(e,t){if(null==e)return{};var r,l,n=function(e,t){if(null==e)return{};var r={};for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){if(t.indexOf(l)>=0)continue;r[l]=e[l]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(l=0;l<s.length;l++)r=s[l],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,i),u=s||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),l.createElement("svg",a({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,d,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),o&&l.createElement("title",null,o),e.children)};return void 0!==s?l.createElement(s.Consumer,null,e=>t(e)):t(n)}}},function(e){e.O(0,[9134,9190,8463,5755,9377,7559,3951,6254,7115,2364,1744],function(){return e(e.s=25899)}),_N_E=e.O()}]);