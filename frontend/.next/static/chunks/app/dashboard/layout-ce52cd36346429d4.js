(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7663],{68693:function(e,t,r){Promise.resolve().then(r.bind(r,47404))},47404:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v}});var s=r(37821),n=r(58078),a=r(58504),l=r(14772),i=r(77851),o=r(38409);let c=(0,n.createContext)(null),d=()=>{let e=(0,a.useRouter)(),t=(0,a.usePathname)(),{user:r,role:d,isLoading:u}=(0,o.a)(),[x,m]=(0,n.useState)(!1),h=(0,n.useRef)(null),f=(0,n.useContext)(c);(0,n.useEffect)(()=>{let e=e=>{h.current&&!h.current.contains(e.target)&&m(!1)};return x&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[x]);let b=u?"":(null==r?void 0:r.name)||(null==r?void 0:r.email)||"User",p=u?"":((e,t)=>{if(e){let t=e.split(" ");return t.length>=2?"".concat(t[0][0]).concat(t[1][0]).toUpperCase():e[0].toUpperCase()}return t?t[0].toUpperCase():"U"})(null==r?void 0:r.name,null==r?void 0:r.email);return(0,s.jsxs)("div",{className:"relative",ref:h,children:[(0,s.jsxs)("button",{onClick:()=>m(!x),className:"flex items-center gap-2 rounded-2xl border border-white/60 bg-white/80 px-2.5 py-1.5 text-sm font-medium text-ink-500 shadow-soft transition hover:text-ink-900","aria-label":"User menu",children:[(0,s.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-2xl bg-gradient-to-br from-brand-500 to-brand-600 text-white text-sm font-semibold shadow-soft",children:u?(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):p}),!u&&(0,s.jsx)("span",{className:"hidden sm:block max-w-[120px] truncate text-ink-600",children:b}),(0,s.jsx)(i.bTu,{className:"hidden sm:block h-4 w-4 text-ink-300 transition-transform ".concat(x?"rotate-180":"")})]}),x&&(0,s.jsxs)("div",{className:"absolute right-0 z-50 mt-3 w-72 max-w-[calc(100vw-1rem)] rounded-3xl border border-white/60 bg-white/95 p-1.5 shadow-soft backdrop-blur-xl",children:[(0,s.jsx)("div",{className:"rounded-2xl border border-white/60 bg-white/90 p-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex h-11 w-11 items-center justify-center rounded-2xl bg-gradient-to-br from-brand-500 to-brand-600 text-white text-sm font-semibold shadow-soft",children:u?(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):p}),(0,s.jsx)("div",{className:"flex-1 min-w-0",children:u?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-24 mb-2 animate-pulse"}),(0,s.jsx)("div",{className:"h-3 bg-gray-200 rounded w-32 animate-pulse"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-gray-900 truncate",children:(null==r?void 0:r.name)||"User"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 truncate",children:(null==r?void 0:r.email)||""})]})})]})}),(0,s.jsxs)("div",{className:"py-2",children:["/dashboard/jobs"===t&&f&&(0,s.jsx)("div",{className:"mb-2 border-b border-white/60 pb-2 sm:hidden",children:(0,s.jsxs)("div",{className:"px-4 py-2",children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)(i.Ihx,{className:"mr-2 h-4 w-4 text-ink-300"}),(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-ink-400",children:"Filters"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"mb-1 block text-xs text-ink-500",children:"Status"}),(0,s.jsxs)("select",{value:f.statusFilter,onChange:e=>{f.setStatusFilter(e.target.value)},className:"w-full rounded-xl border border-white/60 bg-white/90 px-2 py-1.5 text-xs text-ink-600 shadow-soft focus:border-brand-200 focus:outline-none focus:ring-2 focus:ring-brand-100/80",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("option",{value:"all",children:"All Statuses"}),(0,s.jsx)("option",{value:"pending",children:"Queued"}),(0,s.jsx)("option",{value:"processing",children:"Generating"}),(0,s.jsx)("option",{value:"completed",children:"Ready"}),(0,s.jsx)("option",{value:"failed",children:"Error"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"mb-1 block text-xs text-ink-500",children:"Lead Magnet"}),(0,s.jsxs)("select",{value:f.workflowFilter,onChange:e=>{f.setWorkflowFilter(e.target.value)},className:"w-full rounded-xl border border-white/60 bg-white/90 px-2 py-1.5 text-xs text-ink-600 shadow-soft focus:border-brand-200 focus:outline-none focus:ring-2 focus:ring-brand-100/80",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("option",{value:"all",children:"All Lead Magnets"}),f.workflows.map(e=>(0,s.jsx)("option",{value:e.workflow_id,children:e.workflow_name||e.workflow_id},e.workflow_id))]})]})]})]})}),(0,s.jsxs)("button",{onClick:()=>{e.push("/dashboard/settings"),m(!1)},className:"flex w-full items-center rounded-2xl px-4 py-2.5 text-sm text-ink-600 transition hover:bg-white/80",children:[(0,s.jsx)(i.nbt,{className:"mr-3 h-4 w-4 text-ink-400"}),(0,s.jsx)("span",{children:"Settings"})]}),"SUPER_ADMIN"===d&&(0,s.jsxs)("button",{onClick:()=>{e.push("/dashboard/agency/users"),m(!1)},className:"flex w-full items-center rounded-2xl px-4 py-2.5 text-sm text-ink-600 transition hover:bg-white/80",children:[(0,s.jsx)(i.WY8,{className:"mr-3 h-4 w-4 text-ink-400"}),(0,s.jsx)("span",{children:"Agency Users"})]})]}),(0,s.jsx)("div",{className:"border-t border-white/60 py-2",children:(0,s.jsxs)("button",{onClick:()=>{(0,l.w7)(),e.push("/auth/login"),m(!1)},className:"flex w-full items-center rounded-2xl px-4 py-2.5 text-sm text-red-500 transition hover:bg-red-50/60",children:[(0,s.jsx)(i.xqh,{className:"mr-3 h-4 w-4"}),(0,s.jsx)("span",{children:"Sign Out"})]})})]})]})};var u=r(63951);function x(){let{isImpersonating:e,actingUser:t,refreshAuth:r}=(0,o.a)(),[a,l]=(0,n.useState)(!1);if(!e||!t)return(0,s.jsx)("div",{className:"min-h-[44px] sm:min-h-[40px]","aria-hidden":"true"});let i=async()=>{l(!0);try{let e=localStorage.getItem("impersonation_session_id");e&&(await u.hi.post("/admin/impersonate/reset",{sessionId:e}),localStorage.removeItem("impersonation_session_id")),await r()}catch(e){console.error("Error resetting impersonation:",e)}finally{l(!1)}};return(0,s.jsxs)("div",{className:"bg-yellow-500 text-yellow-900 px-3 sm:px-4 py-2.5 sm:py-2 flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2 sm:gap-3 min-h-[44px] sm:min-h-[40px]",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[(0,s.jsx)("span",{className:"font-semibold text-sm sm:text-base whitespace-nowrap flex-shrink-0",children:"Viewing as:"}),(0,s.jsxs)("div",{className:"min-w-0 flex-1 flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[(0,s.jsx)("span",{className:"text-sm sm:text-base truncate",children:t.name||t.email}),(0,s.jsxs)("span",{className:"text-xs sm:text-sm text-yellow-800 truncate",children:["(",t.email,")"]})]})]}),(0,s.jsx)("button",{onClick:i,disabled:a,className:"bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed transition-colors touch-target whitespace-nowrap flex-shrink-0",children:a?"Returning...":"Return to my account"})]})}var m=r(52605);let h=(0,n.createContext)(void 0),f=e=>{let{children:t,className:r,sidebarOpen:a,onSidebarOpenChange:l}=e,[i,o]=(0,n.useState)(!1),c="boolean"==typeof a,d=c?a:i,u=(0,n.useCallback)(e=>{c?null==l||l(e):o(e)},[c,l]),x=(0,n.useMemo)(()=>({sidebarOpen:d,setSidebarOpen:u}),[d,u]);return(0,s.jsx)(h.Provider,{value:x,children:(0,s.jsxs)("div",{"data-shell-root":!0,className:(0,m.Z)("relative flex min-h-screen bg-transparent text-ink-900 selection:bg-brand-100 selection:text-ink-900",r),children:[(0,s.jsx)("div",{className:"noise-overlay","aria-hidden":"true"}),t]})})},b=()=>{let e=(0,n.useContext)(h);if(!e)throw Error("useShell must be used within <Shell>");return e},p=e=>{let{children:t,className:r}=e,{sidebarOpen:n,setSidebarOpen:a}=b();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:(0,m.Z)("fixed inset-0 z-30 bg-overlay/60 backdrop-blur-sm transition-opacity duration-200 lg:hidden",n?"pointer-events-auto opacity-100":"pointer-events-none opacity-0"),onClick:()=>a(!1),"aria-hidden":!n}),(0,s.jsx)("aside",{"data-shell-sidebar":!0,className:(0,m.Z)("fixed top-0 left-0 z-40 flex h-full w-full max-w-xs flex-col bg-white shadow-soft transition-transform duration-300 ease-snappy sm:max-w-sm lg:border-r lg:border-surface-200",n?"translate-x-0":"-translate-x-full","lg:translate-x-0",r),children:t})]})},w=e=>{let{children:t,className:r}=e;return(0,s.jsx)("main",{"data-shell-content":!0,className:(0,m.Z)("shell-container shell-scroll-area relative py-6 sm:py-8 lg:py-10",r),children:t})};var g=r(74542);let j=e=>{let{href:t,label:r,icon:n,isActive:a,badge:l,shortcutHint:i,onClick:o}=e,{setSidebarOpen:c}=b();return(0,s.jsxs)(g.default,{href:t,onClick:()=>{c(!1),null==o||o()},className:(0,m.Z)("group flex items-center gap-3 rounded-2xl px-3 py-2.5 text-sm font-medium transition-all duration-200",a?"bg-brand-50 text-ink-900 shadow-ring":"text-ink-500 hover:bg-white/60 hover:text-ink-900"),children:[(0,s.jsx)("span",{className:(0,m.Z)("flex h-9 w-9 items-center justify-center rounded-xl text-base transition-transform duration-200",a?"bg-brand-100 text-brand-600 shadow-soft":"bg-white/60 text-ink-400 group-hover:text-brand-500"),children:(0,s.jsx)(n,{className:"h-5 w-5"})}),(0,s.jsx)("span",{className:"flex-1 truncate",children:r}),null!=l&&""!==l&&(0,s.jsx)("span",{className:"pill text-xs text-ink-700",children:l}),i&&(0,s.jsx)("kbd",{className:"hidden rounded-lg border border-white/60 bg-white/70 px-2 py-1 text-xs font-medium text-ink-400 md:flex",children:i})]})};function v(e){let{children:t}=e,r=(0,a.useRouter)(),o=(0,a.usePathname)(),[c,u]=(0,n.useState)(!0),[m,h]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{await new Promise(e=>setTimeout(e,100));try{await (0,l.$8)()?u(!1):r.push("/auth/login")}catch(e){console.error("Auth check error:",e),r.push("/auth/login")}})()},[r]);let b=(0,n.useMemo)(()=>[{href:"/dashboard",label:"Dashboard",icon:i.m6D},{href:"/dashboard/workflows",label:"Lead Magnets",icon:i.SnF},{href:"/dashboard/jobs",label:"Runs",icon:i.bAx},{href:"/dashboard/artifacts",label:"Downloads",icon:i._hL}],[]);return c?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-gray-600",children:"Loading..."})})}):(0,s.jsxs)(f,{sidebarOpen:m,onSidebarOpenChange:h,children:[(0,s.jsx)(p,{children:(0,s.jsxs)("div",{className:"flex h-full flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between border-b border-surface-200 px-4 py-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex h-11 w-11 items-center justify-center rounded-2xl bg-brand-600 text-sm font-semibold text-white",children:"LM"}),(0,s.jsx)("div",{className:"min-w-0",children:(0,s.jsx)("p",{className:"text-lg font-semibold text-ink-900",children:"Lead Magnet AI"})})]}),(0,s.jsx)("button",{onClick:()=>h(!1),className:"rounded-2xl border border-surface-200 p-2 text-ink-400 transition hover:text-ink-900 lg:hidden","aria-label":"Close navigation",children:(0,s.jsx)(i.q5L,{className:"h-5 w-5"})})]}),(0,s.jsx)("nav",{className:"flex-1 overflow-y-auto px-4 py-6",children:(0,s.jsx)("div",{className:"space-y-1.5",children:b.map(e=>{let t=o===e.href||(null==o?void 0:o.startsWith(e.href+"/"));return(0,s.jsx)(j,{href:e.href,label:e.label,icon:e.icon,isActive:t},e.href)})})}),(0,s.jsx)("div",{className:"border-t border-surface-200 px-4 py-4",children:(0,s.jsx)(d,{})})]})}),(0,s.jsxs)("div",{className:"flex min-h-screen flex-1 flex-col lg:pl-[20rem]",children:[(0,s.jsx)(x,{}),(0,s.jsx)("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:(0,s.jsx)("button",{onClick:()=>h(!0),className:"inline-flex h-11 w-11 items-center justify-center rounded-2xl border border-surface-200 bg-white text-ink-500 transition hover:text-ink-900 shadow-lg","aria-label":"Open menu",children:(0,s.jsx)(i.cur,{className:"h-5 w-5"})})}),(0,s.jsx)(w,{className:"w-full bg-surface-50",children:(0,s.jsx)("main",{className:"space-y-6",children:t})})]})]})}},14772:function(e,t,r){"use strict";r.d(t,{$8:function(){return o},Ho:function(){return n.H},w7:function(){return i},y1:function(){return l},zB:function(){return a}});var s=r(69439),n=r(38409);let a=async(e,t)=>s.O.signIn(e,t),l=async(e,t,r)=>s.O.signUp(e,t,r),i=()=>{s.O.signOut()},o=async()=>s.O.isAuthenticated()},52605:function(e,t,r){"use strict";t.Z=function(){for(var e,t,r=0,s="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=function e(t){var r,s,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t){if(Array.isArray(t)){var a=t.length;for(r=0;r<a;r++)t[r]&&(s=e(t[r]))&&(n&&(n+=" "),n+=s)}else for(s in t)t[s]&&(n&&(n+=" "),n+=s)}return n}(e))&&(s&&(s+=" "),s+=t);return s}},48416:function(e,t,r){"use strict";r.d(t,{w_:function(){return d}});var s=r(58078),n={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},a=s.createContext&&s.createContext(n),l=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){var s,n;s=t,n=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(s))in e?Object.defineProperty(e,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[s]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e){return t=>s.createElement(u,i({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>s.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function u(e){var t=t=>{var r,{attr:n,size:a,title:o}=e,d=function(e,t){if(null==e)return{};var r,s,n=function(e,t){if(null==e)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)r=a[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,l),u=a||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),s.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,d,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),o&&s.createElement("title",null,o),e.children)};return void 0!==a?s.createElement(a.Consumer,null,e=>t(e)):t(n)}}},function(e){e.O(0,[9134,9190,8463,2035,3951,6254,7115,2364,1744],function(){return e(e.s=68693)}),_N_E=e.O()}]);