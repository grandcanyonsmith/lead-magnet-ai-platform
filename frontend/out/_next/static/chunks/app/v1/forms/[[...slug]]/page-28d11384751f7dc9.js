(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2837],{70622:function(e,t,s){Promise.resolve().then(s.bind(s,39943))},39943:function(e,t,s){"use strict";s.d(t,{default:function(){return o}});var r=s(37821),a=s(58078),n=s(58504),l=s(39190);let i="http://localhost:3001";function o(){var e,t;let s=(0,n.useParams)(),o=()=>{let e=null==s?void 0:s.slug,t=Array.isArray(e)?e[0]:e;if(t&&"_"!==t&&""!==t.trim())return t;{let e=window.location.pathname.match(/\/v1\/forms\/([^/?#]+)/);if(e&&e[1]&&"_"!==e[1]&&""!==e[1].trim())return e[1];let t=window.location.hash.match(/\/v1\/forms\/([^/?#]+)/);if(t&&t[1]&&"_"!==t[1]&&""!==t[1].trim())return t[1]}return t||""},[d,c]=(0,a.useState)(o());(0,a.useEffect)(()=>{let e=o();e&&e!==d&&""!==e.trim()&&"_"!==e&&c(e)},[null==s?void 0:s.slug]);let[m,u]=(0,a.useState)(null),[x,h]=(0,a.useState)(!0),[b,f]=(0,a.useState)(!1),[p,g]=(0,a.useState)(null),[j,v]=(0,a.useState)(!1),[_,w]=(0,a.useState)({}),[k,y]=(0,a.useState)(!1),[N,S]=(0,a.useState)(null),[L,P]=(0,a.useState)(null),[q,C]=(0,a.useState)(null);(0,a.useEffect)(()=>{d&&""!==d.trim()&&"_"!==d?F():d&&""!==d.trim()&&"_"!==d||(g("Invalid form URL. Please check the form link."),h(!1))},[d]);let F=async()=>{try{var e,t;let s=await l.Z.get("".concat(i,"/v1/forms/").concat(d));u(s.data);let r={};null===(t=s.data.form_fields_schema)||void 0===t||null===(e=t.fields)||void 0===e||e.forEach(e=>{"checkbox"===e.field_type?r[e.field_id]=!1:(e.field_type,r[e.field_id]="")}),w(r)}catch(e){g(e instanceof Error?e.message:e&&"object"==typeof e&&"response"in e&&e.response&&"object"==typeof e.response&&"data"in e.response&&e.response.data&&"object"==typeof e.response.data&&"message"in e.response.data&&"string"==typeof e.response.data.message?e.response.data.message:"Form not found")}finally{h(!1)}},E=async e=>{e.preventDefault(),g(null),v(!1),f(!0),y(!1),S(null),P(null),C(null);try{let e=await l.Z.post("".concat(i,"/v1/forms/").concat(d,"/submit"),{submission_data:_});v(!0),e.data.job_id&&(S(e.data.job_id),y(!0),P("pending"),T(e.data.job_id)),e.data.redirect_url&&!e.data.job_id&&setTimeout(()=>{window.location.href=e.data.redirect_url},2e3)}catch(e){var t,s;console.error("Failed to submit form:",e),g((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||e.message||"Failed to submit form")}finally{f(!1)}},T=async e=>{let t=0,s=async()=>{try{let r=await l.Z.get("".concat(i,"/v1/jobs/").concat(e,"/status")),a=r.data.status;if(P(a),"completed"===a){y(!1),r.data.output_url&&C(r.data.output_url);return}if("failed"===a){y(!1),g(r.data.error_message||"Lead magnet generation failed");return}("pending"===a||"processing"===a)&&(++t<180?setTimeout(s,1e3):(y(!1),g("Generation is taking longer than expected. Please check back later.")))}catch(e){console.warn("Could not poll job status:",e),++t<180?setTimeout(s,2e3):(y(!1),P("unknown"))}};setTimeout(s,1e3)},Y=(e,t)=>{w(s=>({...s,[e]:t}))},M=e=>{let t=_[e.field_id]||"";switch(e.field_type){case"textarea":return(0,r.jsx)("textarea",{id:e.field_id,value:t,onChange:t=>Y(e.field_id,t.target.value),className:"w-full px-4 py-3 border border-white/60 rounded-2xl bg-white/90 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 text-ink-900 placeholder-ink-400 shadow-soft",placeholder:e.placeholder,required:e.required,maxLength:e.max_length,rows:4});case"select":var s;return(0,r.jsxs)("select",{id:e.field_id,value:t,onChange:t=>Y(e.field_id,t.target.value),className:"w-full px-4 py-3 border border-white/60 rounded-2xl bg-white/90 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 text-ink-900 placeholder-ink-400 shadow-soft",required:e.required,children:[(0,r.jsx)("option",{value:"",children:"Select an option..."}),null===(s=e.options)||void 0===s?void 0:s.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]});case"checkbox":return(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:e.field_id,checked:t||!1,onChange:t=>Y(e.field_id,t.target.checked),className:"w-4 h-4 text-brand-600 border-white/60 rounded focus:ring-brand-500",required:e.required}),(0,r.jsx)("label",{htmlFor:e.field_id,className:"ml-2 text-sm text-ink-700",children:e.label})]});default:return(0,r.jsx)("input",{type:"email"===e.field_type?"email":"tel"===e.field_type?"tel":"number"===e.field_type?"number":"text",id:e.field_id,value:t,onChange:t=>Y(e.field_id,t.target.value),className:"w-full px-4 py-3 border border-white/60 rounded-2xl bg-white/90 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 text-ink-900 placeholder-ink-400 shadow-soft",placeholder:e.placeholder,required:e.required,maxLength:e.max_length,pattern:e.validation_regex})}};return x?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-surface-50 px-4",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("p",{className:"text-sm sm:text-base text-ink-600",children:"Loading form..."})})}):p&&!m?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-surface-50 px-4 sm:px-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-soft border border-white/60 p-6 sm:p-8 max-w-md w-full",children:[(0,r.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-ink-900 mb-3 sm:mb-4",children:"Form Not Found"}),(0,r.jsx)("p",{className:"text-sm sm:text-base text-ink-600",children:p})]})}):j?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-surface-50 px-4 sm:px-6",children:(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-soft border border-white/60 p-6 sm:p-8 max-w-md w-full text-center",children:k?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("div",{className:"mx-auto h-10 w-10 sm:h-12 sm:w-12 border-4 border-brand-200 border-t-brand-600 rounded-full animate-spin"})}),(0,r.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-ink-900 mb-3 sm:mb-4",children:"Generating Your Lead Magnet..."}),(0,r.jsx)("p",{className:"text-sm sm:text-base text-ink-600 mb-3 sm:mb-4 px-2",children:(null==m?void 0:m.thank_you_message)||"Your submission has been received. We&apos;re generating your personalized lead magnet now."}),L&&(0,r.jsxs)("p",{className:"text-xs sm:text-sm text-ink-500 mb-3 sm:mb-4",children:["Status: ","pending"===L?"Queued":"processing"===L?"Processing":L]}),(0,r.jsx)("p",{className:"text-xs text-ink-400 px-2",children:"This may take a minute. Please don't close this page."})]}):q?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("svg",{className:"mx-auto h-10 w-10 sm:h-12 sm:w-12 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-ink-900 mb-3 sm:mb-4",children:"Your Lead Magnet is Ready!"}),(0,r.jsx)("p",{className:"text-sm sm:text-base text-ink-600 mb-4 sm:mb-6 px-2",children:(null==m?void 0:m.thank_you_message)||"Your personalized lead magnet has been generated successfully."}),(0,r.jsx)("a",{href:q,target:"_blank",rel:"noopener noreferrer",className:"inline-block w-full sm:w-auto px-6 py-3 bg-brand-600 text-white rounded-2xl hover:bg-brand-700 transition-colors font-medium text-sm sm:text-base",children:"View Your Lead Magnet"}),(null==m?void 0:m.redirect_url)&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsxs)("a",{href:m.redirect_url,className:"text-xs sm:text-sm text-brand-600 hover:text-brand-700 break-all",children:["Continue to ",m.redirect_url]})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("svg",{className:"mx-auto h-10 w-10 sm:h-12 sm:w-12 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-ink-900 mb-3 sm:mb-4",children:"Thank You!"}),(0,r.jsx)("p",{className:"text-sm sm:text-base text-ink-600 mb-3 sm:mb-4 px-2",children:(null==m?void 0:m.thank_you_message)||"Your submission has been received and is being processed."}),(null==m?void 0:m.redirect_url)&&(0,r.jsx)("p",{className:"text-xs sm:text-sm text-ink-500",children:"Redirecting..."})]})})}):m?(0,r.jsx)("div",{className:"min-h-screen bg-surface-50 py-6 sm:py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-soft border border-white/60 p-4 sm:p-6 lg:p-8",children:[m.logo_url&&(0,r.jsx)("div",{className:"mb-4 sm:mb-6 text-center",children:(0,r.jsx)("img",{src:m.logo_url,alt:"Logo",className:"max-h-16 sm:max-h-20 mx-auto",onError:e=>{e.currentTarget.style.display="none"}})}),(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-ink-900 mb-2 sm:mb-3",children:m.form_name}),p&&(0,r.jsx)("div",{className:"mb-4 sm:mb-6 bg-red-50 border border-red-200 text-red-700 px-3 sm:px-4 py-2 sm:py-3 rounded-2xl text-sm sm:text-base",children:p}),(0,r.jsxs)("form",{onSubmit:E,className:"space-y-4 sm:space-y-6",children:[null===(t=m.form_fields_schema)||void 0===t?void 0:null===(e=t.fields)||void 0===e?void 0:e.map(e=>(0,r.jsxs)("div",{children:["checkbox"!==e.field_type&&(0,r.jsxs)("label",{htmlFor:e.field_id,className:"block text-sm font-medium text-ink-700 mb-1.5 sm:mb-2",children:[e.label,e.required&&(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),M(e),"checkbox"===e.field_type&&!e.required&&(0,r.jsx)("span",{className:"text-xs text-ink-500 ml-6",children:"Optional"})]},e.field_id)),(0,r.jsx)("div",{className:"pt-3 sm:pt-4",children:(0,r.jsx)("button",{type:"submit",disabled:b,className:"w-full flex justify-center py-2.5 sm:py-3 px-4 border border-white/60 rounded-2xl shadow-soft text-sm sm:text-base font-medium text-white bg-brand-600 hover:bg-brand-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:b?"Submitting...":"Submit"})})]}),m.custom_css&&(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:m.custom_css}})]})})}):null}},58504:function(e,t,s){"use strict";var r=s(93226);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[9190,7115,2364,1744],function(){return e(e.s=70622)}),_N_E=e.O()}]);